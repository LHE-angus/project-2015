<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KonkaParagonEquipmentJ">

    <typeAlias alias="konkaParagonEquipmentJ" type="com.ebiz.mmt.domain.KonkaParagonEquipmentJ" />

	
	
    <resultMap id="konkaParagonEquipmentJResult" class="konkaParagonEquipmentJ">
		<result property="equipment_j_id" column="EQUIPMENT_J_ID" jdbcType="DECIMAL" />
		<result property="equipment_id" column="EQUIPMENT_ID" jdbcType="DECIMAL" />
		<result property="show_shop_code" column="SHOW_SHOP_CODE" jdbcType="VARCHAR" />
		<result property="equipment_num" column="EQUIPMENT_NUM" jdbcType="DECIMAL" />
		<result property="addman" column="ADDMAN" jdbcType="DECIMAL" />
		<result property="addtime" column="ADDTIME" jdbcType="DATETIME" />
		<result property="startime" column="STARTIME" jdbcType="DATETIME" />
		<result property="endtime" column="ENDTIME" jdbcType="DATETIME" />
		<result property="fixdate" column="FIXDATE" jdbcType="VARCHAR" />
    </resultMap>
	
	<resultMap class="konkaParagonEquipmentJ" id="konkaParagonEquipmentJResultForList" extends="konkaParagonEquipmentJResult">
		<result property="map.equipment_name" column="EQUIPMENT_NAME" jdbcType="DECIMAL" />
	</resultMap>
	
	<sql id="sf-konkaParagonEquipmentJ">
		<isNotEmpty prepend=" and " property="equipment_j_id">a.EQUIPMENT_J_ID = #equipment_j_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="equipment_id">a.EQUIPMENT_ID = #equipment_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="show_shop_code">a.SHOW_SHOP_CODE = #show_shop_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="equipment_num">a.EQUIPMENT_NUM = #equipment_num:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addman">a.ADDMAN = #addman:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addtime">a.ADDTIME = #addtime:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="startime">a.STARTIME = #startime:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="endtime">a.ENDTIME = #endtime:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fixdate">a.FIXDATE = #fixdate:VARCHAR#</isNotEmpty>
		
		<isNotEmpty prepend=" and " property="map.etype">b.etype = #map.etype#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.proto_size"><![CDATA[b.proto_size >= #map.proto_size#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.shop_name_like"><![CDATA[c.custom_name like '%' || #map.shop_name_like# || '%']]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.shop_code_like"><![CDATA[a.SHOW_SHOP_CODE like '%' || #map.shop_code_like# || '%']]></isNotEmpty>
		<isNotEmpty property="map.st_pub_date">
			<isNotEmpty prepend=" and " property="map.en_pub_date">
				<![CDATA[ to_char(a.ADDTIME, 'yyyy-mm-dd') >= #map.st_pub_date# and to_char(a.ADDTIME, 'yyyy-mm-dd') <= #map.en_pub_date#]]>
			</isNotEmpty>
			<isEmpty prepend=" and " property="map.en_pub_date">
				to_char(a.ADDTIME, 'yyyy-mm-dd') >= #map.st_pub_date#
			</isEmpty>
		</isNotEmpty>
		<isEmpty property="map.st_pub_date">
			<isNotEmpty prepend=" and " property="map.en_pub_date">
				<![CDATA[ 
				to_char(a.ADDTIME, 'yyyy-mm-dd') <= #map.en_pub_date#
				]]>
			</isNotEmpty>
		</isEmpty>
	</sql>
	
	<select id="selectKonkaParagonEquipmentJ" resultMap="konkaParagonEquipmentJResult" parameterClass="konkaParagonEquipmentJ" >
		select * from KONKA_PARAGON_EQUIPMENT_J a where 1=1
		<include refid="sf-konkaParagonEquipmentJ" />
	</select>
	
	<select id="selectKonkaParagonEquipmentJList" resultMap="konkaParagonEquipmentJResultForList" parameterClass="konkaParagonEquipmentJ" >
		<isNotEmpty property="row.count"><![CDATA[ select * from ( ]]></isNotEmpty>
		select a.*, b.equipment_name
			  from KONKA_PARAGON_EQUIPMENT_J a
			  left join KONKA_PARAGON_EQUIPMENT_C b on a.equipment_id = b.equipment_id
			 where 1 = 1 
		<include refid="sf-konkaParagonEquipmentJ" />
		<!-- order by a.EQUIPMENT_J_ID desc -->
		<isNotEmpty property="row.count"><![CDATA[ ) where rownum<=#row.count# ]]></isNotEmpty>
	</select>
	
	<select id="selectKonkaParagonEquipmentJCount" resultClass="long" parameterClass="konkaParagonEquipmentJ" >
		SELECT COUNT(*) FROM KONKA_PARAGON_EQUIPMENT_J A 
		  LEFT JOIN KONKA_PARAGON_EQUIPMENT_C B ON A.EQUIPMENT_ID = B.EQUIPMENT_ID
		  LEFT JOIN KONKA_PARAGON_SHOWINFO C ON A.SHOW_SHOP_CODE = C.SHOW_SHOP_CODE
		 WHERE 1 = 1
		 <isNotEmpty prepend=" and " property="map.channel_name_like">C.CHANNEL_NAME like '%' || #map.channel_name_like:VARCHAR# || '%'</isNotEmpty>
		 <isNotEmpty prepend=" and " property="map.area_id">C.AREA_ID = #map.area_id:DECIMAL#</isNotEmpty>
		 <isNotEmpty prepend=" and " property="map.part_company_id">C.PART_COMPANY_ID = #map.part_company_id:DECIMAL#</isNotEmpty>
		  <isNotEmpty property="map.part_company_id_equip">and A.SHOW_SHOP_CODE in 
		 (
		select t.show_shop_code
		  from konka_paragon_showinfo t
		 where 1 = 1
		 and t.part_company_id in (#map.part_company_id_equip#)
		)
		</isNotEmpty>
		<include refid="sf-konkaParagonEquipmentJ" />
	</select>
	<!-- 统计样机数量  -->
	<select id="selectEquipmentNum" resultClass="long" parameterClass="konkaParagonEquipmentJ" >
		select  sum(a.equipment_num) from KONKA_PARAGON_EQUIPMENT_J a 
			left join KONKA_PARAGON_EQUIPMENT_C b on a.equipment_id = b.equipment_id 
			where 1 = 1
		<include refid="sf-konkaParagonEquipmentJ" />
	</select>
	
	<select id="selectKonkaParagonEquipmentJPaginatedList" resultMap="konkaParagonEquipmentJResult" parameterClass="konkaParagonEquipmentJ" >
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from KONKA_PARAGON_EQUIPMENT_J a where 1=1
		<include refid="sf-konkaParagonEquipmentJ" />
		<!-- order by a.EQUIPMENT_J_ID desc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<select id="selectKonkaParagonEquipmentPaginatedList" resultClass="HashMap" parameterClass="konkaParagonEquipmentJ" >
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		SELECT A.*, C.CUSTOM_NAME, B.EQUIPMENT_NAME
		  FROM KONKA_PARAGON_EQUIPMENT_J A
		  LEFT JOIN KONKA_PARAGON_EQUIPMENT_C B ON A.EQUIPMENT_ID = B.EQUIPMENT_ID
		  LEFT JOIN KONKA_PARAGON_SHOWINFO C ON A.SHOW_SHOP_CODE = C.SHOW_SHOP_CODE
		 WHERE 1 = 1
		 <isNotEmpty prepend=" and " property="map.channel_name_like">C.CHANNEL_NAME like '%' || #map.channel_name_like:VARCHAR# || '%'</isNotEmpty>
		 <isNotEmpty prepend=" and " property="map.area_id">C.AREA_ID = #map.area_id:DECIMAL#</isNotEmpty>
		 <isNotEmpty prepend=" and " property="map.part_company_id">C.PART_COMPANY_ID = #map.part_company_id:DECIMAL#</isNotEmpty>
		  <isNotEmpty property="map.part_company_id_equip">and A.SHOW_SHOP_CODE in 
		 (
		select t.show_shop_code
		  from konka_paragon_showinfo t
		 where 1 = 1
		 and t.part_company_id in (#map.part_company_id_equip#)
		)
		</isNotEmpty>
		<include refid="sf-konkaParagonEquipmentJ" />
		order by a.show_shop_code,a.equipment_j_id
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<insert id="insertKonkaParagonEquipmentJ" parameterClass="konkaParagonEquipmentJ">
		<selectKey resultClass="long" keyProperty="equipment_j_id">select KONKA_PARAGON_SEQ.nextval as equipment_j_id from dual</selectKey>
		<![CDATA[insert into KONKA_PARAGON_EQUIPMENT_J (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="equipment_j_id">EQUIPMENT_J_ID</isNotNull>
			<isNotNull prepend="," property="equipment_id">EQUIPMENT_ID</isNotNull>
			<isNotNull prepend="," property="show_shop_code">SHOW_SHOP_CODE</isNotNull>
			<isNotNull prepend="," property="equipment_num">EQUIPMENT_NUM</isNotNull>
			<isNotNull prepend="," property="addman">ADDMAN</isNotNull>
			<isNotNull prepend="," property="addtime">ADDTIME</isNotNull>
			<isNotNull prepend="," property="startime">STARTIME</isNotNull>
			<isNotNull prepend="," property="endtime">ENDTIME</isNotNull>
			<isNotNull prepend="," property="fixdate">FIXDATE</isNotNull>
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="equipment_j_id">#equipment_j_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="equipment_id">#equipment_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="show_shop_code">#show_shop_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="equipment_num">#equipment_num:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="addman">#addman:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="addtime">#addtime:DATETIME#</isNotNull>
			<isNotNull prepend="," property="startime">#startime:DATETIME#</isNotNull>
			<isNotNull prepend="," property="endtime">#endtime:DATETIME#</isNotNull>
			<isNotNull prepend="," property="fixdate">#fixdate:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>
	
	<update id="updateKonkaParagonEquipmentJ" parameterClass="konkaParagonEquipmentJ">
		update KONKA_PARAGON_EQUIPMENT_J
		<dynamic prepend="set">
			<isNotNull prepend="," property="equipment_j_id">EQUIPMENT_J_ID = #equipment_j_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="equipment_id">EQUIPMENT_ID = #equipment_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="show_shop_code">SHOW_SHOP_CODE = #show_shop_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="equipment_num">EQUIPMENT_NUM = #equipment_num:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="addman">ADDMAN = #addman:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="addtime">ADDTIME = #addtime:DATETIME#</isNotNull>
			<isNotNull prepend="," property="startime">STARTIME = #startime:DATETIME#</isNotNull>
			<isNotNull prepend="," property="endtime">ENDTIME = #endtime:DATETIME#</isNotNull>
			<isNotNull prepend="," property="fixdate">FIXDATE = #fixdate:VARCHAR#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="equipment_j_id">EQUIPMENT_J_ID = #equipment_j_id#</isNotEmpty>
		<isEmpty prepend=" " property="equipment_j_id">
			<isNotEmpty prepend=" " property="map.pks">
				EQUIPMENT_J_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteKonkaParagonEquipmentJ" parameterClass="konkaParagonEquipmentJ">
		delete from KONKA_PARAGON_EQUIPMENT_J where
		<isNotEmpty prepend=" " property="equipment_j_id">EQUIPMENT_J_ID = #equipment_j_id#</isNotEmpty>
		<isNotEmpty prepend=" " property="show_shop_code">SHOW_SHOP_CODE = #show_shop_code#</isNotEmpty>
		<isEmpty prepend=" " property="equipment_j_id">
			<isNotEmpty prepend=" " property="map.pks">
				EQUIPMENT_J_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>
</sqlMap>
