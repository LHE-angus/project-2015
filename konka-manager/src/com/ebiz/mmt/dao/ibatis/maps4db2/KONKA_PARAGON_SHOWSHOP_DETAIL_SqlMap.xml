<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KonkaParagonShowshopDetail">

    <typeAlias alias="konkaParagonShowshopDetail" type="com.ebiz.mmt.domain.KonkaParagonShowshopDetail" />
	
    <resultMap id="konkaParagonShowshopDetailResult" class="konkaParagonShowshopDetail">
		<result property="show_shop_id" column="SHOW_SHOP_ID" jdbcType="DECIMAL" />
		<result property="show_shop_code" column="SHOW_SHOP_CODE" jdbcType="VARCHAR" />
		<result property="area_id" column="AREA_ID" jdbcType="DECIMAL" />
		<result property="part_company_id" column="PART_COMPANY_ID" jdbcType="DECIMAL" />
		<result property="channel_id" column="CHANNEL_ID" jdbcType="DECIMAL" />
		<result property="custom_type" column="CUSTOM_TYPE" jdbcType="DECIMAL" />
		<result property="custom_name" column="CUSTOM_NAME" jdbcType="VARCHAR" />
		<result property="if_seller" column="IF_SELLER" jdbcType="DECIMAL" />
		<result property="show_shop_name" column="SHOW_SHOP_NAME" jdbcType="VARCHAR" />
		<result property="addman" column="ADDMAN" jdbcType="DECIMAL" />
		<result property="addtime" column="ADDTIME" jdbcType="DATETIME" />
		<result property="showt_id" column="SHOWT_ID" jdbcType="DECIMAL" />
		<result property="showt_area" column="SHOWT_AREA" jdbcType="DECIMAL" />
		<result property="showt_type" column="SHOWT_TYPE" jdbcType="VARCHAR" />
		<result property="showt_mile" column="SHOWT_MILE" jdbcType="DECIMAL" />
		<result property="showt_time" column="SHOWT_TIME" jdbcType="DATETIME" />
		<result property="showt_cash" column="SHOWT_CASH" jdbcType="DECIMAL" />
		<result property="sales" column="SALES" jdbcType="DECIMAL" />
		<result property="etcash" column="ETCASH" jdbcType="DECIMAL" />
		<result property="seller_num" column="SELLER_NUM" jdbcType="DECIMAL" />
		<result property="have_interface" column="HAVE_INTERFACE" jdbcType="DECIMAL" />
		<result property="macnum" column="MACNUM" jdbcType="DECIMAL" />
    </resultMap>
	<resultMap class="konkaParagonShowshopDetail" id="konkaParagonShowshopDetailResultForList" extends="konkaParagonShowshopDetailResult">
		<result property="map.part_company_name" column="PART_COMPANY_NAME" jdbcType="VARCHAR" />
	</resultMap>
	<sql id="sf-konkaParagonShowshopDetail">
		<isNotEmpty prepend=" and " property="show_shop_id">a.SHOW_SHOP_ID = #show_shop_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="show_shop_code">a.SHOW_SHOP_CODE = #show_shop_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="area_id">a.AREA_ID = #area_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="part_company_id">a.PART_COMPANY_ID = #part_company_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="channel_id">a.CHANNEL_ID = #channel_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="custom_type">a.CUSTOM_TYPE = #custom_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="custom_name">a.CUSTOM_NAME = #custom_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="if_seller">a.IF_SELLER = #if_seller:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="show_shop_name">a.SHOW_SHOP_NAME = #show_shop_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addman">a.ADDMAN = #addman:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addtime">a.ADDTIME = #addtime:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="showt_id">a.SHOWT_ID = #showt_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="showt_area">a.SHOWT_AREA = #showt_area:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="showt_type">a.SHOWT_TYPE = #showt_type:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="showt_mile">a.SHOWT_MILE = #showt_mile:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="showt_time">a.SHOWT_TIME = #showt_time:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="showt_cash">a.SHOWT_CASH = #showt_cash:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sales">a.SALES = #sales:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="etcash">a.ETCASH = #etcash:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="seller_num">a.SELLER_NUM = #seller_num:DECIMAL#</isNotEmpty>
		
		<isNotEmpty prepend=" and " property="map.have_interface">a.HAVE_INTERFACE > 0</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.havet_interface">a.HAVE_INTERFACE is null</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.shop_name_like">a.SHOW_SHOP_NAME like '%' || #map.shop_name_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.custom_name_like">a.CUSTOM_NAME like '%' || #map.custom_name_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.date_start"><![CDATA[a.SHOWT_TIME >= #map.date_start# ]]></isNotEmpty>
	    <isNotEmpty prepend=" and " property="map.date_end"><![CDATA[a.SHOWT_TIME <= #map.date_end#]]></isNotEmpty>
	</sql>
	
	<select id="selectKonkaParagonShowshopDetail" resultMap="konkaParagonShowshopDetailResultForList" parameterClass="konkaParagonShowshopDetail">
		select a.*,
				(select t1.dept_name from konka_dept t1 where t1.dept_id = a.part_company_id and t1.dept_type = 3)as part_company_name,
				(select t2.dept_name from konka_dept t2 where t2.dept_id = a.channel_id and t2.dept_type in (4, 5))as real_channel_name
			 from (
				SELECT A.*,
			       A1.SHOWT_ID,a1.showt_area,a1.showt_type,a1.showt_mile,a1.showt_time,a1.showt_cash,
			       (SELECT B.SALES
			          FROM KONKA_PARAGON_SALES B
			         WHERE B.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
				           <isNotEmpty prepend=" and " property="map.year">B.SALE_YEAR = #map.year#</isNotEmpty>
				           ) AS SALES,
				       (SELECT C.ENTER_TICKET
				          FROM KONKA_PARAGON_ETCASH C
				         WHERE C.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
				           <isNotEmpty prepend=" and " property="map.year">C.ET_YEAR = #map.year#</isNotEmpty>
		           	) AS ETCASH,
			       (SELECT COUNT(D.SELLER_ID)
			          FROM KONKA_PARAGON_MANINFO D
			         WHERE D.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE) AS SELLER_NUM
			  FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SHOWT A1
			 WHERE A.SHOW_SHOP_CODE = A1.SHOW_SHOP_CODE
		) a where 1=1
		<include refid="sf-konkaParagonShowshopDetail" />
	</select>
	
	<select id="selectKonkaParagonShowshopDetailList" resultMap="konkaParagonShowshopDetailResultForList" parameterClass="konkaParagonShowshopDetail">
		<isNotEmpty property="row.count"><![CDATA[ select * from ( ]]></isNotEmpty>
		SELECT a.* FROM
	   (SELECT A.*,
		       A1.DEPT_NAME AS PART_COMPANY_NAME,
		       A2.EQUIPMENT_NUM AS HAVE_INTERFACE,
		       A3.EQUIPMENT_NUM AS MACNUM,
		       A4.SHOWT_ID,
		       A4.SHOWT_AREA,
		       A4.SHOWT_TYPE,
		       A4.SHOWT_MILE,
		       A4.SHOWT_TIME,
		       A4.SHOWT_CASH,
		       B1.SALES,
		       B2.ENTER_TICKET AS ETCASH,
		       (SELECT COUNT(D.SELLER_ID)
		          FROM KONKA_PARAGON_MANINFO D
		         WHERE D.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
		           AND D.FIXDATE = #map.fixdate#) AS SELLER_NUM
		  FROM KONKA_PARAGON_SHOWINFO A
		  LEFT JOIN KONKA_DEPT A1 ON A1.DEPT_ID = A.PART_COMPANY_ID
		                         AND A1.DEPT_TYPE = 3
		  LEFT JOIN KONKA_PARAGON_EQUIPMENT_J A2 ON A2.SHOW_SHOP_CODE =
		                                            A.SHOW_SHOP_CODE
		                                        AND A2.EQUIPMENT_ID = 1
		                                        AND A2.FIXDATE = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_EQUIPMENT_J A3 ON A3.SHOW_SHOP_CODE =
		                                            A.SHOW_SHOP_CODE
		                                        AND A3.EQUIPMENT_ID = 2
		                                        AND A2.FIXDATE = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_SHOWT A4 ON A.SHOW_SHOP_CODE = A4.SHOW_SHOP_CODE
		                                  AND A4.FIXDATE = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_SALES B1 ON B1.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
		                                  AND B1.SALE_YEAR = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_ETCASH B2 ON B2.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
		                                   AND B2.ET_YEAR = #map.fixdate#) a
			WHERE 1 = 1
		<include refid="sf-konkaParagonShowshopDetail" />
		<isNotEmpty prepend=" and " property="map.sales_start">
			<![CDATA[ A.SALES >= #map.sales_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.sales_end">
			<![CDATA[ A.SALES <= #map.sales_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.mile_start">
			<![CDATA[ A.SHOWT_MILE >= #map.mile_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.mile_end">
			<![CDATA[ A.SHOWT_MILE <= #map.mile_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.spare_start">
			<![CDATA[ A.SHOWT_AREA >= #map.spare_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.spare_end">
			<![CDATA[ A.SHOWT_AREA <= #map.spare_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cash_start">
			<![CDATA[ A.SHOWT_CASH >= #map.cash_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cash_end">
			<![CDATA[ A.SHOWT_CASH <= #map.cash_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.et_start">
			<![CDATA[ A.ETCASH >= #map.et_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.et_end">
			<![CDATA[ A.ETCASH <= #map.et_end# ]]>
		</isNotEmpty>
 			ORDER BY A.SHOW_SHOP_ID DESC
		<isNotEmpty property="row.count"><![CDATA[ ) where rownum<=#row.count# ]]></isNotEmpty>
	</select>
	
	<select id="selectKonkaParagonShowshopDetailCount" resultClass="long" parameterClass="konkaParagonShowshopDetail">
		SELECT COUNT(*) FROM
	   (SELECT A.*,
		       A1.DEPT_NAME AS PART_COMPANY_NAME,
		       A2.EQUIPMENT_NUM AS HAVE_INTERFACE,
		       A3.EQUIPMENT_NUM AS MACNUM,
		       A4.SHOWT_ID,
		       A4.SHOWT_AREA,
		       A4.SHOWT_TYPE,
		       A4.SHOWT_MILE,
		       A4.SHOWT_TIME,
		       A4.SHOWT_CASH,
		       B1.SALES,
		       B2.ENTER_TICKET AS ETCASH,
		       (SELECT COUNT(D.SELLER_ID)
		          FROM KONKA_PARAGON_MANINFO D
		         WHERE D.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
		           AND D.FIXDATE = #map.fixdate#) AS SELLER_NUM
		  FROM KONKA_PARAGON_SHOWINFO A
		  LEFT JOIN KONKA_DEPT A1 ON A1.DEPT_ID = A.PART_COMPANY_ID
		                         AND A1.DEPT_TYPE = 3
		  LEFT JOIN KONKA_PARAGON_EQUIPMENT_J A2 ON A2.SHOW_SHOP_CODE =
		                                            A.SHOW_SHOP_CODE
		                                        AND A2.EQUIPMENT_ID = 1
		                                        AND A2.FIXDATE = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_EQUIPMENT_J A3 ON A3.SHOW_SHOP_CODE =
		                                            A.SHOW_SHOP_CODE
		                                        AND A3.EQUIPMENT_ID = 2
		                                        AND A2.FIXDATE = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_SHOWT A4 ON A.SHOW_SHOP_CODE = A4.SHOW_SHOP_CODE
		                                  AND A4.FIXDATE = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_SALES B1 ON B1.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
		                                  AND B1.SALE_YEAR = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_ETCASH B2 ON B2.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
		                                   AND B2.ET_YEAR = #map.fixdate#) a
		 WHERE 1 = 1
		<include refid="sf-konkaParagonShowshopDetail" />
		<isNotEmpty prepend=" and " property="map.sales_start">
			<![CDATA[ A.SALES >= #map.sales_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.sales_end">
			<![CDATA[ A.SALES <= #map.sales_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.mile_start">
			<![CDATA[ A.SHOWT_MILE >= #map.mile_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.mile_end">
			<![CDATA[ A.SHOWT_MILE <= #map.mile_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.spare_start">
			<![CDATA[ A.SHOWT_AREA >= #map.spare_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.spare_end">
			<![CDATA[ A.SHOWT_AREA <= #map.spare_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cash_start">
			<![CDATA[ A.SHOWT_CASH >= #map.cash_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cash_end">
			<![CDATA[ A.SHOWT_CASH <= #map.cash_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.et_start">
			<![CDATA[ A.ETCASH >= #map.et_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.et_end">
			<![CDATA[ A.ETCASH <= #map.et_end# ]]>
		</isNotEmpty>
	</select>
	
	<select id="selectKonkaParagonShowshopDetailPaginatedList" resultMap="konkaParagonShowshopDetailResultForList" parameterClass="konkaParagonShowshopDetail">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		SELECT a.* FROM
	   (SELECT A.*,
		       A1.DEPT_NAME AS PART_COMPANY_NAME,
		       A2.EQUIPMENT_NUM AS HAVE_INTERFACE,
		       A3.EQUIPMENT_NUM AS MACNUM,
		       A4.SHOWT_ID,
		       A4.SHOWT_AREA,
		       A4.SHOWT_TYPE,
		       A4.SHOWT_MILE,
		       A4.SHOWT_TIME,
		       A4.SHOWT_CASH,
		       B1.SALES,
		       B2.ENTER_TICKET AS ETCASH,
		       (SELECT COUNT(D.SELLER_ID)
		          FROM KONKA_PARAGON_MANINFO D
		         WHERE D.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
		           AND D.FIXDATE = #map.fixdate#) AS SELLER_NUM
		  FROM KONKA_PARAGON_SHOWINFO A
		  LEFT JOIN KONKA_DEPT A1 ON A1.DEPT_ID = A.PART_COMPANY_ID
		                         AND A1.DEPT_TYPE = 3
		  LEFT JOIN KONKA_PARAGON_EQUIPMENT_J A2 ON A2.SHOW_SHOP_CODE =
		                                            A.SHOW_SHOP_CODE
		                                        AND A2.EQUIPMENT_ID = 1
		                                        AND A2.FIXDATE = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_EQUIPMENT_J A3 ON A3.SHOW_SHOP_CODE =
		                                            A.SHOW_SHOP_CODE
		                                        AND A3.EQUIPMENT_ID = 2
		                                        AND A2.FIXDATE = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_SHOWT A4 ON A.SHOW_SHOP_CODE = A4.SHOW_SHOP_CODE
		                                  AND A4.FIXDATE = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_SALES B1 ON B1.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
		                                  AND B1.SALE_YEAR = #map.fixdate#
		  LEFT JOIN KONKA_PARAGON_ETCASH B2 ON B2.SHOW_SHOP_CODE = A.SHOW_SHOP_CODE
		                                   AND B2.ET_YEAR = #map.fixdate#) a
		 WHERE 1 = 1
		<include refid="sf-konkaParagonShowshopDetail" />
		<isNotEmpty prepend=" and " property="map.sales_start">
			<![CDATA[ A.SALES >= #map.sales_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.sales_end">
			<![CDATA[ A.SALES <= #map.sales_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.mile_start">
			<![CDATA[ A.SHOWT_MILE >= #map.mile_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.mile_end">
			<![CDATA[ A.SHOWT_MILE <= #map.mile_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.spare_start">
			<![CDATA[ A.SHOWT_AREA >= #map.spare_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.spare_end">
			<![CDATA[ A.SHOWT_AREA <= #map.spare_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cash_start">
			<![CDATA[ A.SHOWT_CASH >= #map.cash_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cash_end">
			<![CDATA[ A.SHOWT_CASH <= #map.cash_end# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.et_start">
			<![CDATA[ A.ETCASH >= #map.et_start# ]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.et_end">
			<![CDATA[ A.ETCASH <= #map.et_end# ]]>
		</isNotEmpty>
 			ORDER BY A.SHOW_SHOP_ID DESC
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<insert id="auotInsertKonkaParagonEQU" parameterClass="konkaParagonShowinfo">
		INSERT INTO KONKA_PARAGON_EQUIPMENT_J
		  (SELECT A.EQUIPMENT_J_ID,
		          A.EQUIPMENT_ID,
		          A.SHOW_SHOP_CODE,
		          A.EQUIPMENT_NUM,
		          A.ADDMAN,
		          A.ADDTIME,
		          A.STARTIME,
		          A.ENDTIME,
		          #map.fixdate#
		     FROM KONKA_PARAGON_EQUIPMENT_J A
		    WHERE A.FIXDATE = #map.olddate#
		      AND A.SHOW_SHOP_CODE NOT IN
		          (SELECT DISTINCT *
		             FROM ((SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO    A,
		                           KONKA_PARAGON_EQUIPMENT_J B
		                     WHERE A.SHOW_SHOP_CODE = B.SHOW_SHOP_CODE
		                       AND B.FIXDATE = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SHOWT C
		                     WHERE A.SHOW_SHOP_CODE = C.SHOW_SHOP_CODE
		                       AND C.FIXDATE = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SALES D
		                     WHERE A.SHOW_SHOP_CODE = D.SHOW_SHOP_CODE
		                       AND D.SALE_YEAR = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_ETCASH E
		                     WHERE A.SHOW_SHOP_CODE = E.SHOW_SHOP_CODE
		                       AND E.ET_YEAR = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_MANINFO F
		                     WHERE A.SHOW_SHOP_CODE = F.SHOW_SHOP_CODE
		                       AND F.FIXDATE = #map.fixdate#))))
	</insert>
	<insert id="auotInsertKonkaParagonSHT" parameterClass="konkaParagonShowinfo">
		INSERT INTO KONKA_PARAGON_SHOWT
		  (SELECT A.SHOWT_ID,
				  A.SHOWT_AREA,
				  A.SHOWT_TYPE,
				  A.SHOWT_MILE,
				  A.SHOWT_TIME,
				  A.SHOWT_CASH,
				  A.SHOW_SHOP_CODE,
				  A.ADDMAN,
				  A.ADDTIME,
				  A.REMARK,
				  A.VERSION_ID,
		          #map.fixdate#
		     FROM KONKA_PARAGON_SHOWT A
		    WHERE A.FIXDATE = #map.olddate#
		      AND A.SHOW_SHOP_CODE NOT IN
		          (SELECT DISTINCT *
		             FROM ((SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO    A,
		                           KONKA_PARAGON_EQUIPMENT_J B
		                     WHERE A.SHOW_SHOP_CODE = B.SHOW_SHOP_CODE
		                       AND B.FIXDATE = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SHOWT C
		                     WHERE A.SHOW_SHOP_CODE = C.SHOW_SHOP_CODE
		                       AND C.FIXDATE = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SALES D
		                     WHERE A.SHOW_SHOP_CODE = D.SHOW_SHOP_CODE
		                       AND D.SALE_YEAR = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_ETCASH E
		                     WHERE A.SHOW_SHOP_CODE = E.SHOW_SHOP_CODE
		                       AND E.ET_YEAR = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_MANINFO F
		                     WHERE A.SHOW_SHOP_CODE = F.SHOW_SHOP_CODE
		                       AND F.FIXDATE = #map.fixdate#))))
	</insert>
	<insert id="auotInsertKonkaParagonSAL" parameterClass="konkaParagonShowinfo">
		INSERT INTO KONKA_PARAGON_SALES
		  (SELECT A.SALES_ID,
		  		  A.SHOW_SHOP_CODE,
		  		  A.SALES,
		  		  #map.fixdate#,
		  		  A.ADDMAN,
		  		  A.ADDTIME
		     FROM KONKA_PARAGON_SALES A
		    WHERE A.SALE_YEAR = #map.olddate#
		      AND A.SHOW_SHOP_CODE NOT IN
		          (SELECT DISTINCT *
		             FROM ((SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO    A,
		                           KONKA_PARAGON_EQUIPMENT_J B
		                     WHERE A.SHOW_SHOP_CODE = B.SHOW_SHOP_CODE
		                       AND B.FIXDATE = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SHOWT C
		                     WHERE A.SHOW_SHOP_CODE = C.SHOW_SHOP_CODE
		                       AND C.FIXDATE = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SALES D
		                     WHERE A.SHOW_SHOP_CODE = D.SHOW_SHOP_CODE
		                       AND D.SALE_YEAR = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_ETCASH E
		                     WHERE A.SHOW_SHOP_CODE = E.SHOW_SHOP_CODE
		                       AND E.ET_YEAR = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_MANINFO F
		                     WHERE A.SHOW_SHOP_CODE = F.SHOW_SHOP_CODE
		                       AND F.FIXDATE = #map.fixdate#))))
	</insert>
	<insert id="auotInsertKonkaParagonETC" parameterClass="konkaParagonShowinfo">
		INSERT INTO KONKA_PARAGON_ETCASH
		  (SELECT A.ET_ID,
		  		  A.SHOW_SHOP_CODE,
		  		  A.ENTER_TICKET,
		  		  #map.fixdate#,
		  		  A.ADDMAN,
		  		  A.ADDTIME
		     FROM KONKA_PARAGON_ETCASH A
		    WHERE A.ET_YEAR = #map.olddate#
		      AND A.SHOW_SHOP_CODE NOT IN
		          (SELECT DISTINCT *
		             FROM ((SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO    A,
		                           KONKA_PARAGON_EQUIPMENT_J B
		                     WHERE A.SHOW_SHOP_CODE = B.SHOW_SHOP_CODE
		                       AND B.FIXDATE = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SHOWT C
		                     WHERE A.SHOW_SHOP_CODE = C.SHOW_SHOP_CODE
		                       AND C.FIXDATE = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SALES D
		                     WHERE A.SHOW_SHOP_CODE = D.SHOW_SHOP_CODE
		                       AND D.SALE_YEAR = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_ETCASH E
		                     WHERE A.SHOW_SHOP_CODE = E.SHOW_SHOP_CODE
		                       AND E.ET_YEAR = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_MANINFO F
		                     WHERE A.SHOW_SHOP_CODE = F.SHOW_SHOP_CODE
		                       AND F.FIXDATE = #map.fixdate#))))
	</insert>
	<insert id="auotInsertKonkaParagonMAN" parameterClass="konkaParagonShowinfo">
		INSERT INTO KONKA_PARAGON_MANINFO
		  (SELECT A.SELLER_ID,
		  		  A.SELLER_NAME,
		  		  A.SELLER_CODE,
		  		  A.SELLER_PHONE,
		  		  A.SHOW_SHOP_CODE,
		  		  A.ADDMAN,
		  		  A.ADDTIME,
		  		  A.SELLER_BANK_COUNT,
		  		  A.SELLER_IN,
		  		  #map.fixdate#
		     FROM KONKA_PARAGON_MANINFO A
		    WHERE A.FIXDATE = #map.olddate#
		      AND A.SHOW_SHOP_CODE NOT IN
		          (SELECT DISTINCT *
		             FROM ((SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO    A,
		                           KONKA_PARAGON_EQUIPMENT_J B
		                     WHERE A.SHOW_SHOP_CODE = B.SHOW_SHOP_CODE
		                       AND B.FIXDATE = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SHOWT C
		                     WHERE A.SHOW_SHOP_CODE = C.SHOW_SHOP_CODE
		                       AND C.FIXDATE = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_SALES D
		                     WHERE A.SHOW_SHOP_CODE = D.SHOW_SHOP_CODE
		                       AND D.SALE_YEAR = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_ETCASH E
		                     WHERE A.SHOW_SHOP_CODE = E.SHOW_SHOP_CODE
		                       AND E.ET_YEAR = #map.fixdate#) UNION ALL
		                   (SELECT A.SHOW_SHOP_CODE
		                      FROM KONKA_PARAGON_SHOWINFO A, KONKA_PARAGON_MANINFO F
		                     WHERE A.SHOW_SHOP_CODE = F.SHOW_SHOP_CODE
		                       AND F.FIXDATE = #map.fixdate#))))
	</insert>

</sqlMap>
