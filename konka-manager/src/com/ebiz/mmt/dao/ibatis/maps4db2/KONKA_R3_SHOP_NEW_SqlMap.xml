<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KONKA_R3_SHOP_NEW">

	<typeAlias alias="konkaR3ShopNew" type="com.ebiz.mmt.domain.KonkaR3ShopNew" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertKonkaR3ShopNew" />
		<flushOnExecute statement="updateKonkaR3ShopNew" />
		<flushOnExecute statement="deleteKonkaR3ShopNew" />
	</cacheModel>

	<resultMap id="konkaR3ShopNewResultForList" class="konkaR3ShopNew">
		<result column="CUST_ID" property="cust_id" jdbcType="DECIMAL" />
		<result column="LINK_MAN_NAME" property="link_man_name" jdbcType="VARCHAR" />
		<result column="LINK_MAN_TEL" property="link_man_tel" jdbcType="VARCHAR" />
		<result column="LINK_MAN_MOBILE" property="link_man_mobile" jdbcType="VARCHAR" />
		<result column="LINK_MAN_ADDR" property="link_man_addr" jdbcType="VARCHAR" />
		<result column="LINK_MAN_POST" property="link_man_post" jdbcType="VARCHAR" />
		<result column="HOST_NAME" property="host_name" jdbcType="VARCHAR" />
		<result column="HOST_TEL" property="host_tel" jdbcType="VARCHAR" />
		<result column="CUST_NAME" property="cust_name" jdbcType="VARCHAR" />
		<result column="ADD_DATE" property="add_date" jdbcType="TIMESTAMP" />
		<result column="ENTP_TYPE" property="entp_type" jdbcType="DECIMAL" />
		<result column="ENTP_REG_MONEY" property="entp_reg_money" jdbcType="DECIMAL" />
		<result column="ENTP_SCALE" property="entp_scale" jdbcType="VARCHAR" />
		<result column="TOTAL_AREA" property="total_area" jdbcType="DECIMAL" />
		<result column="TOTAL_SALE" property="total_sale" jdbcType="DECIMAL" />
		<result column="ENTP_MAN_COUNT" property="entp_man_count" jdbcType="VARCHAR" />
		<result column="ENTP_TEL" property="entp_tel" jdbcType="VARCHAR" />
		<result column="ENTP_BIRTHDAY" property="entp_birthday" jdbcType="TIMESTAMP" />
		<result column="ENTP_FAX" property="entp_fax" jdbcType="VARCHAR" />
		<result column="ENTP_POST" property="entp_post" jdbcType="VARCHAR" />
		<result column="ENTP_P_INDEX" property="entp_p_index" jdbcType="DECIMAL" />
		<result column="ENTP_P_LEVEL" property="entp_p_level" jdbcType="VARCHAR" />
		<result column="ENTP_ADDR" property="entp_addr" jdbcType="VARCHAR" />
		<result column="ENTP_WWW" property="entp_www" jdbcType="VARCHAR" />
		<result column="ENTP_MAIN_PDS" property="entp_main_pds" jdbcType="VARCHAR" />
		<result column="SUBCOMP_ID" property="subcomp_id" jdbcType="DECIMAL" />
		<result column="YWY_USER_ID" property="ywy_user_id" jdbcType="DECIMAL" />
		<result column="IS_DEL" property="is_del" jdbcType="DECIMAL" />
		<result column="IS_MATCH" property="is_match" jdbcType="DECIMAL" />
		<result column="B_LNG" property="b_lng" jdbcType="VARCHAR" />
		<result column="B_LAT" property="b_lat" jdbcType="VARCHAR" />
		<result column="LINK_R3_CODE" property="link_r3_code" jdbcType="VARCHAR" />
		<result column="MEMO" property="memo" jdbcType="VARCHAR" />
		<result column="JB_ID" property="jb_id" jdbcType="DECIMAL" />
		<result column="CUSTOMER_TYPE" property="customer_type" jdbcType="DECIMAL" />
		<result column="TOTAL_MALLS" property="total_malls" jdbcType="DECIMAL" />
		<result column="IS_SALED" property="is_saled" jdbcType="DECIMAL" />
		<result column="OUT_DATE" property="out_date" jdbcType="TIMESTAMP" />
		<result column="OUT_REASON" property="out_reason" jdbcType="VARCHAR" />
		<result column="LEAVE_QUESTION" property="leave_question" jdbcType="VARCHAR" />
		<result column="IS_NEW" property="is_new" jdbcType="DECIMAL" />
		<result column="AUDIT_STAT" property="audit_stat" jdbcType="DECIMAL" />
		<result column="IS_SYN" property="is_syn" jdbcType="DECIMAL" />
		<result column="MODIFY_DATE" property="modify_date" jdbcType="TIMESTAMP" />
		<result column="ADD_USER_ID" property="add_user_id" jdbcType="DECIMAL" />
		<result column="MODY_USER_ID" property="mody_user_id" jdbcType="DECIMAL" />
		<result column="CUR_AUDIT_USER_ID" property="cur_audit_user_id" jdbcType="DECIMAL" />
		<result column="RECORD_SN" property="record_sn" jdbcType="VARCHAR" />
		<result column="YWY_JOB_ID" property="ywy_job_id" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="konkaR3ShopNewResult" class="konkaR3ShopNew" extends="konkaR3ShopNewResultForList">
	</resultMap>
	
	<resultMap id="konkaR3ShopNewResultForView" class="konkaR3ShopNew" extends="konkaR3ShopNewResultForList">
	    <result column="JB_NAME" property="map.jb_name" jdbcType="VARCHAR" />
	    <result column="YWY_NAME" property="map.ywy_name" jdbcType="VARCHAR" />
	</resultMap>

	<sql id="sf-konkaR3ShopNew">
		<isNotEmpty prepend=" and " property="cust_id">CUST_ID = #cust_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_man_name">LINK_MAN_NAME = #link_man_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_man_tel">LINK_MAN_TEL = #link_man_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_man_mobile">LINK_MAN_MOBILE = #link_man_mobile:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_man_addr">LINK_MAN_ADDR = #link_man_addr:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_man_post">LINK_MAN_POST = #link_man_post:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="host_name">HOST_NAME = #host_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="host_tel">HOST_TEL = #host_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="cust_name">CUST_NAME = #cust_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_type">ENTP_TYPE = #entp_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_reg_money">ENTP_REG_MONEY = #entp_reg_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_scale">ENTP_SCALE = #entp_scale:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="total_area">TOTAL_AREA = #total_area:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="total_sale">TOTAL_SALE = #total_sale:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_man_count">ENTP_MAN_COUNT = #entp_man_count:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_tel">ENTP_TEL = #entp_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_birthday">ENTP_BIRTHDAY = #entp_birthday:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_fax">ENTP_FAX = #entp_fax:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_post">ENTP_POST = #entp_post:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_p_index">ENTP_P_INDEX = #entp_p_index:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_p_level">ENTP_P_LEVEL = #entp_p_level:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_addr">ENTP_ADDR = #entp_addr:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_www">ENTP_WWW = #entp_www:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_main_pds">ENTP_MAIN_PDS = #entp_main_pds:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="subcomp_id">SUBCOMP_ID = #subcomp_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="ywy_user_id">YWY_USER_ID = #ywy_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_match">IS_MATCH = #is_match:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="b_lng">B_LNG = #b_lng:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="b_lat">B_LAT = #b_lat:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_r3_code">LINK_R3_CODE = #link_r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="memo">MEMO = #memo:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="jb_id">JB_ID = #jb_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="customer_type">CUSTOMER_TYPE = #customer_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="total_malls">TOTAL_MALLS = #total_malls:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_saled">IS_SALED = #is_saled:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="out_date">OUT_DATE = #out_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="out_reason">OUT_REASON = #out_reason:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="leave_question">LEAVE_QUESTION = #leave_question:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_new">IS_NEW = #is_new:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="audit_stat">AUDIT_STAT = #audit_stat:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_syn">IS_SYN = #is_syn:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="modify_date">MODIFY_DATE = #modify_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">ADD_USER_ID = #add_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="mody_user_id">MODY_USER_ID = #mody_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="cur_audit_user_id">CUR_AUDIT_USER_ID = #cur_audit_user_id:DECIMAL#</isNotEmpty>
	</sql>
	
	<sql id="sf-konkaR3ShopNew-a">
		<isNotEmpty prepend=" and " property="cust_id">a.CUST_ID = #cust_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_man_name">a.LINK_MAN_NAME = #link_man_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_man_tel">a.LINK_MAN_TEL = #link_man_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_man_mobile">a.LINK_MAN_MOBILE = #link_man_mobile:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_man_addr">a.LINK_MAN_ADDR = #link_man_addr:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_man_post">a.LINK_MAN_POST = #link_man_post:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="host_name">a.HOST_NAME = #host_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="host_tel">a.HOST_TEL = #host_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="cust_name">a.CUST_NAME = #cust_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">a.ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_type">a.ENTP_TYPE = #entp_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_reg_money">a.ENTP_REG_MONEY = #entp_reg_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_scale">a.ENTP_SCALE = #entp_scale:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="total_area">a.TOTAL_AREA = #total_area:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="total_sale">a.TOTAL_SALE = #total_sale:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_man_count">a.ENTP_MAN_COUNT = #entp_man_count:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_tel">a.ENTP_TEL = #entp_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_birthday">a.ENTP_BIRTHDAY = #entp_birthday:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_fax">a.ENTP_FAX = #entp_fax:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_post">a.ENTP_POST = #entp_post:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_p_index">a.ENTP_P_INDEX = #entp_p_index:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_p_level">a.ENTP_P_LEVEL = #entp_p_level:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_addr">a.ENTP_ADDR = #entp_addr:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_www">a.ENTP_WWW = #entp_www:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_main_pds">a.ENTP_MAIN_PDS = #entp_main_pds:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="subcomp_id">a.SUBCOMP_ID = #subcomp_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="ywy_user_id">a.YWY_USER_ID = #ywy_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">a.IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_match">a.IS_MATCH = #is_match:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="b_lng">a.B_LNG = #b_lng:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="b_lat">a.B_LAT = #b_lat:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_r3_code">a.LINK_R3_CODE = #link_r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="memo">a.MEMO = #memo:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="jb_id">a.JB_ID = #jb_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="customer_type">a.CUSTOMER_TYPE = #customer_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="total_malls">a.TOTAL_MALLS = #total_malls:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_saled">a.IS_SALED = #is_saled:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="out_date">a.OUT_DATE = #out_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="out_reason">a.OUT_REASON = #out_reason:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="leave_question">a.LEAVE_QUESTION = #leave_question:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_new">a.IS_NEW = #is_new:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="audit_stat">a.AUDIT_STAT = #audit_stat:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_syn">a.IS_SYN = #is_syn:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="modify_date">a.MODIFY_DATE = #modify_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">a.ADD_USER_ID = #add_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="mody_user_id">a.MODY_USER_ID = #mody_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="cur_audit_user_id">a.CUR_AUDIT_USER_ID = #cur_audit_user_id:DECIMAL#</isNotEmpty>
	</sql>

	<select id="selectKonkaR3ShopNew" resultMap="konkaR3ShopNewResultForView" parameterClass="konkaR3ShopNew" cacheModel="oneDayCache">
		select a.*,jb.dept_name as jb_name,u.user_name as ywy_name from KONKA_R3_SHOP_NEW a
		left join Konka_Dept jb on jb.dept_id=a.jb_id
		left join konka_pe_prod_user u on u.job_id=a.ywy_job_id
		where 1 = 1
		<include refid="sf-konkaR3ShopNew-a" />
	</select>

	<select id="selectKonkaR3ShopNewList" resultMap="konkaR3ShopNewResultForList" parameterClass="konkaR3ShopNew" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from KONKA_R3_SHOP_NEW where 1 = 1
		<include refid="sf-konkaR3ShopNew" />
		<!-- order by ID asc -->
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectKonkaR3ShopNewCount" resultClass="long" parameterClass="konkaR3ShopNew" cacheModel="oneDayCache">
		select count(*) from KONKA_R3_SHOP_NEW where 1 = 1
		<include refid="sf-konkaR3ShopNew" />
	</select>

	<select id="selectKonkaR3ShopNewPaginatedList" resultMap="konkaR3ShopNewResult" parameterClass="konkaR3ShopNew" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from KONKA_R3_SHOP_NEW where 1 = 1
		<include refid="sf-konkaR3ShopNew" />
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<insert id="insertKonkaR3ShopNew" parameterClass="konkaR3ShopNew">
		<selectKey resultClass="long" keyProperty="cust_id">select SEQ_MOBILE_BUSINESS.nextval as cust_id from dual </selectKey>
		<![CDATA[insert into KONKA_R3_SHOP_NEW (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="cust_id">CUST_ID</isNotNull>	
			<isNotNull prepend="," property="link_man_name">LINK_MAN_NAME</isNotNull>	
			<isNotNull prepend="," property="link_man_tel">LINK_MAN_TEL</isNotNull>	
			<isNotNull prepend="," property="link_man_mobile">LINK_MAN_MOBILE</isNotNull>	
			<isNotNull prepend="," property="link_man_addr">LINK_MAN_ADDR</isNotNull>	
			<isNotNull prepend="," property="link_man_post">LINK_MAN_POST</isNotNull>	
			<isNotNull prepend="," property="host_name">HOST_NAME</isNotNull>	
			<isNotNull prepend="," property="host_tel">HOST_TEL</isNotNull>	
			<isNotNull prepend="," property="cust_name">CUST_NAME</isNotNull>	
			<isNotNull prepend="," property="add_date">ADD_DATE</isNotNull>	
			<isNotNull prepend="," property="entp_type">ENTP_TYPE</isNotNull>	
			<isNotNull prepend="," property="entp_reg_money">ENTP_REG_MONEY</isNotNull>	
			<isNotNull prepend="," property="entp_scale">ENTP_SCALE</isNotNull>	
			<isNotNull prepend="," property="total_area">TOTAL_AREA</isNotNull>	
			<isNotNull prepend="," property="total_sale">TOTAL_SALE</isNotNull>	
			<isNotNull prepend="," property="entp_man_count">ENTP_MAN_COUNT</isNotNull>	
			<isNotNull prepend="," property="entp_tel">ENTP_TEL</isNotNull>	
			<isNotNull prepend="," property="entp_birthday">ENTP_BIRTHDAY</isNotNull>	
			<isNotNull prepend="," property="entp_fax">ENTP_FAX</isNotNull>	
			<isNotNull prepend="," property="entp_post">ENTP_POST</isNotNull>	
			<isNotNull prepend="," property="entp_p_index">ENTP_P_INDEX</isNotNull>	
			<isNotNull prepend="," property="entp_p_level">ENTP_P_LEVEL</isNotNull>	
			<isNotNull prepend="," property="entp_addr">ENTP_ADDR</isNotNull>	
			<isNotNull prepend="," property="entp_www">ENTP_WWW</isNotNull>	
			<isNotNull prepend="," property="entp_main_pds">ENTP_MAIN_PDS</isNotNull>	
			<isNotNull prepend="," property="subcomp_id">SUBCOMP_ID</isNotNull>	
			<isNotNull prepend="," property="ywy_user_id">YWY_USER_ID</isNotNull>	
			<isNotNull prepend="," property="is_del">IS_DEL</isNotNull>	
			<isNotNull prepend="," property="is_match">IS_MATCH</isNotNull>	
			<isNotNull prepend="," property="b_lng">B_LNG</isNotNull>	
			<isNotNull prepend="," property="b_lat">B_LAT</isNotNull>	
			<isNotNull prepend="," property="link_r3_code">LINK_R3_CODE</isNotNull>	
			<isNotNull prepend="," property="memo">MEMO</isNotNull>	
			<isNotNull prepend="," property="jb_id">JB_ID</isNotNull>	
			<isNotNull prepend="," property="customer_type">CUSTOMER_TYPE</isNotNull>	
			<isNotNull prepend="," property="total_malls">TOTAL_MALLS</isNotNull>	
			<isNotNull prepend="," property="is_saled">IS_SALED</isNotNull>	
			<isNotNull prepend="," property="out_date">OUT_DATE</isNotNull>	
			<isNotNull prepend="," property="out_reason">OUT_REASON</isNotNull>	
			<isNotNull prepend="," property="leave_question">LEAVE_QUESTION</isNotNull>	
			<isNotNull prepend="," property="is_new">IS_NEW</isNotNull>	
			<isNotNull prepend="," property="audit_stat">AUDIT_STAT</isNotNull>	
			<isNotNull prepend="," property="is_syn">IS_SYN</isNotNull>	
			<isNotNull prepend="," property="modify_date">MODIFY_DATE</isNotNull>	
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID</isNotNull>	
			<isNotNull prepend="," property="mody_user_id">MODY_USER_ID</isNotNull>	
			<isNotNull prepend="," property="cur_audit_user_id">CUR_AUDIT_USER_ID</isNotNull>	
			<isNotNull prepend="," property="record_sn">RECORD_SN</isNotNull>	
			<isNotNull prepend="," property="ywy_job_id">YWY_JOB_ID</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="cust_id">#cust_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="link_man_name">#link_man_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_man_tel">#link_man_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_man_mobile">#link_man_mobile:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_man_addr">#link_man_addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_man_post">#link_man_post:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="host_name">#host_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="host_tel">#host_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="cust_name">#cust_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_date">#add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="entp_type">#entp_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_reg_money">#entp_reg_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_scale">#entp_scale:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="total_area">#total_area:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="total_sale">#total_sale:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_man_count">#entp_man_count:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_tel">#entp_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_birthday">#entp_birthday:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="entp_fax">#entp_fax:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_post">#entp_post:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_p_index">#entp_p_index:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_p_level">#entp_p_level:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_addr">#entp_addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_www">#entp_www:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_main_pds">#entp_main_pds:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="subcomp_id">#subcomp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="ywy_user_id">#ywy_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_del">#is_del:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_match">#is_match:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="b_lng">#b_lng:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="b_lat">#b_lat:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_r3_code">#link_r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="memo">#memo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="jb_id">#jb_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="customer_type">#customer_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="total_malls">#total_malls:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_saled">#is_saled:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_date">#out_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="out_reason">#out_reason:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="leave_question">#leave_question:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="is_new">#is_new:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="audit_stat">#audit_stat:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_syn">#is_syn:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="modify_date">#modify_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="add_user_id">#add_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="mody_user_id">#mody_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="cur_audit_user_id">#cur_audit_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="record_sn">#record_sn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="ywy_job_id">#ywy_job_id:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateKonkaR3ShopNew" parameterClass="KonkaR3ShopNew">
		update KONKA_R3_SHOP_NEW
		<dynamic prepend="set">
			<isNotNull prepend="," property="cust_id">CUST_ID = #cust_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="link_man_name">LINK_MAN_NAME = #link_man_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_man_tel">LINK_MAN_TEL = #link_man_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_man_mobile">LINK_MAN_MOBILE = #link_man_mobile:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_man_addr">LINK_MAN_ADDR = #link_man_addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_man_post">LINK_MAN_POST = #link_man_post:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="host_name">HOST_NAME = #host_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="host_tel">HOST_TEL = #host_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="cust_name">CUST_NAME = #cust_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="entp_type">ENTP_TYPE = #entp_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_reg_money">ENTP_REG_MONEY = #entp_reg_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_scale">ENTP_SCALE = #entp_scale:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="total_area">TOTAL_AREA = #total_area:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="total_sale">TOTAL_SALE = #total_sale:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_man_count">ENTP_MAN_COUNT = #entp_man_count:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_tel">ENTP_TEL = #entp_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_birthday">ENTP_BIRTHDAY = #entp_birthday:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="entp_fax">ENTP_FAX = #entp_fax:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_post">ENTP_POST = #entp_post:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_p_index">ENTP_P_INDEX = #entp_p_index:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_p_level">ENTP_P_LEVEL = #entp_p_level:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_addr">ENTP_ADDR = #entp_addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_www">ENTP_WWW = #entp_www:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_main_pds">ENTP_MAIN_PDS = #entp_main_pds:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="subcomp_id">SUBCOMP_ID = #subcomp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="ywy_user_id">YWY_USER_ID = #ywy_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_del">IS_DEL = #is_del:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_match">IS_MATCH = #is_match:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="b_lng">B_LNG = #b_lng:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="b_lat">B_LAT = #b_lat:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_r3_code">LINK_R3_CODE = #link_r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="memo">MEMO = #memo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="jb_id">JB_ID = #jb_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="customer_type">CUSTOMER_TYPE = #customer_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="total_malls">TOTAL_MALLS = #total_malls:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_saled">IS_SALED = #is_saled:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_date">OUT_DATE = #out_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="out_reason">OUT_REASON = #out_reason:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="leave_question">LEAVE_QUESTION = #leave_question:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="is_new">IS_NEW = #is_new:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="audit_stat">AUDIT_STAT = #audit_stat:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_syn">IS_SYN = #is_syn:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="modify_date">MODIFY_DATE = #modify_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID = #add_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="mody_user_id">MODY_USER_ID = #mody_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="cur_audit_user_id">CUR_AUDIT_USER_ID = #cur_audit_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="record_sn">RECORD_SN = #record_sn:VARCHAR#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="cust_id">CUST_ID = #cust_id#</isNotEmpty>
		<isEmpty prepend=" " property="cust_id">
			<isNotEmpty prepend=" " property="map.pks">
				CUST_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteKonkaR3ShopNew" parameterClass="KonkaR3ShopNew">
		delete from KONKA_R3_SHOP_NEW where
		<isNotEmpty prepend=" " property="cust_id">CUST_ID = #cust_id#</isNotEmpty>
		<isEmpty prepend=" " property="cust_id">
			<isNotEmpty prepend=" " property="map.pks">
				CUST_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

	<!-- 统计新建客户相关查询统计总数 -->
	<select id="selectWaitAuditCustCount" resultClass="long" parameterClass="KonkaR3ShopNew" cacheModel="oneDayCache">
		select count(*) from KONKA_R3_SHOP_NEW new 
		left join konka_pe_prod_user u on new.ywy_user_id=u.id 
		<isNotEmpty prepend=" " property="map.have_audit">
			right join (select distinct(link_id) from KONKAOA_FILES_AUDIT_NODE where 1=1 
			and NODE_TYPE=3 and AUDIT_LEVEL=1 and AGENT_AUDIT_USER_ID=#map.session_user_id# AND AUDIT_RESULT IS NOT NULL
			<isNotEmpty prepend=" and " property="map.audit_result">
				audit_result = #map.audit_result:DECIMAL#
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="map.session_user_id">
				AGENT_AUDIT_USER_ID = #map.session_user_id#
			</isNotEmpty>
			) audit on new.cust_id=audit.link_id
		</isNotEmpty>
		where 1 = 1 
		<isNotEmpty prepend=" " property="map.wait_audit">
		    and new.CUR_AUDIT_USER_ID in (1
		    <isNotEmpty prepend="," property="map.role1">#map.role1:DECIMAL#</isNotEmpty>
		    <isNotEmpty prepend="," property="map.role2">#map.role2:DECIMAL#</isNotEmpty>
		    <isNotEmpty prepend="," property="map.role3">#map.role3:DECIMAL#</isNotEmpty>
		    <isNotEmpty prepend="," property="map.role4">#map.role4:DECIMAL#</isNotEmpty>
		    )
		    and <![CDATA[new.AUDIT_STAT<>'2']]></isNotEmpty>
		<isNotEmpty prepend=" and " property="is_syn">new.IS_SYN = #is_syn:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="audit_stat">new.AUDIT_STAT = #audit_stat:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_new">new.IS_NEW = #is_new:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="subcomp_id">new.SUBCOMP_ID in (select dept_id from konka_dept start with dept_id=#subcomp_id:DECIMAL# connect by prior dept_id = par_id)</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cust_name_like">new.CUST_NAME like '%' || #map.cust_name_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.ywy_name_like">u.USER_NAME like '%' || #map.ywy_name_like:VARCHAR# || '%'</isNotEmpty>
		<!-- 业务员级别权限 -->
	   	<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">new.ADD_USER_ID=#map.filter_by_ywy_id_eq:DECIMAL#</isNotEmpty>
	   	<!-- 分公司级别权限 -->
	   	<isNotEmpty prepend=" and " property="map.dept_id_start">
		(new.subcomp_id is not null and  new.subcomp_id in (
					select dept_id from konka_dept start with dept_id in (
					SELECT DISTINCT (dept_id)
	  							FROM KONKA_ROLE_DATA_LEVEL
	 							WHERE role_id IN (SELECT role_id
	                     			FROM KONKA_PE_ROLE_USER
	                    			WHERE user_id = #map.session_user_id#)
					) or dept_id = #map.dept_id_start# 
					connect by prior dept_id = par_id 
				)
		)
	 	</isNotEmpty>
	 	<isNotEmpty prepend=" and " property="is_del">new.IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="record_sn">new.RECORD_SN = #record_sn:VARCHAR#</isNotEmpty>
	</select>
	
	<!-- 查询新建客户相关列表 -->
	<select id="selectWaitAuditCustList" resultClass="java.util.HashMap" parameterClass="KonkaR3ShopNew" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select new.*,to_char(new.add_date,'yyyy-mm-dd') as create_date,
			<![CDATA[(SELECT dept_name FROM konka_dept where dept_id<>0 and DEPT_TYPE=3 START WITH dept_id=SUBCOMP_ID CONNECT BY prior par_id=dept_id) DEPT_NAME ]]>,
			u.user_name,dd.dept_name as jb_name,kc.c_name,kc.c_comm,ro.ROLE_NAME,uu.real_name
			from KONKA_R3_SHOP_NEW new 
		  	left join KONKA_DEPT dept on new.SUBCOMP_ID=dept.DEPT_ID
		  	left join konka_pe_prod_user u on new.ywy_user_id=u.id 
		  	left join konka_dept dd on dd.dept_id=new.jb_id
		  	left join Konka_Category kc on kc.c_index=new.customer_type
		  	LEFT JOIN KONKA_PE_ROLE_INFO ro on ro.ROLE_ID=CUR_AUDIT_USER_ID
		  	left join konka_pe_prod_user uu on uu.id= new.add_user_id
		    <isNotEmpty prepend=" " property="map.have_audit">
				right join (select distinct(link_id) from KONKAOA_FILES_AUDIT_NODE where 1=1 
				and NODE_TYPE=3 and AUDIT_LEVEL=1 and AGENT_AUDIT_USER_ID=#map.session_user_id# AND AUDIT_RESULT IS NOT NULL
				<isNotEmpty prepend=" and " property="map.audit_result">
					audit_result = #map.audit_result:DECIMAL#
				</isNotEmpty>
				<isNotEmpty prepend=" and " property="map.session_user_id">
					AGENT_AUDIT_USER_ID = #map.session_user_id#
				</isNotEmpty>
				) audit on new.cust_id=audit.link_id
			</isNotEmpty>
		where 1 = 1 
		   <isNotEmpty prepend=" " property="map.wait_audit">
		        and new.CUR_AUDIT_USER_ID in (1
			    <isNotEmpty prepend="," property="map.role1">#map.role1:DECIMAL#</isNotEmpty>
			    <isNotEmpty prepend="," property="map.role2">#map.role2:DECIMAL#</isNotEmpty>
			    <isNotEmpty prepend="," property="map.role3">#map.role3:DECIMAL#</isNotEmpty>
			    <isNotEmpty prepend="," property="map.role4">#map.role4:DECIMAL#</isNotEmpty>
		       )
		       and <![CDATA[new.AUDIT_STAT<>'2']]>
		   </isNotEmpty>
		   <isNotEmpty prepend=" and " property="is_syn">new.IS_SYN = #is_syn:DECIMAL#</isNotEmpty>
		   <isNotEmpty prepend=" and " property="audit_stat">new.AUDIT_STAT = #audit_stat:DECIMAL#</isNotEmpty>
		   <isNotEmpty prepend=" and " property="is_new">new.IS_NEW = #is_new:DECIMAL#</isNotEmpty>
		   <isNotEmpty prepend=" and " property="subcomp_id">new.SUBCOMP_ID in (select dept_id from konka_dept start with dept_id=#subcomp_id:DECIMAL# connect by prior dept_id = par_id)</isNotEmpty>
		   <isNotEmpty prepend=" and " property="map.cust_name_like">new.CUST_NAME like '%' || #map.cust_name_like:VARCHAR# || '%'</isNotEmpty>
		   <isNotEmpty prepend=" and " property="map.ywy_name_like">u.USER_NAME like '%' || #map.ywy_name_like:VARCHAR# || '%'</isNotEmpty>
		   <!-- 业务员级别权限 -->
		   <isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">new.ADD_USER_ID=#map.filter_by_ywy_id_eq:DECIMAL#</isNotEmpty>
		   <!-- 分公司级别权限 -->
		   <isNotEmpty prepend=" and " property="map.dept_id_start">
			(new.subcomp_id is not null and  new.subcomp_id in (
						select dept_id from konka_dept start with dept_id in (
						SELECT DISTINCT (dept_id)
		  							FROM KONKA_ROLE_DATA_LEVEL
		 							WHERE role_id IN (SELECT role_id
		                     			FROM KONKA_PE_ROLE_USER
		                    			WHERE user_id = #map.session_user_id#)
						) or dept_id = #map.dept_id_start# 
						connect by prior dept_id = par_id 
					)
			)
		 </isNotEmpty>
		 <isNotEmpty prepend=" and " property="is_del">new.IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		 <isNotEmpty prepend=" and " property="record_sn">new.RECORD_SN = #record_sn:VARCHAR#</isNotEmpty>
		order by new.CUST_ID desc
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<!-- 根据cust_id查询新开户信息 -->
	<select id="selectKonkaR3ShopNewByCustId" resultMap="konkaR3ShopNewResult" parameterClass="konkaR3ShopNew" cacheModel="oneDayCache">
		select * from KONKA_R3_SHOP_NEW where 1 = 1
		<isNotEmpty prepend=" and " property="cust_id">CUST_ID = #cust_id:DECIMAL#</isNotEmpty>
	</select>
</sqlMap>