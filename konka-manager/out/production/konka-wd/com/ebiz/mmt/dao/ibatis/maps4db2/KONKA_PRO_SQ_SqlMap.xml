<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KONKA_PRO_SQ">

	<typeAlias alias="konkaProSq" type="com.ebiz.mmt.domain.KonkaProSq" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertKonkaProSq" />
		<flushOnExecute statement="updateKonkaProSq" />
		<flushOnExecute statement="deleteKonkaProSq" />
	</cacheModel>
	
	<resultMap id="konkaProSqResultForList" class="konkaProSq">
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="FILE_NO" property="file_no" jdbcType="VARCHAR" />
		<result column="DEPT_ID" property="dept_id" jdbcType="DECIMAL" />
		<result column="TBR_NAME" property="tbr_name" jdbcType="VARCHAR" />
		<result column="AREA_ID" property="area_id" jdbcType="DECIMAL" />
		<result column="FZR_NAME" property="fzr_name" jdbcType="VARCHAR" />
		<result column="FZR_TEL" property="fzr_tel" jdbcType="VARCHAR" />
		<result column="FGS_NAME" property="fgs_name" jdbcType="VARCHAR" />
		<result column="FGS_TEL" property="fgs_tel" jdbcType="VARCHAR" />
		<result column="PRO_NAME" property="pro_name" jdbcType="VARCHAR" />
		<result column="ZB_DATE" property="zb_date" jdbcType="TIMESTAMP" />
		<result column="REMARK" property="remark" jdbcType="VARCHAR" />
		<result column="ADD_DATE" property="add_date" jdbcType="TIMESTAMP" />
		<result column="FILE_STATE" property="file_state" jdbcType="DECIMAL" />
		<result column="IS_DEL" property="is_del" jdbcType="DECIMAL" />
		<result column="IS_SUPPORT" property="is_support" jdbcType="INTEGER" />
		<result column="SUPPORT_CONTENT" property="support_content" jdbcType="VARCHAR" />
		<result column="BB_STATE" property="bb_state" jdbcType="DECIMAL" />
		<result column="PRO_STATE" property="pro_state" jdbcType="DECIMAL" />
		<result column="SB_REMARK" property="sb_remark" jdbcType="VARCHAR" />
		<result column="ZC_REMARK" property="zc_remark" jdbcType="VARCHAR" />
		<result column="ADD_USER_ID" property="add_user_id" jdbcType="DECIMAL" />
		<result column="ADD_USER_NAME" property="add_user_name" jdbcType="VARCHAR" />
	</resultMap>
	

	<resultMap id="konkaProSqResult" class="konkaProSq" extends="konkaProSqResultForList">
	</resultMap>
	
	<resultMap id="konkaProSqAndDeptNameResult" class="konkaProSq" extends="konkaProSqResultForList">
		<result column="DEPT_NAME" property="map.dept_name" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap id="konkaProSqAndDeptNameAndFighterInfoResult" class="konkaProSq" extends="konkaProSqResultForList">
		<result column="DEPT_NAME" property="map.dept_name" jdbcType="VARCHAR" />
		<result column="BRAND_NAME" property="map.brand_name" jdbcType="VARCHAR" />
		<result column="MD_NAME" property="map.md_name" jdbcType="VARCHAR" />
		<result column="PARAM" property="map.param" jdbcType="VARCHAR" />
		<result column="SAIL_MONEY" property="map.sail_money" jdbcType="VARCHAR" />
		<result column="BD_TB_PRICE" property="map.bd_tb_price" jdbcType="VARCHAR" />
	</resultMap>
	
	
	<sql id="sf-konkaProSq">
		<isNotEmpty prepend=" and " property="id">ID = #id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="file_no">FILE_NO = #file_no:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dept_id">DEPT_ID = #dept_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="tbr_name">TBR_NAME = #tbr_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="area_id">AREA_ID = #area_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fzr_name">FZR_NAME = #fzr_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fzr_tel">FZR_TEL = #fzr_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fgs_name">FGS_NAME = #fgs_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fgs_tel">FGS_TEL = #fgs_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="pro_name">PRO_NAME = #pro_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="zb_date">ZB_DATE = #zb_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="remark">REMARK = #remark:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="file_state">FILE_STATE = #file_state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_support">IS_SUPPORT = #is_support:INTEGER#</isNotEmpty>
		<isNotEmpty prepend=" and " property="support_content">SUPPORT_CONTENT = #support_content:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="bb_state">BB_STATE = #bb_state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="pro_state">PRO_STATE = #pro_state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sb_remark">SB_REMARK = #sb_remark:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="zc_remark">ZC_REMARK = #zc_remark:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">ADD_USER_ID = #add_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_name">ADD_USER_NAME = #add_user_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.file_state_begin"><![CDATA[FILE_STATE > #map.file_state_begin:DECIMAL#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.file_state_end"><![CDATA[ FILE_STATE <= #map.file_state_end:DECIMAL# ]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.file_no_like">FILE_NO like '%' || #map.file_no_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.pro_name_like">PRO_NAME like '%' || #map.pro_name_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.add_time_start"><![CDATA[ ADD_DATE >= to_date(#map.add_time_start#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.add_time_end"><![CDATA[ ADD_DATE <= to_date(#map.add_time_end#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
	</sql>
	
	<sql id="sf-konkaProSq-t">
		<isNotEmpty prepend=" and " property="id">t.ID = #id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="file_no">t.FILE_NO = #file_no:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dept_id">t.DEPT_ID = #dept_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="tbr_name">t.TBR_NAME = #tbr_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="area_id">t.AREA_ID = #area_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fzr_name">t.FZR_NAME = #fzr_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fzr_tel">t.FZR_TEL = #fzr_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fgs_name">t.FGS_NAME = #fgs_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fgs_tel">t.FGS_TEL = #fgs_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="pro_name">t.PRO_NAME = #pro_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="zb_date">t.ZB_DATE = #zb_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="remark">t.REMARK = #remark:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">t.ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="file_state">t.FILE_STATE = #file_state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">t.IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_support">IS_SUPPORT = #is_support:INTEGER#</isNotEmpty>
		<isNotEmpty prepend=" and " property="support_content">SUPPORT_CONTENT = #support_content:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="bb_state">t.BB_STATE = #bb_state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="pro_state">t.PRO_STATE = #pro_state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sb_remark">t.SB_REMARK = #sb_remark:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="zc_remark">t.ZC_REMARK = #zc_remark:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">t.ADD_USER_ID = #add_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_name">t.ADD_USER_NAME = #add_user_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.file_state_begin"><![CDATA[FILE_STATE > #map.file_state_begin:DECIMAL#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.file_state_end"><![CDATA[ FILE_STATE <= #map.file_state_end:DECIMAL# ]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.file_no_like">t.FILE_NO like '%' || #map.file_no_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.pro_name_like">t.PRO_NAME like '%' || #map.pro_name_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.add_time_start"><![CDATA[ t.ADD_DATE >= to_date(#map.add_time_start#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.add_time_end"><![CDATA[ t.ADD_DATE <= to_date(#map.add_time_end#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
	</sql>

	<select id="selectKonkaProSq" resultMap="konkaProSqResult" parameterClass="konkaProSq" cacheModel="oneDayCache">
		select * from KONKA_PRO_SQ where 1 = 1
		<include refid="sf-konkaProSq" />
	</select>

	<select id="selectKonkaProSqList" resultMap="konkaProSqResultForList" parameterClass="konkaProSq" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from KONKA_PRO_SQ where 1 = 1
		<include refid="sf-konkaProSq" />
		<!-- order by ID asc -->
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectKonkaProSqCount" resultClass="long" parameterClass="konkaProSq" cacheModel="oneDayCache">
		select count(*) from (select t.*,a.dept_name as dept_name from KONKA_PRO_SQ t left join KONKA_DEPT a on t.dept_id = a.dept_id where 1 = 1
		<include refid="sf-konkaProSq-t" />
		)
	</select>

	<select id="selectKonkaProSqPaginatedList" resultMap="konkaProSqAndDeptNameResult" parameterClass="konkaProSq" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select t.*,a.dept_name as dept_name from KONKA_PRO_SQ t left join KONKA_DEPT a on t.dept_id = a.dept_id where 1 = 1
		<include refid="sf-konkaProSq-t" />
		order by t.ADD_DATE desc,t.ID desc
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	
	<select id="selectKonkaProSqAndFighterInfoPaginatedList" resultMap="konkaProSqAndDeptNameAndFighterInfoResult" parameterClass="konkaProSq" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		 SELECT t.*,
       a.dept_name as dept_name,
       b.BRAND_NAME as brand_name,
       b.MD_NAME as md_name,
       b.PARAM as param,
       b.SAIL_MONEY as sail_money,
       b.BD_TB_PRICE as bd_tb_price
  FROM konka_pro_sq t
       LEFT JOIN konka_dept a
          ON t.DEPT_ID = a.DEPT_ID
       LEFT JOIN fighter_info b
          ON t.ID = b.PRO_ID where 1 = 1
		<include refid="sf-konkaProSq-t" />
		order by t.ADD_DATE desc,t.ID desc
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<select id="selectKonkaProSqNoMax" resultClass="long" parameterClass="konkaProSq" >
		select max(substr(file_no,7)) from KONKA_PRO_SQ where 1=1 
		<include refid="sf-konkaProSq" />
		<isNotEmpty prepend=" and " property="map.file_no_lm">
			substr(file_no,0,6)=#map.file_no_lm#
		</isNotEmpty>
	</select>

	<insert id="insertKonkaProSq" parameterClass="konkaProSq">
		<selectKey resultClass="long" keyProperty="id">select KONKAOA_FILES_SEQ.nextval as id from dual </selectKey>
		<![CDATA[insert into KONKA_PRO_SQ (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">ID</isNotNull>	
			<isNotNull prepend="," property="file_no">FILE_NO</isNotNull>	
			<isNotNull prepend="," property="dept_id">DEPT_ID</isNotNull>	
			<isNotNull prepend="," property="tbr_name">TBR_NAME</isNotNull>	
			<isNotNull prepend="," property="area_id">AREA_ID</isNotNull>	
			<isNotNull prepend="," property="fzr_name">FZR_NAME</isNotNull>	
			<isNotNull prepend="," property="fzr_tel">FZR_TEL</isNotNull>	
			<isNotNull prepend="," property="fgs_name">FGS_NAME</isNotNull>	
			<isNotNull prepend="," property="fgs_tel">FGS_TEL</isNotNull>	
			<isNotNull prepend="," property="pro_name">PRO_NAME</isNotNull>	
			<isNotNull prepend="," property="zb_date">ZB_DATE</isNotNull>	
			<isNotNull prepend="," property="remark">REMARK</isNotNull>	
			<isNotNull prepend="," property="add_date">ADD_DATE</isNotNull>	
			<isNotNull prepend="," property="file_state">FILE_STATE</isNotNull>	
			<isNotNull prepend="," property="is_del">IS_DEL</isNotNull>	
			<isNotNull prepend="," property="is_support">IS_SUPPORT</isNotNull>	
			<isNotNull prepend="," property="support_content">SUPPORT_CONTENT</isNotNull>	
			<isNotNull prepend="," property="bb_state">BB_STATE</isNotNull>	
			<isNotNull prepend="," property="pro_state">PRO_STATE</isNotNull>	
			<isNotNull prepend="," property="sb_remark">SB_REMARK</isNotNull>	
			<isNotNull prepend="," property="zc_remark">ZC_REMARK</isNotNull>	
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID</isNotNull>	
			<isNotNull prepend="," property="add_user_name">ADD_USER_NAME</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">#id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="file_no">#file_no:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="dept_id">#dept_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="tbr_name">#tbr_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="area_id">#area_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="fzr_name">#fzr_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fzr_tel">#fzr_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fgs_name">#fgs_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fgs_tel">#fgs_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="pro_name">#pro_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="zb_date">#zb_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="remark">#remark:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_date">#add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="file_state">#file_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_del">#is_del:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_support">#is_support:INTEGER#</isNotNull>
			<isNotNull prepend="," property="support_content">#support_content:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="bb_state">#bb_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="pro_state">#pro_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sb_remark">#sb_remark:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="zc_remark">#zc_remark:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_user_id">#add_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_user_name">#add_user_name:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateKonkaProSq" parameterClass="KonkaProSq">
		update KONKA_PRO_SQ
		<dynamic prepend="set">
			<isNotNull prepend="," property="id">ID = #id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="file_no">FILE_NO = #file_no:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="dept_id">DEPT_ID = #dept_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="tbr_name">TBR_NAME = #tbr_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="area_id">AREA_ID = #area_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="fzr_name">FZR_NAME = #fzr_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fzr_tel">FZR_TEL = #fzr_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fgs_name">FGS_NAME = #fgs_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fgs_tel">FGS_TEL = #fgs_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="pro_name">PRO_NAME = #pro_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="zb_date">ZB_DATE = #zb_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="remark">REMARK = #remark:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="file_state">FILE_STATE = #file_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_del">IS_DEL = #is_del:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_support">IS_SUPPORT= #is_support:INTEGER#</isNotNull>
			<isNotNull prepend="," property="support_content">SUPPORT_CONTENT = #support_content:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="bb_state">BB_STATE = #bb_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="pro_state">PRO_STATE = #pro_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sb_remark">SB_REMARK = #sb_remark:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="zc_remark">ZC_REMARK = #zc_remark:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID = #add_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_user_name">ADD_USER_NAME = #add_user_name:VARCHAR#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteKonkaProSq" parameterClass="KonkaProSq">
		delete from KONKA_PRO_SQ where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

</sqlMap>