<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="EC_BASE_CARD_NO">

	<typeAlias alias="ecBaseCardNo" type="com.ebiz.mmt.domain.EcBaseCardNo" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertEcBaseCardNo" />
		<flushOnExecute statement="updateEcBaseCardNo" />
		<flushOnExecute statement="deleteEcBaseCardNo" />
	</cacheModel>

	<resultMap id="ecBaseCardNoResultForList" class="ecBaseCardNo">
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="CARD_NO" property="card_no" jdbcType="VARCHAR" />
		<result column="CARD_PUB_DATE" property="card_pub_date" jdbcType="TIMESTAMP" />
		<result column="CARD_SENDER" property="card_sender" jdbcType="VARCHAR" />
		<result column="CARD_SENDER_DEPT" property="card_sender_dept" jdbcType="VARCHAR" />
		<result column="CARD_TYPE" property="card_type" jdbcType="DECIMAL" />
		<result column="CARD_LEVEL" property="card_level" jdbcType="DECIMAL" />
		<result column="MEMBER_NAME" property="member_name" jdbcType="VARCHAR" />
		<result column="MEMBER_TEL" property="member_tel" jdbcType="VARCHAR" />
		<result column="MEMBER_ID" property="member_id" jdbcType="VARCHAR" />
		<result column="CARD_ACT_VALID_DATE" property="card_act_valid_date" jdbcType="TIMESTAMP" />
		<result column="CARD_ACT_DATE" property="card_act_date" jdbcType="TIMESTAMP" />
		<result column="CARD_CREATER" property="card_creater" jdbcType="VARCHAR" />
		<result column="CARD_CREATE_DEPT" property="card_create_dept" jdbcType="VARCHAR" />
		<result column="CARD_LIMIT_START" property="card_limit_start" jdbcType="TIMESTAMP" />
		<result column="CARD_LIMIT_END" property="card_limit_end" jdbcType="TIMESTAMP" />
		<result column="CARD_MEMO" property="card_memo" jdbcType="VARCHAR" />
		<result column="CARD_ALLOW_MUL_ACT" property="card_allow_mul_act" jdbcType="DECIMAL" />
		<result column="CARD_LEVEL" property="ecBaseCardLevel" select="selectEcBaseCardLevelByCardLevel" />
		<result column="CARD_TYPE" property="ecBaseCardType" select="selectEcBaseCardTypeByCardType" />
	</resultMap>

	<resultMap id="ecBaseCardNoResult" class="ecBaseCardNo" extends="ecBaseCardNoResultForList">
	</resultMap>

	<sql id="sf-ecBaseCardNo">
		<isNotEmpty prepend=" and " property="id">ID = #id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_no">UPPER(CARD_NO) = UPPER(#card_no:VARCHAR#)</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_pub_date">CARD_PUB_DATE = #card_pub_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_sender">CARD_SENDER = #card_sender:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_sender_dept">CARD_SENDER_DEPT = #card_sender_dept:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_type">CARD_TYPE = #card_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_level">CARD_LEVEL = #card_level:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="member_name">MEMBER_NAME = #member_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="member_tel">MEMBER_TEL = #member_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="member_id">MEMBER_ID = #member_id:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_act_valid_date">CARD_ACT_VALID_DATE = #card_act_valid_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_act_date">CARD_ACT_DATE = #card_act_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_creater">CARD_CREATER = #card_creater:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_create_dept">CARD_CREATE_DEPT = #card_create_dept:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_limit_start">CARD_LIMIT_START = #card_limit_start:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_limit_end">CARD_LIMIT_END = #card_limit_end:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_memo">CARD_MEMO = #card_memo:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="card_allow_mul_act">CARD_ALLOW_MUL_ACT = #card_allow_mul_act:DECIMAL#</isNotEmpty>
		
		
		<isNotEmpty prepend=" and " property="map.card_no_like">UPPER(CARD_NO) like '%'||UPPER(#map.card_no_like:VARCHAR#)||'%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.member_name_like">MEMBER_NAME like '%'||#map.member_name_like:VARCHAR#||'%'</isNotEmpty>
	</sql>

	<select id="selectEcBaseCardNo" resultMap="ecBaseCardNoResult" parameterClass="ecBaseCardNo" cacheModel="oneDayCache">
		select * from EC_BASE_CARD_NO where 1 = 1
		<include refid="sf-ecBaseCardNo" />
	</select>

	<select id="selectEcBaseCardNoList" resultMap="ecBaseCardNoResultForList" parameterClass="ecBaseCardNo" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from EC_BASE_CARD_NO where 1 = 1
		<include refid="sf-ecBaseCardNo" />
		<!-- order by ID asc -->
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectEcBaseCardNoCount" resultClass="long" parameterClass="ecBaseCardNo" cacheModel="oneDayCache">
		select count(*) from EC_BASE_CARD_NO where 1 = 1
		<include refid="sf-ecBaseCardNo" />
	</select>

	<select id="selectEcBaseCardNoPaginatedList" resultMap="ecBaseCardNoResult" parameterClass="ecBaseCardNo" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from EC_BASE_CARD_NO where 1 = 1
		<include refid="sf-ecBaseCardNo" />
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<insert id="insertEcBaseCardNo" parameterClass="ecBaseCardNo">
		<selectKey resultClass="long" keyProperty="id">select PSHOW_BASE_SEQ.nextval as id from dual </selectKey>
		<![CDATA[insert into EC_BASE_CARD_NO (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">ID</isNotNull>	
			<isNotNull prepend="," property="card_no">CARD_NO</isNotNull>	
			<isNotNull prepend="," property="card_pub_date">CARD_PUB_DATE</isNotNull>	
			<isNotNull prepend="," property="card_sender">CARD_SENDER</isNotNull>	
			<isNotNull prepend="," property="card_sender_dept">CARD_SENDER_DEPT</isNotNull>	
			<isNotNull prepend="," property="card_type">CARD_TYPE</isNotNull>	
			<isNotNull prepend="," property="card_level">CARD_LEVEL</isNotNull>	
			<isNotNull prepend="," property="member_name">MEMBER_NAME</isNotNull>	
			<isNotNull prepend="," property="member_tel">MEMBER_TEL</isNotNull>	
			<isNotNull prepend="," property="member_id">MEMBER_ID</isNotNull>	
			<isNotNull prepend="," property="card_act_valid_date">CARD_ACT_VALID_DATE</isNotNull>	
			<isNotNull prepend="," property="card_act_date">CARD_ACT_DATE</isNotNull>	
			<isNotNull prepend="," property="card_creater">CARD_CREATER</isNotNull>	
			<isNotNull prepend="," property="card_create_dept">CARD_CREATE_DEPT</isNotNull>	
			<isNotNull prepend="," property="card_limit_start">CARD_LIMIT_START</isNotNull>	
			<isNotNull prepend="," property="card_limit_end">CARD_LIMIT_END</isNotNull>	
			<isNotNull prepend="," property="card_memo">CARD_MEMO</isNotNull>	
			<isNotNull prepend="," property="card_allow_mul_act">CARD_ALLOW_MUL_ACT</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">#id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="card_no">#card_no:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_pub_date">#card_pub_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="card_sender">#card_sender:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_sender_dept">#card_sender_dept:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_type">#card_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="card_level">#card_level:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="member_name">#member_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="member_tel">#member_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="member_id">#member_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_act_valid_date">#card_act_valid_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="card_act_date">#card_act_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="card_creater">#card_creater:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_create_dept">#card_create_dept:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_limit_start">#card_limit_start:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="card_limit_end">#card_limit_end:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="card_memo">#card_memo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_allow_mul_act">#card_allow_mul_act:DECIMAL#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateEcBaseCardNo" parameterClass="EcBaseCardNo">
		update EC_BASE_CARD_NO
		<dynamic prepend="set">
			<isNotNull prepend="," property="id">ID = #id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="card_no">CARD_NO = #card_no:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_pub_date">CARD_PUB_DATE = #card_pub_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="card_sender">CARD_SENDER = #card_sender:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_sender_dept">CARD_SENDER_DEPT = #card_sender_dept:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_type">CARD_TYPE = #card_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="card_level">CARD_LEVEL = #card_level:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="member_name">MEMBER_NAME = #member_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="member_tel">MEMBER_TEL = #member_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="member_id">MEMBER_ID = #member_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_act_valid_date">CARD_ACT_VALID_DATE = #card_act_valid_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="card_act_date">CARD_ACT_DATE = #card_act_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="card_creater">CARD_CREATER = #card_creater:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_create_dept">CARD_CREATE_DEPT = #card_create_dept:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_limit_start">CARD_LIMIT_START = #card_limit_start:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="card_limit_end">CARD_LIMIT_END = #card_limit_end:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="card_memo">CARD_MEMO = #card_memo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="card_allow_mul_act">CARD_ALLOW_MUL_ACT = #card_allow_mul_act:DECIMAL#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>
	
	<update id="updateEcBaseCardNoBYCardNo" parameterClass="EcBaseCardNo">
		update EC_BASE_CARD_NO set CARD_LEVEL = #card_level:DECIMAL# where CARD_NO = #card_no:VARCHAR# 
	</update>
	
	<delete id="deleteEcBaseCardNo" parameterClass="EcBaseCardNo">
		delete from EC_BASE_CARD_NO where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

</sqlMap>