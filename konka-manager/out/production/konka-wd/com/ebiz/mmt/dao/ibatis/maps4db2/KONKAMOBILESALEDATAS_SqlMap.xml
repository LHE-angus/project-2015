<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KONKAMOBILESALEDATAS">

	<typeAlias alias="konkamobilesaledatas" type="com.ebiz.mmt.domain.Konkamobilesaledatas" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertKonkamobilesaledatas" />
		<flushOnExecute statement="updateKonkamobilesaledatas" />
		<flushOnExecute statement="deleteKonkamobilesaledatas" />
	</cacheModel>

	<resultMap id="konkamobilesaledatasResultForList" class="konkamobilesaledatas">
		<result column="PCT_CODE" property="pct_code" jdbcType="VARCHAR" />
		<result column="STORE_ID" property="store_id" jdbcType="DECIMAL" />
		<result column="STORE_NAME" property="store_name" jdbcType="VARCHAR" />
		<result column="CXUSER" property="cxuser" jdbcType="DECIMAL" />
		<result column="CXNAME" property="cxname" jdbcType="VARCHAR" />
		<result column="MODEL_ID" property="model_id" jdbcType="DECIMAL" />
		<result column="MD_NAME" property="md_name" jdbcType="VARCHAR" />
		<result column="CLS_ID" property="cls_id" jdbcType="DECIMAL" />
		<result column="CLS_NAME" property="cls_name" jdbcType="VARCHAR" />
		<result column="CC_ID" property="cc_id" jdbcType="DECIMAL" />
		<result column="SALE_DATE" property="sale_date" jdbcType="DATETIME" />
		<result column="ALL_PRICE" property="all_price" jdbcType="DECIMAL" />
		<result column="NUM" property="num" jdbcType="DECIMAL" />
		<result column="DEPT_ID" property="dept_id" jdbcType="DECIMAL" />
		<result column="DEPT_NAME" property="dept_name" jdbcType="VARCHAR" />
		<result column="L4_DEPT_ID" property="l4_dept_id" jdbcType="DECIMAL" />
		<result column="L4_DEPT_NAME" property="l4_dept_name" jdbcType="VARCHAR" />
		<result column="L5_DEPT_ID" property="l5_dept_id" jdbcType="DECIMAL" />
		<result column="L5_DEPT_NAME" property="l5_dept_name" jdbcType="VARCHAR" />
		<result column="R3_CODE" property="handle_name" jdbcType="VARCHAR" />
		<result column="R3_DESC" property="handle_name" jdbcType="VARCHAR" />
		<result column="HANDLE_NAME" property="handle_name" jdbcType="VARCHAR" />
		<result column="CUSTOMER_NAME" property="customer_name" jdbcType="VARCHAR" />
		<result column="REPORT_NAME" property="report_name" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="konkamobilesaledatasResult" class="konkamobilesaledatas" extends="konkamobilesaledatasResultForList">
	</resultMap>

	<sql id="sf-konkamobilesaledatas">
		<isNotEmpty prepend=" and " property="pct_code">PCT_CODE = #pct_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="store_id">STORE_ID = #store_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="store_name">STORE_NAME = #store_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="cxuser">CXUSER = #cxuser:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="cxname">CXNAME = #cxname:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="model_id">MODEL_ID = #model_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="md_name">MD_NAME = #md_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="cls_id">CLS_ID = #cls_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="cls_name">CLS_NAME = #cls_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="cc_id">CC_ID = #cc_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sale_date">SALE_DATE = #sale_date:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="all_price">ALL_PRICE = #all_price:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="num">NUM = #num:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dept_id">DEPT_ID = #dept_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="l4_dept_id">L4_DEPT_ID = #l4_dept_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="l5_dept_id">L5_DEPT_ID = #l5_dept_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="r3_code">R3_CODE = #r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="r3_desc">R3_DESC = #r3_desc:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="customer_name">CUSTOMER_NAME = #customer_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="report_name">REPORT_NAME = #report_name:VARCHAR#</isNotEmpty>	
		<isNotEmpty prepend=" and " property="handle_name">HANDLE_NAME = #handle_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.measure_id">CC_ID = #map.measure_id:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_name_like">upper(customer_name) like '%' || upper(#map.customer_name_like:VARCHAR#) || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.report_name_like">upper(report_name) like '%' || upper(#map.report_name_like:VARCHAR#) || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_name_like">upper(store_name) like '%' || upper(#map.dept_name_like:VARCHAR#) || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.date_begin"><![CDATA[ SALE_DATE >= to_date(#map.date_begin:VARCHAR# || '00:00:00','yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[ SALE_DATE <= to_date(#map.date_end:VARCHAR# || '23:59:59','yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
	
	</sql>

	<select id="selectKonkamobilesaledatas" resultMap="konkamobilesaledatasResult" parameterClass="konkamobilesaledatas" cacheModel="oneDayCache">
		select * from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
	</select>

	<select id="selectKonkamobilesaledatasList" resultMap="konkamobilesaledatasResultForList" parameterClass="konkamobilesaledatas" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
		<!-- order by ID asc -->
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectKonkamobilesaledatasCount" resultClass="long" parameterClass="konkamobilesaledatas" cacheModel="oneDayCache">
		select count(*) from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
	</select>

	<select id="selectKonkamobilesaledatasPaginatedList" resultMap="konkamobilesaledatasResult" parameterClass="konkamobilesaledatas" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<insert id="insertKonkamobilesaledatas" parameterClass="konkamobilesaledatas">
		<selectKey resultClass="long" keyProperty="id">select seq_xxx.nextval as id from dual </selectKey>
		<![CDATA[insert into KONKAMOBILESALEDATAS (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="pct_code">PCT_CODE</isNotNull>	
			<isNotNull prepend="," property="store_id">STORE_ID</isNotNull>	
			<isNotNull prepend="," property="store_name">STORE_NAME</isNotNull>	
			<isNotNull prepend="," property="cxuser">CXUSER</isNotNull>	
			<isNotNull prepend="," property="cxname">CXNAME</isNotNull>	
			<isNotNull prepend="," property="model_id">MODEL_ID</isNotNull>	
			<isNotNull prepend="," property="md_name">MD_NAME</isNotNull>	
			<isNotNull prepend="," property="cls_id">CLS_ID</isNotNull>	
			<isNotNull prepend="," property="cls_name">CLS_NAME</isNotNull>	
			<isNotNull prepend="," property="cc_id">CC_ID</isNotNull>	
			<isNotNull prepend="," property="sale_date">SALE_DATE</isNotNull>	
			<isNotNull prepend="," property="all_price">ALL_PRICE</isNotNull>	
			<isNotNull prepend="," property="num">NUM</isNotNull>	
			<isNotNull prepend="," property="dept_id">DEPT_ID</isNotNull>	
			<isNotNull prepend="," property="dept_name">DEPT_NAME</isNotNull>	
			<isNotNull prepend="," property="handle_name">HANDLE_NAME</isNotNull>
			<isNotNull prepend="," property="report_name">REPORT_NAME</isNotNull>
			<isNotNull prepend="," property="customer_name">CUSTOMER_NAME</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="pct_code">#pct_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="store_id">#store_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="store_name">#store_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="cxuser">#cxuser:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="cxname">#cxname:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="model_id">#model_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="md_name">#md_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="cls_id">#cls_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="cls_name">#cls_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="cc_id">#cc_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sale_date">#sale_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="all_price">#all_price:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="num">#num:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="dept_id">#dept_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="dept_name">#dept_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="handle_name">#handle_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="report_name">#report_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="customer_name">#customer_name:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateKonkamobilesaledatas" parameterClass="Konkamobilesaledatas">
		update KONKAMOBILESALEDATAS
		<dynamic prepend="set">
			<isNotNull prepend="," property="pct_code">PCT_CODE = #pct_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="store_id">STORE_ID = #store_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="store_name">STORE_NAME = #store_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="cxuser">CXUSER = #cxuser:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="cxname">CXNAME = #cxname:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="model_id">MODEL_ID = #model_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="md_name">MD_NAME = #md_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="cls_id">CLS_ID = #cls_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="cls_name">CLS_NAME = #cls_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="cc_id">CC_ID = #cc_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sale_date">SALE_DATE = #sale_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="all_price">ALL_PRICE = #all_price:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="num">NUM = #num:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="dept_id">DEPT_ID = #dept_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="handle_name">HANDLE_NAME = #handle_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="customer_name">CUSTOMER_NAME = #customer_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="report_name">REPORT_NAME = #report_name:VARCHAR#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteKonkamobilesaledatas" parameterClass="Konkamobilesaledatas">
		delete from KONKAMOBILESALEDATAS where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

	<!-- 按月份聚类 -->
	<select id="selectKonkamobilesaledatasCountMonth" resultClass="long" parameterClass="konkamobilesaledatas" remapResults="true">
		select count(*)
		  from (select count(*)
		          from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
		         group by to_char(sale_date, 'yyyy-mm')
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
				         )
	</select>
	
	<select id="selectKonkamobilesaledatasPaginatedListMonth" resultClass="java.util.HashMap" parameterClass="konkamobilesaledatas" remapResults="true">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select to_char(sale_date, 'yyyy-mm') as sale_date,
		       sum(num) as num,
		       sum(all_price) as all_price
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
		  from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
		 group by to_char(sale_date, 'yyyy-mm')
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
		order by sale_date desc
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<!-- 按天聚类 -->
	<select id="selectKonkamobilesaledatasCountDay" resultClass="long" parameterClass="konkamobilesaledatas" remapResults="true">
		select count(*)
		  from (select count(*)
		          from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
		         group by to_char(sale_date, 'yyyy-mm-dd')
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
				         )
	</select>
	
	<select id="selectKonkamobilesaledatasPaginatedListDay" resultClass="java.util.HashMap" parameterClass="konkamobilesaledatas" remapResults="true">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select to_char(sale_date, 'yyyy-mm-dd') as sale_date,
		       sum(num) as num,
		       sum(all_price) as all_price
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
		  from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
		 group by to_char(sale_date, 'yyyy-mm-dd')
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
		  order by sale_date desc
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<!-- 按季聚类 -->
	<select id="selectKonkamobilesaledatasCountSeason" resultClass="long" parameterClass="konkamobilesaledatas" remapResults="true">
		select count(*)
		  from (select count(*)
		          from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
		         group by to_char(sale_date, 'yyyy-Q')
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
		         )
	</select>
	
	<select id="selectKonkamobilesaledatasPaginatedListSeason" resultClass="java.util.HashMap" parameterClass="konkamobilesaledatas" remapResults="true">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select to_char(sale_date, 'yyyy-Q') as sale_date,
		       sum(num) as num,
		       sum(all_price) as all_price
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
		  from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
		 group by to_char(sale_date, 'yyyy-Q')
		  
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
		 order by sale_date desc
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<!-- 按年聚类 -->
	<select id="selectKonkamobilesaledatasCountYear" resultClass="long" parameterClass="konkamobilesaledatas" remapResults="true">
		select count(*)
		  from (select count(*)
		          from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
		         group by to_char(sale_date, 'yyyy')
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
				         )
	</select>
	
	<select id="selectKonkamobilesaledatasPaginatedListYear" resultClass="java.util.HashMap" parameterClass="konkamobilesaledatas" remapResults="true">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select to_char(sale_date, 'yyyy') as sale_date,
		       sum(num) as num,
		       sum(all_price) as all_price
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
		  from KONKAMOBILESALEDATAS where 1 = 1
		<include refid="sf-konkamobilesaledatas" />
		 group by to_char(sale_date, 'yyyy')
		
		<isNotNull prepend="," property="map.selected01">dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected06">l4_dept_name</isNotNull>
		<isNotNull prepend="," property="map.selected07">l5_dept_name</isNotNull>
<!--		<isNotNull prepend="," property="map.selected02">handle_name</isNotNull>-->
		<isNotNull prepend="," property="map.selected03">cls_name</isNotNull>
		<isNotNull prepend="," property="map.selected04">cc_id</isNotNull>
		<isNotNull prepend="," property="map.selected05">md_name</isNotNull>
		   order by sale_date desc
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<!-- 手机端用 按型号/尺寸/月份聚类 型号、销售量、销售金额、分公司、经办、业务员、R3网点、门店名称 -->
	<select id="selectKonkamobilesaledatasMobile" resultClass="java.util.HashMap" parameterClass="konkamobilesaledatas" remapResults="true">
	select <isNotNull property="map.selected01">t.md_name,</isNotNull>
	       <isNotNull property="map.selected02">t.cc_id,</isNotNull>
	       <isNotNull property="map.selected03">to_char(t.sale_date, 'yyyy-mm') as saledate,</isNotNull>
	       sum(t.num) as salenum,
	       sum(t.all_price) as salecash,
	       t.dept_name,
	       t.handle_name,
	       t.cxname,
	       t.r3_desc,
	       t.store_name
	  from KONKAMOBILESALEDATAS t where 1 = 1
	 <include refid="sf-konkamobilesaledatas" />
	 group by <isNotNull property="map.selected01">t.md_name,</isNotNull>
	          <isNotNull property="map.selected02">t.cc_id,</isNotNull>
	          <isNotNull property="map.selected03">to_char(t.sale_date, 'yyyy-mm'),</isNotNull>
	          t.dept_name,
	          t.handle_name,
	          t.cxname,
	          t.r3_desc,
	          t.store_name
	</select>
	
	<select id="selectKonkamobilesaledatasMobileFlot3" resultClass="java.util.HashMap" parameterClass="konkamobilesaledatas" remapResults="true">
	select a.dater as saledate, b.salenum, b.salecash
	  from ($map.dateSql$) a
	  left join (select to_char(t.sale_date, 'yyyy-mm') as saledate,
	                    sum(t.num) as salenum,
	                    sum(t.all_price) as salecash
	               from KONKAMOBILESALEDATAS t
	              where 1 = 1
				<include refid="sf-konkamobilesaledatas" />
	              group by to_char(t.sale_date, 'yyyy-mm')) b
	    on b.saledate = a.dater
	    order by dater
	</select>
	
	<!-- 手机端用 按型号/尺寸/月份聚类 型号、销售量、销售金额、分公司、经办、业务员、R3网点、门店名称 -->
	<select id="selectKonkamobilesaledatasMobileFlot" resultClass="java.util.HashMap" parameterClass="konkamobilesaledatas" remapResults="true">
	 select * from (
		select <isNotNull property="map.selected01">t.md_name,</isNotNull>
		       <isNotNull property="map.selected02">t.cc_id,</isNotNull>
		       <isNotNull property="map.selected03">to_char(t.sale_date, 'yyyy-mm') as saledate,</isNotNull>
		       sum(t.num) as salenum,
		       sum(t.all_price) as salecash
		  from KONKAMOBILESALEDATAS t where 1 = 1
		 <include refid="sf-konkamobilesaledatas" />
		 group by <isNotNull property="map.selected01">t.md_name</isNotNull>
		          <isNotNull property="map.selected02">t.cc_id</isNotNull>
		          <isNotNull property="map.selected03">to_char(t.sale_date, 'yyyy-mm')</isNotNull>
	 )
	 <isNotEmpty property="map.order_by_salecash_desc"> order by salecash</isNotEmpty>
	</select>
</sqlMap>