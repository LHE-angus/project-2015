<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >

<sqlMap namespace="CHANNEL_DATA_IMPORT">
	<typeAlias alias="channelDataImport" type="com.ebiz.mmt.domain.ChannelDataImport" />

	<resultMap id="channelDataImportResultForList" class="channelDataImport">
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="IMPORT_DATE" property="import_date" jdbcType="DATETIME" />
		<result column="IMPORT_UID" property="import_uid" jdbcType="DECIMAL" />
		<result column="COLUMN_1" property="column_1" jdbcType="VARCHAR" />
		<result column="COLUMN_2" property="column_2" jdbcType="VARCHAR" />
		<result column="COLUMN_3" property="column_3" jdbcType="VARCHAR" />
		<result column="COLUMN_4" property="column_4" jdbcType="VARCHAR" />
		<result column="COLUMN_5" property="column_5" jdbcType="VARCHAR" />
		<result column="COLUMN_6" property="column_6" jdbcType="VARCHAR" />
		<result column="COLUMN_7" property="column_7" jdbcType="DATETIME" />
		<result column="COLUMN_8" property="column_8" jdbcType="VARCHAR" />
		<result column="COLUMN_9" property="column_9" jdbcType="VARCHAR" />
		<result column="COLUMN_10" property="column_10" jdbcType="VARCHAR" />
		<result column="COLUMN_11" property="column_11" jdbcType="VARCHAR" />
		<result column="COLUMN_12" property="column_12" jdbcType="VARCHAR" />
		<result column="COLUMN_13" property="column_13" jdbcType="DECIMAL" />
		<result column="COLUMN_14" property="column_14" jdbcType="DECIMAL" />
		<result column="COLUMN_15" property="column_15" jdbcType="DECIMAL" />
		<result column="COLUMN_16" property="column_16" jdbcType="DECIMAL" />
		<result column="COLUMN_17" property="column_17" jdbcType="DECIMAL" />
		<result column="COLUMN_18" property="column_18" jdbcType="DATETIME" />
		<result column="COLUMN_19" property="column_19" jdbcType="VARCHAR" />
		<result column="COLUMN_20" property="column_20" jdbcType="VARCHAR" />
		<result column="COLUMN_21" property="column_21" jdbcType="VARCHAR" />
		<result column="COLUMN_22" property="column_22" jdbcType="VARCHAR" />
		<result column="COLUMN_23" property="column_23" jdbcType="VARCHAR" />
		<result column="COLUMN_24" property="column_24" jdbcType="VARCHAR" />
		<result column="COLUMN_25" property="column_25" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="channelDataImportResult" class="channelDataImport" extends="channelDataImportResultForList">

	</resultMap>

	<resultMap id="channelDataImportToStat" class="channelDataImport">
		<result column="COLUMN_1" property="column_1" jdbcType="VARCHAR" />
		<result column="COLUMN_11" property="column_11" jdbcType="VARCHAR" />
		<result column="NUM" property="map.num" jdbcType="DECIMAL" />
		<result column="PRICE" property="map.price" jdbcType="DECIMAL" />
		<result column="TOTAL" property="map.total" jdbcType="DECIMAL" />
	</resultMap>

	<resultMap id="channelDataImportResultToSum" class="channelDataImport" extends="channelDataImportResultForList">
		<result column="PD_ID" property="map.pd_id" jdbcType="DECIMAL" />
	</resultMap>

	<resultMap id="channelDataImportToModel" class="channelDataImport">
		<result column="MODEL" property="map.model" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap id="channelDataImportForMaxDate" class="channelDataImport">
		<result column="IMPORT_DATE" property="import_date" jdbcType="DATETIME" />
	</resultMap>

	<sql id="sf-channelDataImportStat">
		<isNotEmpty prepend="," property="map.date1">
			column_7 having
			<isNotEmpty prepend=" and " property="map.date_start"><![CDATA[to_char(COLUMN_7,'mmDD') >=to_char (to_date(#map.date_start#,'yyyy-MM-dd hh24:mi:ss'),'mmDD')]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'mmDD') <= to_char (to_date(#map.date_end#,'yyyy-MM-dd hh24:mi:ss','mmDD')]]></isNotEmpty>
		</isNotEmpty>
		<isNotEmpty prepend="," property="map.date2">
			column_7 having
			<isNotEmpty prepend=" and " property="map.date_start"><![CDATA[to_char(COLUMN_7,'yyyymm') >=to_char (to_date(#map.date_start#,'yyyy-MM-dd hh24:mi:ss'),'yyyymm')]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymm') <= to_char (to_date(#map.date_end#,'yyyy-MM-dd hh24:mi:ss','yyyymm')]]></isNotEmpty>
		</isNotEmpty>
	</sql>

	<sql id="sf-channelDataImport">
		<isNotEmpty prepend=" and " property="id">ID = #id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="import_date">IMPORT_DATE = #import_date:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="import_uid">IMPORT_UID = #import_uid:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_1">COLUMN_1 = #column_1:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.r3_code">COLUMN_1 = #map.r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_2">COLUMN_2 = #column_2:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_3">COLUMN_3 = #column_3:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_4">COLUMN_4 = #column_4:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.column_4">COLUMN_4 like '%' || #column_4:VARCHAR#|| '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.is_fgs">COLUMN_1 in (select r3_code from KONKA_R3_SHOP where branch_area_name = #map.fgs# )</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_5">COLUMN_5 = #column_5:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_6">COLUMN_6 = #column_6:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_7">COLUMN_7 = #column_7:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_8">COLUMN_8 = #column_8:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_9">COLUMN_9 = #column_9:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_10">COLUMN_10 = #column_10:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_11">COLUMN_11 = #column_11:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.column_11">COLUMN_11 = #map.column_11:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_12">COLUMN_12 = #column_12:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_13">COLUMN_13 = #column_13:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.column_13">COLUMN_13 is null</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_14">COLUMN_14 = #column_14:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_15">COLUMN_15 = #column_15:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_16">COLUMN_16 = #column_16:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_17">COLUMN_17 = #column_17:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_18">COLUMN_18 = #column_18:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_19">COLUMN_19 = #column_19:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_20">COLUMN_20 = #column_20:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_21">COLUMN_21 = #column_21:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_22">COLUMN_22 = #column_22:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_23">COLUMN_23 = #column_23:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_24">COLUMN_24 = #column_24:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_25">COLUMN_25 = #column_25:VARCHAR#</isNotEmpty>


		<isNotEmpty prepend=" and " property="map.startDate"><![CDATA[COLUMN_7 >= to_date(#map.startDate#,'yyyy-MM-dd hh24:mi:ss')]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.endDate"><![CDATA[COLUMN_7 <= to_date(#map.endDate#,'yyyy-MM-dd hh24:mi:ss')]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.endDate_lt"><![CDATA[COLUMN_7 < to_date(#map.endDate_lt#,'yyyy-MM-dd hh24:mi:ss')]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.s_date"><![CDATA[COLUMN_7 >= to_date(#map.s_date#,'yyyy-MM-dd hh24:mi:ss')]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.e_date"><![CDATA[COLUMN_7 <= to_date(#map.e_date#,'yyyy-MM-dd hh24:mi:ss')]]></isNotEmpty>


		<isNotEmpty prepend=" and " property="map.keyword">COLUMN_1 like '%' || #map.keyword# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.import_date">to_char(IMPORT_DATE) =#map.import_date#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_name_like">COLUMN_4 like '%'|| #map.customer_name_like# ||'%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.column_8_like">COLUMN_8 like '%'|| #map.column_8_like# ||'%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.md_name_like">COLUMN_11 like '%' || #map.md_name_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.handle_name">COLUMN_1 in (select r3_code from konka_r3_shop r where r.handle_name like '%' || #map.handle_name# || '%')</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.branch_area_name">COLUMN_1 in (select r3_code from konka_r3_shop r where r.branch_area_name like '%' || #map.branch_area_name# || '%')</isNotEmpty>

		<isNotEmpty prepend=" and " property="map.konka_dept_id">COLUMN_1 in (select r3_code from konka_r3_shop where id in (select konka_r3_id from BRANCH_ASSIGN t where syb_id=#map.konka_dept_id# or fgs_id=#map.konka_dept_id# or jyb_id=#map.konka_dept_id# or bsc_id=#map.konka_dept_id#))</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.ywy_user_id">COLUMN_1 in (select r3_code from konka_r3_shop where id in (select konka_r3_id from BRANCH_ASSIGN t where user_id=#map.ywy_user_id#))</isNotEmpty>
	</sql>

	<select id="selectChannelDataImport" resultMap="channelDataImportResult" parameterClass="channelDataImport">
		select * from CHANNEL_DATA_IMPORT where 1 = 1
		<include refid="sf-channelDataImport" />
		<![CDATA[ and rownum < 2 ]]>
	</select>

	<select id="selectChannelDataImportList" resultMap="channelDataImportToModel" parameterClass="channelDataImport">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select distinct t.column_11 as model from channel_data_import t where 1 = 1
		<include refid="sf-channelDataImport" />
		<isNotEmpty prepend=" " property="map.orderByDate">order by COLUMN_7 asc</isNotEmpty>
		<isEmpty prepend=" " property="map.orderByDate">
		</isEmpty>
	</select>



	<select id="selectChannelDataImportListToSum" resultMap="channelDataImportResultToSum" parameterClass="channelDataImport">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		SELECT A.*, B.PD_ID
		FROM CHANNEL_DATA_IMPORT A
		LEFT JOIN KONKA_PE_PD_MODEL B ON A.COLUMN_11 = B.MD_NAME
		WHERE 1 = 1
		<include refid="sf-channelDataImport" />
		<isNotEmpty prepend=" and " property="map.date_like">
		<![CDATA[ TO_CHAR(A.COLUMN_7, 'yyyymmdd') <= #map.date_like:VARCHAR# ]]>
			ORDER BY A.COLUMN_7 , A.ID
		</isNotEmpty>
		<isEmpty prepend=" " property="map.date_like">
			ORDER BY A.COLUMN_7 , A.ID
		</isEmpty>
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectChannelDataImportCount" resultClass="long" parameterClass="channelDataImport">
		select count(*) from
		<isNotEmpty property="map.count1">
			CHANNEL_DATA_IMPORT where 1 = 1
		</isNotEmpty>
		<isNotEmpty property="map.count2">
			(select column_1,
			column_11,
			sum(to_number(column_12)) as num,
			avg(column_13) as price,
			sum(column_14) as total
			from CHANNEL_DATA_IMPORT
			where 1 = 1
			group by column_1, column_11
			<isNotEmpty property="map.date1">
				<isNotEmpty prepend="," property="map.date_start">column_7
					having  <![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
				<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="map.date2">
				<isNotEmpty prepend="," property="map.date_start">
					column_7 having  <![CDATA[to_char(COLUMN_7,'yyyymm') >=#map.date_start#]]></isNotEmpty>
				<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymm') <=#map.date_end# ]]></isNotEmpty>
			</isNotEmpty>
			) where 1 = 1
		</isNotEmpty>
		<isNotEmpty property="map.count3">
			(select distinct t.column_11 from channel_data_import t ) where 1 = 1
		</isNotEmpty>
		<include refid="sf-channelDataImport" />
	</select>

	<select id="selectChannelDataImportForSum" resultClass="long" parameterClass="channelDataImport">
		select decode(sum(num),null,0,sum(num)) from
		<isNotEmpty property="map.a">
			(select COLUMN_1,COLUMN_11,sum(to_number(decode(column_12,null,0,column_12))) as num
			from CHANNEL_DATA_IMPORT
			group by COLUMN_1, COLUMN_11 ,column_12,column_7 having to_number(column_12)>0
			<isNotEmpty prepend=" and " property="map.date_start">  <![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			) where 1 = 1
			<include refid="sf-channelDataImport" />
		</isNotEmpty>

		<isNotEmpty property="map.a1">
			(select COLUMN_1,sum(to_number(column_12)) as num
			from CHANNEL_DATA_IMPORT
			group by COLUMN_1 , column_7 ,column_12 having to_number(column_12)>0
			<isNotEmpty prepend=" and " property="map.date_start">  <![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			) where 1 = 1
			<isNotEmpty prepend=" and " property="column_1">COLUMN_1 = #column_1:VARCHAR#</isNotEmpty>
		</isNotEmpty>

		<isNotEmpty property="map.b">
			(select COLUMN_3,COLUMN_11,sum(to_number(column_12)) as num
			from CHANNEL_DATA_IMPORT
			group by COLUMN_3, COLUMN_11 ,column_12,column_7 having to_number(column_12)>0
			<isNotEmpty prepend=" and " property="map.date_start"><![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			) where 1 = 1
			<include refid="sf-channelDataImport" />
		</isNotEmpty>

		<isNotEmpty property="map.b1">
			(select COLUMN_3,sum(to_number(column_12)) as num
			from CHANNEL_DATA_IMPORT
			group by COLUMN_3,column_12,column_7 having to_number(column_12)>0
			<isNotEmpty prepend=" and " property="map.date_start"><![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			) where 1 = 1
			<isNotEmpty prepend=" and " property="column_3">COLUMN_3 = #column_3:VARCHAR#</isNotEmpty>
		</isNotEmpty>

		<isNotEmpty property="map.c">
			(select COLUMN_1, COLUMN_11, sum(to_number(column_12)) as num
			from CHANNEL_DATA_IMPORT
			group by COLUMN_1, COLUMN_11 ,column_12 ,column_7
			having to_number(column_12)>0
			<isNotEmpty prepend=" and " property="map.is_fgs">
				column_1 in (select r3_code from konka_r3_shop where branch_area_name = #map.fgs:VARCHAR#)
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="map.is_jyb">
				column_1 in (select r3_code from konka_r3_shop where handle_name = #map.fgs:VARCHAR#)
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_start"> <![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			)
			where 1 = 1
			<include refid="sf-channelDataImport" />
		</isNotEmpty>

		<isNotEmpty property="map.c1">
			(select sum(to_number(column_12)) as num
			from CHANNEL_DATA_IMPORT
			where 1=1
			<isNotEmpty prepend=" and " property="map.is_jyb">
				column_1 in (select r3_code from konka_r3_shop where handle_name = #map.fgs:VARCHAR#)
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="map.is_fgs">
				column_1 in (select r3_code from konka_r3_shop where branch_area_name = #map.fgs:VARCHAR#)
			</isNotEmpty>
			and to_number(column_12)>0
			<isNotEmpty prepend=" and " property="map.date_start"><![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			)
			where 1 = 1
			<include refid="sf-channelDataImport" />
		</isNotEmpty>


		<isNotEmpty property="map.d">
			(select COLUMN_1, COLUMN_11, sum(to_number(column_12)) as num
			from CHANNEL_DATA_IMPORT
			group by COLUMN_1, COLUMN_11 ,column_12 ,column_7
			having to_number(column_12)>0
			and column_1 in (select r3_code from konka_r3_shop where handle_name = #map.fgs:VARCHAR#)
			<isNotEmpty prepend=" and " property="map.date_start"> <![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			)
			where 1 = 1
			<include refid="sf-channelDataImport" />
		</isNotEmpty>

		<isNotEmpty property="map.d1">
			(select sum(to_number(column_12)) as num
			from CHANNEL_DATA_IMPORT
			where 1=1 and column_1 in (select r3_code from konka_r3_shop where handle_name = #map.fgs:VARCHAR#) and to_number(column_12)>0
			<isNotEmpty property="map.date1">
				<isNotEmpty prepend=" and " property="map.date_start"><![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
				<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="map.date2">
				<isNotEmpty prepend=" and " property="map.date_start"> <![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
				<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			</isNotEmpty>
			)
			where 1 = 1
			<include refid="sf-channelDataImport" />
		</isNotEmpty>

		<isNotEmpty property="map.e">
			(select
			sum(to_number(column_12)) as num
			from CHANNEL_DATA_IMPORT where to_number(column_12)>0
			<isNotEmpty prepend=" and " property="map.date_start"> <![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
			)
			where 1 = 1
		</isNotEmpty>
	</select>

	<select id="selectChannelDataImportPaginatedList" resultMap="channelDataImportResultForList" parameterClass="channelDataImport">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from CHANNEL_DATA_IMPORT where 1 = 1
		<include refid="sf-channelDataImport" />
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<select id="selectChannelDataImportPaginatedListforR3" resultMap="channelDataImportResultForList" parameterClass="channelDataImport">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select
		distinct column_1
		from CHANNEL_DATA_IMPORT where 1 = 1
		<include refid="sf-channelDataImport" />
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<select id="selectChannelDataImportPaginatedListForModel" resultMap="channelDataImportToModel" parameterClass="channelDataImport" remapResults="true">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select distinct t.column_11 as model from channel_data_import t where 1 = 1
		<include refid="sf-channelDataImport" />
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<select id="selectChannelDataImportPaginatedListForStat" resultMap="channelDataImportToStat" parameterClass="channelDataImport" remapResults="true">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select column_1, column_11,
		sum(to_number(column_12)) as num,
		round(avg(column_13),2) as price,
		sum(column_14) as total
		from CHANNEL_DATA_IMPORT
		where 1 = 1
		<include refid="sf-channelDataImport" />
		group by column_1 ,column_11
		<isNotEmpty property="map.date1">
			<isNotEmpty prepend="," property="map.date_start">column_7
				having  <![CDATA[to_char(COLUMN_7,'yyyymmDD') >=#map.date_start#]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymmDD') <=#map.date_end# ]]></isNotEmpty>
		</isNotEmpty>
		<isNotEmpty property="map.date2">
			<isNotEmpty prepend="," property="map.date_start">
				column_7 having <![CDATA[to_char(COLUMN_7,'yyyymm') >=#map.date_start#]]></isNotEmpty>
			<isNotEmpty prepend=" and " property="map.date_end"><![CDATA[to_char(COLUMN_7,'yyyymm') <=#map.date_end# ]]></isNotEmpty>
		</isNotEmpty>
	<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>


	<!-- @author Wang,Yang @version 2011-11-10 @desc 最基本的LIST查询 -->
	<select id="selectChannelDataListByPdId" resultMap="channelDataImportResultForList" parameterClass="channelDataImport" remapResults="true">
		select * from CHANNEL_DATA_IMPORT
		where 1=1
		<include refid="sf-channelDataImport" />
	</select>

	<select id="selectChannelDataSumByPdId" resultClass="decimal" parameterClass="channelDataImport" remapResults="true">
		select sum($map.column$) from CHANNEL_DATA_IMPORT t
		where 1=1
		<include refid="sf-channelDataImport" />
	</select>

	<!-- @author Wang,Yang @version 2011-12-28 @desc 客户结算统计 -->
	<select id="selectChannelDataImportListForStatistics" resultMap="channelDataImportToStat" parameterClass="channelDataImport" remapResults="true">
		select
		<isNotEmpty prepend="" property="map.isDKH">(select customer_name from konka_r3_shop where r3_code = column_1) column_1,</isNotEmpty>
		<isEmpty prepend="" property="map.isDKH">#map.dept_name# as column_1,</isEmpty>
		column_11,
		sum(to_number(column_12)) as num,
		round(avg(column_13),2) as price,
		sum(column_14) as total
		from CHANNEL_DATA_IMPORT
		where 1 = 1
		<include refid="sf-channelDataImport" />
		group by
		<isNotEmpty prepend="" property="map.isDKH">column_1,</isNotEmpty>
		column_11
	</select>
	
	<select id="selectChannelDataImportAllCountAndAllMoney" resultClass="java.util.HashMap" parameterClass="channelDataImport">
		select sum(column_12) as all_count, sum(column_14) as all_money from CHANNEL_DATA_IMPORT where 1=1
		<include refid="sf-channelDataImport" />
	</select>
	
	<select id="selectChannelDataImportForMaxDate" resultMap="channelDataImportForMaxDate" parameterClass="channelDataImport">
		select max(import_date) import_date from channel_data_import
	</select>
	

	<insert id="insertChannelDataImport" parameterClass="channelDataImport">
		<selectKey resultClass="long" keyProperty="id">select SEQ_CHANNEL_DATA_IMPORT.nextval as id from dual</selectKey>
		<![CDATA[insert into CHANNEL_DATA_IMPORT (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">ID</isNotNull>
			<isNotNull prepend="," property="import_date">IMPORT_DATE</isNotNull>
			<isNotNull prepend="," property="import_uid">IMPORT_UID</isNotNull>
			<isNotNull prepend="," property="column_1">COLUMN_1</isNotNull>
			<isNotNull prepend="," property="column_2">COLUMN_2</isNotNull>
			<isNotNull prepend="," property="column_3">COLUMN_3</isNotNull>
			<isNotNull prepend="," property="column_4">COLUMN_4</isNotNull>
			<isNotNull prepend="," property="column_5">COLUMN_5</isNotNull>
			<isNotNull prepend="," property="column_6">COLUMN_6</isNotNull>
			<isNotNull prepend="," property="column_7">COLUMN_7</isNotNull>
			<isNotNull prepend="," property="column_8">COLUMN_8</isNotNull>
			<isNotNull prepend="," property="column_9">COLUMN_9</isNotNull>
			<isNotNull prepend="," property="column_10">COLUMN_10</isNotNull>
			<isNotNull prepend="," property="column_11">COLUMN_11</isNotNull>
			<isNotNull prepend="," property="column_12">COLUMN_12</isNotNull>
			<isNotNull prepend="," property="column_13">COLUMN_13</isNotNull>
			<isNotNull prepend="," property="column_14">COLUMN_14</isNotNull>
			<isNotNull prepend="," property="column_15">COLUMN_15</isNotNull>
			<isNotNull prepend="," property="column_16">COLUMN_16</isNotNull>
			<isNotNull prepend="," property="column_17">COLUMN_17</isNotNull>
			<isNotNull prepend="," property="column_18">COLUMN_18</isNotNull>
			<isNotNull prepend="," property="column_19">COLUMN_19</isNotNull>
			<isNotNull prepend="," property="column_20">COLUMN_20</isNotNull>
			<isNotNull prepend="," property="column_21">COLUMN_21</isNotNull>
			<isNotNull prepend="," property="column_22">COLUMN_22</isNotNull>
			<isNotNull prepend="," property="column_23">COLUMN_23</isNotNull>
			<isNotNull prepend="," property="column_24">COLUMN_24</isNotNull>
			<isNotNull prepend="," property="column_25">COLUMN_25</isNotNull>
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">#id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="import_date">#import_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="import_uid">#import_uid:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="column_1">#column_1:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_2">#column_2:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_3">#column_3:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_4">#column_4:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_5">#column_5:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_6">#column_6:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_7">#column_7:DATETIME#</isNotNull>
			<isNotNull prepend="," property="column_8">#column_8:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_9">#column_9:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_10">#column_10:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_11">#column_11:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_12">#column_12:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_13">#column_13:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="column_14">#column_14:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="column_15">#column_15:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="column_16">#column_16:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="column_17">#column_17:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="column_18">#column_18:DATETIME#</isNotNull>
			<isNotNull prepend="," property="column_19">#column_19:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_20">#column_20:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_21">#column_21:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_22">#column_22:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_23">#column_23:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_24">#column_24:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_25">#column_25:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateChannelDataImport" parameterClass="channelDataImport">
		update CHANNEL_DATA_IMPORT
		<dynamic prepend="set">
			<isNotNull prepend="," property="id">ID = #id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="import_date">IMPORT_DATE = #import_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="import_uid">IMPORT_UID = #import_uid:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="column_1">COLUMN_1 = #column_1:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_2">COLUMN_2 = #column_2:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_3">COLUMN_3 = #column_3:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_4">COLUMN_4 = #column_4:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_5">COLUMN_5 = #column_5:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_6">COLUMN_6 = #column_6:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_7">COLUMN_7 = #column_7:DATETIME#</isNotNull>
			<isNotNull prepend="," property="map.column_7">COLUMN_7 = TO_DATE('', 'DD-MON-RR')</isNotNull>
			<isNotNull prepend="," property="column_8">COLUMN_8 = #column_8:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_9">COLUMN_9 = #column_9:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_10">COLUMN_10 = #column_10:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_11">COLUMN_11 = #column_11:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_12">COLUMN_12 = #column_12:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_13">COLUMN_13 = #column_13:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="map.column_13">COLUMN_13 = ''</isNotNull>
			<isNotNull prepend="," property="column_14">COLUMN_14 = #column_14:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="map.column_14">COLUMN_14 = ''</isNotNull>
			<isNotNull prepend="," property="column_15">COLUMN_15 = #column_15:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="map.column_15">COLUMN_15 = ''</isNotNull>
			<isNotNull prepend="," property="column_16">COLUMN_16 = #column_16:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="map.column_16">COLUMN_16 = ''</isNotNull>
			<isNotNull prepend="," property="column_17">COLUMN_17 = #column_17:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="map.column_17">COLUMN_17 = ''</isNotNull>
			<isNotNull prepend="," property="column_18">COLUMN_18 = #column_18:DATETIME#</isNotNull>
			<isNotNull prepend="," property="map.column_18">COLUMN_18 = TO_DATE('', 'DD-MON-RR')</isNotNull>
			<isNotNull prepend="," property="column_19">COLUMN_19 = #column_19:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_20">COLUMN_20 = #column_20:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_21">COLUMN_21 = #column_21:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_22">COLUMN_22 = #column_22:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_23">COLUMN_23 = #column_23:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_24">COLUMN_24 = #column_24:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_25">COLUMN_25 = #column_25:VARCHAR#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteChannelDataImport" parameterClass="channelDataImport">
		delete from CHANNEL_DATA_IMPORT where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

</sqlMap>