<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KONKA_SP_ACTIVITY_BOOK_REPORT">

	<typeAlias alias="konkaSpActivityBookReport" type="com.ebiz.mmt.domain.KonkaSpActivityBookReport" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertKonkaSpActivityBookReport" />
		<flushOnExecute statement="updateKonkaSpActivityBookReport" />
		<flushOnExecute statement="deleteKonkaSpActivityBookReport" />
	</cacheModel>

	<resultMap id="konkaSpActivityBookReportResultForList" class="konkaSpActivityBookReport">
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="SP_ID" property="sp_id" jdbcType="DECIMAL" />
		<result column="ADDR_ID" property="addr_id" jdbcType="DECIMAL" />
		<result column="SIZE_SECTION" property="size_section" jdbcType="VARCHAR" />
		<result column="MODEL_NAME" property="model_name" jdbcType="VARCHAR" />
		<result column="COMSUMER_NAME" property="comsumer_name" jdbcType="VARCHAR" />
		<result column="COMSUMER_PHONE" property="comsumer_phone" jdbcType="VARCHAR" />
		<result column="NUM" property="num" jdbcType="DECIMAL" />
		<result column="PREPAY_STATE" property="prepay_state" jdbcType="DECIMAL" />
		<result column="PREPAY_MONEY" property="prepay_money" jdbcType="DECIMAL" />
		<result column="ADD_DATE" property="add_date" jdbcType="TIMESTAMP" />
		<result column="ADD_USER_NAME" property="add_user_name" jdbcType="VARCHAR" />
		<result column="STATE" property="state" jdbcType="DECIMAL" />
		<result column="MEMO" property="memo" jdbcType="VARCHAR" />
		<result column="ADD_USER_ID" property="add_user_id" jdbcType="DECIMAL" />
		<result column="SP_NAME" property="sp_name" jdbcType="VARCHAR" />
		<result column="ADDR_NAME" property="addr_name" jdbcType="VARCHAR" />
		<result column="R3_CODE" property="r3_code" jdbcType="VARCHAR" />
		<result column="STORE_ID" property="store_id" jdbcType="DECIMAL" />
		<result column="STORE_NAME" property="store_name" jdbcType="VARCHAR" />
	</resultMap>
	<resultMap id="konkaSpActivityBookReportYytjResult" class="konkaSpActivityBookReport">
		<result column="STORE_ID" property="store_id" jdbcType="DECIMAL" />
		<result column="STORE_NAME" property="store_name" jdbcType="VARCHAR" />
		<result column="SP_ID" property="sp_id" jdbcType="DECIMAL" />
		<result column="ADDR_ID" property="addr_id" jdbcType="DECIMAL" />
		<result column="SIZE_SECTION" property="size_section" jdbcType="VARCHAR" />
		<result column="NUM" property="num" jdbcType="DECIMAL" />
		<result column="PREPAY_MONEY" property="prepay_money" jdbcType="DECIMAL" />
		<result column="SP_NAME" property="sp_name" jdbcType="VARCHAR" />
		<result column="ADDR_NAME" property="addr_name" jdbcType="VARCHAR" />
		<result column="R3_CODE" property="r3_code" jdbcType="VARCHAR" />
		<result column="CUSTOMER_NAME" property="map.customer_name" jdbcType="VARCHAR" />
		<result column="DEPT_ID" property="map.dept_id" jdbcType="VARCHAR" />
		<result column="DEPT_NAME" property="map.dept_name" jdbcType="VARCHAR" />
	</resultMap>
	<resultMap id="konkaSpActivityBookReportYyLstjResult" class="konkaSpActivityBookReport">
		<result column="FGS_ID" property="map.fgs_id" jdbcType="DECIMAL" />
		<result column="FGS_NAME" property="map.fgs_name" jdbcType="VARCHAR" />
		<result column="R3_CODE" property="r3_code" jdbcType="VARCHAR" />
		<result column="CUSTOMER_NAME" property="map.customer_name" jdbcType="VARCHAR" />
		<result column="STORE_ID" property="store_id" jdbcType="DECIMAL" />
		<result column="STORE_NAME" property="store_name" jdbcType="DECIMAL" />
		<result column="YY_NUM" property="map.yy_num" jdbcType="DECIMAL" />
		<result column="YY_MONEY" property="map.yy_money" jdbcType="DECIMAL" />
		<result column="LS_NUM" property="map.ls_num" jdbcType="DECIMAL" />
		<result column="LS_MONEY" property="map.ls_money" jdbcType="DECIMAL" />
		<result column="SIZE_SECTION" property="size_section" jdbcType="DECIMAL" />
	</resultMap>


	<resultMap id="konkaSpActivityBookReportResult" class="konkaSpActivityBookReport" extends="konkaSpActivityBookReportResultForList">
	</resultMap>

	<sql id="sf-konkaSpActivityBookReport">
		<isNotEmpty prepend=" and " property="id">ID = #id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sp_id">SP_ID = #sp_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addr_id">ADDR_ID = #addr_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="size_section">SIZE_SECTION = #size_section:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="model_name">MODEL_NAME = #model_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="comsumer_name">COMSUMER_NAME = #comsumer_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="comsumer_phone">COMSUMER_PHONE = #comsumer_phone:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="num">NUM = #num:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="prepay_state">PREPAY_STATE = #prepay_state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="prepay_money">PREPAY_MONEY = #prepay_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_name">ADD_USER_NAME = #add_user_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="state">STATE = #state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="memo">MEMO = #memo:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">ADD_USER_ID = #add_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sp_name">SP_NAME = #sp_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addr_name">ADDR_NAME = #addr_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="r3_code">R3_CODE = #r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="store_id">STORE_ID = #store_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="store_name">STORE_NAME = #store_name:VARCHAR#</isNotEmpty>
		
	</sql>
	
	<sql id="sf-konkaSpActivityBookReport-a">
		<isNotEmpty prepend=" and " property="id">a.ID = #id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sp_id">a.SP_ID = #sp_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addr_id">a.ADDR_ID = #addr_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="size_section">a.SIZE_SECTION = #size_section:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="model_name">a.MODEL_NAME = #model_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="comsumer_name">a.COMSUMER_NAME = #comsumer_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="comsumer_phone">a.COMSUMER_PHONE = #comsumer_phone:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="num">a.NUM = #num:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="prepay_state">a.PREPAY_STATE = #prepay_state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="prepay_money">a.PREPAY_MONEY = #prepay_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">a.ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_name">a.ADD_USER_NAME = #add_user_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="state">a.STATE = #state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="memo">a.MEMO = #memo:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">a.ADD_USER_ID = #add_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sp_name">a.SP_NAME = #sp_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addr_name">a.ADDR_NAME = #addr_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="r3_code">a.R3_CODE = #r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="store_id">a.STORE_ID = #store_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="store_name">a.STORE_NAME = #store_name:VARCHAR#</isNotEmpty>
		
		<!--下面是扩展的-->
		<isNotEmpty prepend=" and " property="map.sp_name_like">a.SP_NAME like '%' || #map.sp_name_like:VARCHAR# || '%'  </isNotEmpty>
		<isNotEmpty prepend=" and " property="map.addr_name_like">a.ADDR_NAME like '%' || #map.addr_name_like:VARCHAR# || '%'  </isNotEmpty>
		<isNotEmpty prepend=" and " property="map.model_name_like">a.MODEL_NAME like '%' || #map.model_name_like:VARCHAR# || '%'  </isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_id">b.DEPT_ID=#map.dept_id#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_name_like">B.CUSTOMER_NAME like '%' || #map.customer_name_like:VARCHAR# || '%'  </isNotEmpty>
		<isNotEmpty prepend=" and " property="map.store_name_like">a.STORE_NAME like '%'||#map.store_name_like:VARCHAR#||'%'</isNotEmpty>
<!--		<isNotEmpty prepend=" and " property="map.dept_id_in">-->
<!--		b.cur_dept_id in (select dept_id from KONKA_DEPT start with dept_id =-->
<!--			#map.dept_id_in# connect by prior dept_id = par_id)-->
<!--		</isNotEmpty>-->
<!--		<isNotEmpty prepend=" and " property="map.dept_id_in">-->
<!--		exists (select 1 from konka_pe_prod_user where id= a.add_user_id and-->
<!--		dept_id in (select dept_id from KONKA_DEPT start with dept_id =-->
<!--			#map.dept_id_in# connect by prior dept_id = par_id))-->
<!--		</isNotEmpty >-->
		 <isNotEmpty prepend=" and " property="map.dept_id_start">
			(b.cur_dept_id is not null and  b.cur_dept_id in (
						select dept_id from konka_dept start with dept_id in (
						SELECT DISTINCT (dept_id)
		  							FROM KONKA_ROLE_DATA_LEVEL
		 							WHERE role_id IN (SELECT role_id
		                     			FROM KONKA_PE_ROLE_USER
		                    			WHERE user_id = #map.session_user_id#)
						) or dept_id = #map.dept_id_start# 
						connect by prior dept_id = par_id 
					)
			)
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">
			<![CDATA[ (b.user_id = #map.filter_by_ywy_id_eq# or t.ywy_job_id = (select job_id from konka_pe_prod_user where id = #map.filter_by_ywy_id_eq# and rownum<2))]]>
		</isNotEmpty> 
		
		
		
		<isNotEmpty  prepend=" and " property="map.add_date_start">
		<![CDATA[a.ADD_DATE >= to_date(#map.add_date_start#,'yyyy-MM-dd hh24:mi:ss')]]>
		</isNotEmpty >
		<isNotEmpty prepend=" and " property="map.add_date_end">
		<![CDATA[a.ADD_DATE <= to_date(#map.add_date_end#,'yyyy-MM-dd hh24:mi:ss')]]>
		</isNotEmpty>
	</sql>

	<select id="selectKonkaSpActivityBookReport" resultMap="konkaSpActivityBookReportResult" parameterClass="konkaSpActivityBookReport" cacheModel="oneDayCache">
		select * from KONKA_SP_ACTIVITY_BOOK_REPORT where 1 = 1
		<include refid="sf-konkaSpActivityBookReport" />
	</select>

	<select id="selectKonkaSpActivityBookReportList" resultMap="konkaSpActivityBookReportResultForList" parameterClass="konkaSpActivityBookReport" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from KONKA_SP_ACTIVITY_BOOK_REPORT where 1 = 1
		<include refid="sf-konkaSpActivityBookReport" />
		<!-- order by ID asc -->
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectKonkaSpActivityBookReportCount" resultClass="long" parameterClass="konkaSpActivityBookReport" cacheModel="oneDayCache">
		select count(*) from KONKA_SP_ACTIVITY_BOOK_REPORT a 
		left join MV_ORG_OF_CUSTOMER_ALL b 
		on a.r3_code =b.r3_code 
		left join konka_r3_store t 
			on  a.store_id=t.store_id
		where 1 = 1
		<include refid="sf-konkaSpActivityBookReport-a" />
	</select>

	<select id="selectKonkaSpActivityBookReportPaginatedList" resultMap="konkaSpActivityBookReportResult" parameterClass="konkaSpActivityBookReport" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select a.* from KONKA_SP_ACTIVITY_BOOK_REPORT a 
		left join MV_ORG_OF_CUSTOMER_ALL b 
		on a.r3_code =b.r3_code  
		left join konka_r3_store t 
			on  a.store_id=t.store_id
		where 1 = 1
		<include refid="sf-konkaSpActivityBookReport-a" />
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	
	<!--预约统计	-->
	<select id="selectKonkaSpActivityBookReportYytjCount" resultClass="long" parameterClass="konkaSpActivityBookReport" cacheModel="oneDayCache">
	SELECT count (1)
 		 FROM (SELECT a.R3_CODE
	          FROM    KONKA_SP_ACTIVITY_BOOK_REPORT a
	               LEFT JOIN
	                  MV_ORG_OF_CUSTOMER_ALL b
	               ON a.r3_code = b.r3_code
	               left join konka_r3_store t 
			on  a.store_id=t.store_id
	         WHERE 1 = 1
	<include refid="sf-konkaSpActivityBookReport-a" />
	GROUP BY a.store_id,a.R3_CODE,a.ADDR_ID,a.SP_ID,a.SIZE_SECTION)
	</select>
	
	<select id="selectKonkaSpActivityBookReportYytjPaginatedList" resultMap="konkaSpActivityBookReportYytjResult" parameterClass="konkaSpActivityBookReport" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
			SELECT 
			a.store_id,
			a.store_name,
			a.R3_CODE,
			a.ADDR_ID,
			max (a.ADDR_NAME) addr_name,
			a.SP_ID,
			max(a.sp_name) sp_name,
			a.SIZE_SECTION,
			sum(a.NUM) num,
			sum(a.PREPAY_MONEY) prepay_money,
			max(b.DEPT_ID) dept_id,
			max(b.DEPT_NAME) dept_name,
			max(b.customer_name) customer_name
			FROM KONKA_SP_ACTIVITY_BOOK_REPORT a
			left join MV_ORG_OF_CUSTOMER_ALL b
			on a.r3_code=b.r3_code
			left join konka_r3_store t 
			on  a.store_id=t.store_id
			where 1=1
		<include refid="sf-konkaSpActivityBookReport-a" />
		GROUP BY a.store_id,a.store_name,a.R3_CODE,a.ADDR_ID,a.SP_ID,a.SIZE_SECTION
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>	
	
	
	
	
	<!--预约零售统计	-->
	<select id="selectKonkaSpActivityBookReportYyLstjCount" resultClass="long" parameterClass="konkaSpActivityBookReport" cacheModel="oneDayCache">
	SELECT count (1)
 		 FROM (SELECT a.R3_CODE
	          FROM    KONKA_SP_ACTIVITY_BOOK_REPORT a
	               LEFT JOIN
	                  MV_ORG_OF_CUSTOMER_ALL b
	               ON a.r3_code = b.r3_code
	               left join konka_r3_store t 
			on  a.store_id=t.store_id
	         WHERE 1 = 1
	<include refid="sf-konkaSpActivityBookReport-a" />
	GROUP BY a.R3_CODE,a.ADDR_ID,a.SP_ID,a.SIZE_SECTION)
	</select>
	
	<select id="selectKonkaSpActivityBookReportYyLstjPaginatedList" resultMap="konkaSpActivityBookReportYyLstjResult" parameterClass="konkaSpActivityBookReport" cacheModel="oneDayCache">
						<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
								SELECT *
			  FROM (SELECT b.dept_id fgs_id,max(a.r3_code) r3_code,a.size_section,
                            max(b.customer_name) customer_name,b.dept_name fgs_name, a.store_name,SUM (a.num) yy_num,SUM (a.PREPAY_money) yy_money,
			               a.store_id
			          FROM konka_sp_activity_book_report a
			               LEFT JOIN konka_r3_store t
			                  ON a.store_id = t.store_id
			               LEFT JOIN MV_ORG_OF_CUSTOMER_ALL b
			                  ON a.r3_code = b.r3_code
			         WHERE 1 = 1 
			          <include refid="sf-konkaSpActivityBookReport-a" />
			        GROUP BY a.store_id,a.store_name,b.dept_id, b.dept_name,a.size_section)
			    t1
			LEFT JOIN
			    ( SELECT  a1.dept_id,SUM(a1.num) ls_num, SUM(a1.all_price) ls_money,c1.size_sec
			        FROM
			            konka_mobile_sail_data a1
			        LEFT JOIN konka_r3_store tt
			        ON a1.dept_id =tt.store_id
			        LEFT JOIN MV_ORG_OF_CUSTOMER_ALL b1
			        ON tt.r3_code= b1.r3_code
			        left join konka_pe_pd_model c1
			        on a1.model_id=c1.pd_id
			        WHERE 1=1
	<isNotEmpty prepend=" and " property="map.dept_id_start">
		(b1.cur_dept_id is not null and b1.cur_dept_id in (
		select dept_id from konka_dept start with dept_id in (
		SELECT DISTINCT (dept_id)
		FROM KONKA_ROLE_DATA_LEVEL
		WHERE role_id IN (SELECT role_id
		FROM KONKA_PE_ROLE_USER
		WHERE user_id = #map.session_user_id#)
		) or dept_id = #map.dept_id_start#
		connect by prior dept_id = par_id
		)
		)
		</isNotEmpty>
	<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">
			<![CDATA[ (b1.user_id = #map.filter_by_ywy_id_eq# or tt.ywy_job_id = (select job_id from konka_pe_prod_user where id = #map.filter_by_ywy_id_eq# and rownum<2))]]>
	</isNotEmpty>
	<isNotEmpty prepend=" and " property="map.add_date_start">
		<![CDATA[a1.REPORT_DATE >= to_date(#map.add_date_start#,'yyyy-MM-dd hh24:mi:ss')]]>
	</isNotEmpty>
	<isNotEmpty prepend=" and " property="map.add_date_end">
		<![CDATA[a1.REPORT_DATE <= to_date(#map.add_date_end#,'yyyy-MM-dd hh24:mi:ss')]]>
	</isNotEmpty>
	group by a1.dept_id,c1.size_sec
	) t2 on t1.store_id =t2.dept_id and t1.size_section=t2.size_sec
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>	

	<insert id="insertKonkaSpActivityBookReport" parameterClass="konkaSpActivityBookReport">
		<selectKey resultClass="long" keyProperty="id">select seq_KONKA_SP_ACTIVITY_BOOK_REPORT.nextval as id from dual </selectKey>
		<![CDATA[insert into KONKA_SP_ACTIVITY_BOOK_REPORT (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">ID</isNotNull>	
			<isNotNull prepend="," property="sp_id">SP_ID</isNotNull>	
			<isNotNull prepend="," property="addr_id">ADDR_ID</isNotNull>	
			<isNotNull prepend="," property="size_section">SIZE_SECTION</isNotNull>	
			<isNotNull prepend="," property="model_name">MODEL_NAME</isNotNull>	
			<isNotNull prepend="," property="comsumer_name">COMSUMER_NAME</isNotNull>	
			<isNotNull prepend="," property="comsumer_phone">COMSUMER_PHONE</isNotNull>	
			<isNotNull prepend="," property="num">NUM</isNotNull>	
			<isNotNull prepend="," property="prepay_state">PREPAY_STATE</isNotNull>	
			<isNotNull prepend="," property="prepay_money">PREPAY_MONEY</isNotNull>	
			<isNotNull prepend="," property="add_date">ADD_DATE</isNotNull>	
			<isNotNull prepend="," property="add_user_name">ADD_USER_NAME</isNotNull>	
			<isNotNull prepend="," property="state">STATE</isNotNull>	
			<isNotNull prepend="," property="memo">MEMO</isNotNull>	
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID</isNotNull>	
			<isNotNull prepend="," property="sp_name">SP_NAME</isNotNull>	
			<isNotNull prepend="," property="addr_name">ADDR_NAME</isNotNull>	
			<isNotNull prepend="," property="r3_code">R3_CODE</isNotNull>	
			<isNotNull prepend="," property="store_id">STORE_ID</isNotNull>	
			<isNotNull prepend="," property="store_name">STORE_NAME</isNotNull>
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">#id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sp_id">#sp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="addr_id">#addr_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="size_section">#size_section:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="model_name">#model_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="comsumer_name">#comsumer_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="comsumer_phone">#comsumer_phone:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="num">#num:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="prepay_state">#prepay_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="prepay_money">#prepay_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_date">#add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="add_user_name">#add_user_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="state">#state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="memo">#memo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_user_id">#add_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sp_name">#sp_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="addr_name">#addr_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="r3_code">#r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="store_id">#store_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="store_name">#store_name:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateKonkaSpActivityBookReport" parameterClass="KonkaSpActivityBookReport">
		update KONKA_SP_ACTIVITY_BOOK_REPORT
		<dynamic prepend="set">
			<isNotNull prepend="," property="id">ID = #id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sp_id">SP_ID = #sp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="addr_id">ADDR_ID = #addr_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="size_section">SIZE_SECTION = #size_section:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="model_name">MODEL_NAME = #model_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="comsumer_name">COMSUMER_NAME = #comsumer_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="comsumer_phone">COMSUMER_PHONE = #comsumer_phone:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="num">NUM = #num:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="prepay_state">PREPAY_STATE = #prepay_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="prepay_money">PREPAY_MONEY = #prepay_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="add_user_name">ADD_USER_NAME = #add_user_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="state">STATE = #state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="memo">MEMO = #memo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID = #add_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sp_name">SP_NAME = #sp_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="addr_name">ADDR_NAME = #addr_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="r3_code">R3_CODE = #r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="store_id">STORE_ID = #store_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="store_name">STORE_NAME = #store_name:VARCHAR#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteKonkaSpActivityBookReport" parameterClass="KonkaSpActivityBookReport">
		delete from KONKA_SP_ACTIVITY_BOOK_REPORT where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

</sqlMap>