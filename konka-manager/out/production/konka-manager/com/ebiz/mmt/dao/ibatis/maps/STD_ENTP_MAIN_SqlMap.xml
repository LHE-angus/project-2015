<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="STD_ENTP_MAIN">

	<typeAlias alias="stdEntpMain" type="com.ebiz.mmt.domain.StdEntpMain" />

	

	<resultMap id="stdEntpMainResultForList" class="stdEntpMain">
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="ENTP_ID" property="entp_id" jdbcType="DECIMAL" />
		<result column="SHOP_ID" property="shop_id" jdbcType="DECIMAL" />
		<result column="ENTP_NAME" property="entp_name" jdbcType="VARCHAR" />
		<result column="ENTP_SNAME" property="entp_sname" jdbcType="VARCHAR" />
		<result column="ENTP_ENAME" property="entp_ename" jdbcType="VARCHAR" />
		<result column="ENTP_TYPE" property="entp_type" jdbcType="DECIMAL" />
		<result column="P_INDEX" property="p_index" jdbcType="DECIMAL" />
		<result column="C_INDEX" property="c_index" jdbcType="VARCHAR" />
		<result column="PAR_ID" property="par_id" jdbcType="DECIMAL" />
		<result column="ROOT_ENTP_ID" property="root_entp_id" jdbcType="DECIMAL" />
		<result column="MAIN_PD" property="main_pd" jdbcType="VARCHAR" />
		<result column="ENTP_KIND" property="entp_kind" jdbcType="DECIMAL" />
		<result column="ENTP_SIZE" property="entp_size" jdbcType="VARCHAR" />
		<result column="ENTP_LICENCE" property="entp_licence" jdbcType="VARCHAR" />
		<result column="CORPORATION" property="corporation" jdbcType="VARCHAR" />
		<result column="ADDR" property="addr" jdbcType="VARCHAR" />
		<result column="POSTCODE" property="postcode" jdbcType="VARCHAR" />
		<result column="LINKMAN" property="linkman" jdbcType="VARCHAR" />
		<result column="TEL" property="tel" jdbcType="VARCHAR" />
		<result column="FAX" property="fax" jdbcType="VARCHAR" />
		<result column="EMAIL" property="email" jdbcType="VARCHAR" />
		<result column="WWW" property="www" jdbcType="VARCHAR" />
		<result column="IS_RECORD" property="is_record" jdbcType="DECIMAL" />
		<result column="SQ_SERIAL" property="sq_serial" jdbcType="VARCHAR" />
		<result column="SINGLE_CALLBACK" property="single_callback" jdbcType="DECIMAL" />
		<result column="ADV_PAY_SIGN" property="adv_pay_sign" jdbcType="DECIMAL" />
		<result column="OWN_SYS" property="own_sys" jdbcType="DECIMAL" />
		<result column="INFO_STATE" property="info_state" jdbcType="DECIMAL" />
		<result column="LOGO" property="logo" jdbcType="VARCHAR" />
		<result column="ENTP_LICENCE_IMG" property="entp_licence_img" jdbcType="VARCHAR" />
		<result column="ENTP_TAX_LICENCE" property="entp_tax_licence" jdbcType="VARCHAR" />
		<result column="ENTP_TAX_LICENCE_IMG" property="entp_tax_licence_img" jdbcType="VARCHAR" />
		<result column="ENTP_ORG_CODE" property="entp_org_code" jdbcType="VARCHAR" />
		<result column="ENTP_ORG_CODE_IMG" property="entp_org_code_img" jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- Li,Ka 2012-3-16  有密钥登录时查询登录网点信息和企业信息，需要合并买卖提用户和官网用户的所有数据，防止查询不到 -->
	<resultMap id="stdEntpMainOrEntpShopResultForList" class="stdEntpMain">
		<result column="SHOP_ID" property="shop_id" jdbcType="DECIMAL" />
		<result column="ENTP_NAME" property="entp_name" jdbcType="VARCHAR" />
		<result column="P_INDEX" property="p_index" jdbcType="DECIMAL" />
		<result column="ADDR" property="addr" jdbcType="VARCHAR" />
		<result column="POSTCODE" property="postcode" jdbcType="VARCHAR" />
		<result column="LINKMAN" property="linkman" jdbcType="VARCHAR" />
		<result column="TEL" property="tel" jdbcType="VARCHAR" />
		<result column="OWN_SYS" property="own_sys" jdbcType="DECIMAL" />
		<result column="IS_RECORD" property="is_record" jdbcType="DECIMAL" />
		<result column="PAR_ID" property="par_id" jdbcType="DECIMAL" />
	</resultMap>

	<resultMap id="stdEntpMainResult" class="stdEntpMain" extends="stdEntpMainResultForList">
	</resultMap>
	
<!--	<resultMap id="stdEntpMineID" class="Long">-->
<!--		<result column="SHOP_ID" property="shop_id" jdbcType="DECIMAL" />-->
<!--	</resultMap>-->
	
	<!-- 买卖商通统计使用 -->
	<resultMap id="stdEntpMainResultForStatistics" class="stdEntpMain">
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="ENTP_NAME" property="entp_name" jdbcType="VARCHAR" />
		<result column="P_INDEX" property="p_index" jdbcType="DECIMAL" />
		<result column="ADD_DATE" property="add_date" jdbcType="DATETIME" />
		<result column="OWN_SYS" property="own_sys" jdbcType="DECIMAL" />
		<result column="USER_TYPE" property="map.user_type" jdbcType="DECIMAL" />
	</resultMap>

	<sql id="sf-stdEntpMain">
		<isNotEmpty prepend=" and " property="id">ID = #id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_id">ENTP_ID = #entp_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="shop_id">SHOP_ID = #shop_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_name">ENTP_NAME = #entp_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_sname">ENTP_SNAME = #entp_sname:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_ename">ENTP_ENAME = #entp_ename:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_type">ENTP_TYPE = #entp_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="p_index">P_INDEX = #p_index:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="c_index">C_INDEX = #c_index:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="par_id">PAR_ID = #par_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="root_entp_id">ROOT_ENTP_ID = #root_entp_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="main_pd">MAIN_PD = #main_pd:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_kind">ENTP_KIND = #entp_kind:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_size">ENTP_SIZE = #entp_size:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_licence">ENTP_LICENCE = #entp_licence:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="corporation">CORPORATION = #corporation:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addr">ADDR = #addr:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="postcode">POSTCODE = #postcode:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="linkman">LINKMAN = #linkman:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="tel">TEL = #tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fax">FAX = #fax:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="email">EMAIL = #email:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="www">WWW = #www:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_record">IS_RECORD = #is_record:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sq_serial">SQ_SERIAL = #sq_serial:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="single_callback">SINGLE_CALLBACK = #single_callback:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="adv_pay_sign">ADV_PAY_SIGN = #adv_pay_sign:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="own_sys">OWN_SYS = #own_sys:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="info_state">INFO_STATE = #info_state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="logo">LOGO = #logo:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_licence_img">ENTP_LICENCE_IMG = #entp_licence_img:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_tax_licence">ENTP_TAX_LICENCE = #entp_tax_licence:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_tax_licence_img">ENTP_TAX_LICENCE_IMG = #entp_tax_licence_img:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_org_code">ENTP_ORG_CODE = #entp_org_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="entp_org_code_img">ENTP_ORG_CODE_IMG = #entp_org_code_img:VARCHAR#</isNotEmpty>
		
		<isNotEmpty prepend=" and " property="map.entp_name_like">ENTP_NAME like '%' ||#map.entp_name_like:VARCHAR#|| '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.entp_name_not_like">ENTP_NAME not like '%' ||#map.entp_name_not_like:VARCHAR#|| '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.entp_name_lk">ENTP_NAME like '%' ||#map.entp_name_lk:VARCHAR#|| '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.user_name">
			ENTP_ID in 
				(select eu.entp_id from CHEA_FILL.STD_ENTP_USER eu where eu.MMT_USER = #map.user_name:VARCHAR#) 
		</isNotEmpty>
		
		<isNotEmpty prepend=" and " property="map.shop_id_is_not_null">SHOP_ID is not null</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.topsearch_is_not_null">(PAR_ID=0 OR ENTP_ID = ROOT_ENTP_ID)</isNotEmpty>
		
		<isNotEmpty prepend=" and " property="map.p_index">P_INDEX IN (
		select P_INDEX from CHEA_FILL.BASE_PROVINCE_LIST start with p_index=#map.p_index# connect by prior p_index=par_index
		)</isNotEmpty>
		
		<isNotEmpty prepend=" and " property="map.top_entp_id">ENTP_ID IN (
		select ENTP_ID from CHEA_FILL.STD_ENTP_MAIN start with ENTP_ID=#map.top_entp_id# connect by prior entp_id=par_id
		)</isNotEmpty>
		
	    <isNotEmpty prepend=" and " property="map.logo_is_not_null">
	    	logo is not null
	    </isNotEmpty>
	    <isNotEmpty prepend=" and " property="map.useJxcEntp">
	    	SHOP_ID in((select SHOP_ID from CHEA_FILL.JXC_SELL_BILL_DETAILS where SELL_SRC = 0))
	    </isNotEmpty>
	</sql>

	<select id="selectStdEntpMain" resultMap="stdEntpMainResult" parameterClass="stdEntpMain" >
		select * from CHEA_FILL.STD_ENTP_MAIN where 1 = 1
		<include refid="sf-stdEntpMain" />
	</select>

	<select id="selectStdEntpMainList" resultMap="stdEntpMainResultForList" parameterClass="stdEntpMain" >
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from CHEA_FILL.STD_ENTP_MAIN where 1 = 1
		<include refid="sf-stdEntpMain" />
		<!-- order by ID asc -->
		<isNotEmpty property="map.entp_name_asc">order by entp_name asc, id desc</isNotEmpty>
		<isNotEmpty property="map.entp_type_asc">order by own_sys asc, entp_type asc</isNotEmpty>
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>
	
	<!-- Li,Ka 2012-3-16  有密钥登录时查询登录网点信息和企业信息，需要合并买卖提用户和官网用户的所有数据，防止查询不到 -->
	<select id="selectStdEntpMainOrEntpShopList" resultMap="stdEntpMainOrEntpShopResultForList" parameterClass="stdEntpMain" >
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from (
			select a.entp_name,a.linkman,a.tel,a.shop_id,a.p_index,a.postcode,a.addr,a.own_sys,a.is_record,a.par_id from chea_fill.std_entp_main a 
				where 1 = 1 
				<isNotEmpty prepend=" and " property="entp_id">ENTP_ID = #entp_id:DECIMAL#</isNotEmpty>
				<isNotEmpty prepend=" and " property="map.shop_id">shop_id = #map.shop_id:DECIMAL#</isNotEmpty>
				<isNotEmpty prepend=" and " property="own_sys">OWN_SYS = #own_sys:DECIMAL#</isNotEmpty>
			union
			select e.shop_name,e.link_user,e.link_phone,e.shop_id,e.p_index,e.post_code,e.street_addr,3 as own_sys,1 as is_record,1 as par_id from entp_shop e 
				where 1 = 1 
				<isNotEmpty prepend=" and " property="entp_id">ENTP_ID = #entp_id:DECIMAL#</isNotEmpty>
				<isNotEmpty prepend=" and " property="map.shop_id">shop_id = #map.shop_id:DECIMAL#</isNotEmpty>
			)
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>
	
	<!-- 买卖商通统计使用 -->
	<select id="selectStdEntpMainListForStatisticsCount" resultClass="long" parameterClass="stdEntpMain" >
		select count (*) from (
				select t1.*
				  from (select min(sem.id) as id,
				               sem.entp_name,
				               sem.p_index,
				               min(seu.add_date) as add_date,
				               min (seu.own_sys) as own_sys ,
		                   	   min(seu.user_type) as user_type
				          from CHEA_FILL.STD_ENTP_MAIN sem,
				               (select t.entp_id, min(t.add_date) as add_date, min (t.own_sys) as own_sys, min(t.user_type) as user_type
				                  from CHEA_FILL.STD_ENTP_USER t
				                 where 1 = 1
				                   <isNotEmpty prepend=" and " property="map.is_register">t.mmt_user is not null</isNotEmpty>
				         		   <isNotEmpty prepend=" and " property="map.add_date_ge"><![CDATA[ #map.add_date_ge:VARCHAR# <= to_char(t.ADD_DATE, 'yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
						 		   <isNotEmpty prepend=" and " property="map.add_date_le"><![CDATA[ #map.add_date_le:VARCHAR# >= to_char(t.ADD_DATE, 'yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
						 		   <isNotEmpty prepend=" and " property="map.own_sys"><![CDATA[ t.own_sys = #map.own_sys:VARCHAR# ]]></isNotEmpty>
						 		   <isNotEmpty prepend=" and " property="map.user_type"><![CDATA[ t.user_type = #map.user_type:VARCHAR# ]]></isNotEmpty>
				                 group by t.entp_id) seu
				         where seu.entp_id = sem.entp_id
				         	<isNotEmpty prepend=" and " property="map.p_index_like"><![CDATA[ sem.p_index like '' ||#map.p_index_like:VARCHAR#|| '%' ]]></isNotEmpty>
				         group by sem.entp_name, sem.p_index) t1
				 order by t1.id desc	
		)
	</select>
	
	<!-- 买卖商通统计使用 -->
	<select id="selectStdEntpMainListForStatistics" resultMap="stdEntpMainResultForStatistics" parameterClass="stdEntpMain" >
	  	<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
			select t1.*
			  from (select min(sem.id) as id,
			               sem.entp_name,
			               sem.p_index,
			               min(seu.add_date) as add_date,
			               min (seu.own_sys) as own_sys ,
	                   	   min(seu.user_type) as user_type
			          from CHEA_FILL.STD_ENTP_MAIN sem,
			               (select t.entp_id, min(t.add_date) as add_date, min (t.own_sys) as own_sys, min(t.user_type) as user_type
			                  from CHEA_FILL.STD_ENTP_USER t
			                 where 1 = 1
			                   <isNotEmpty prepend=" and " property="map.is_register">t.mmt_user is not null</isNotEmpty>
			         		   <isNotEmpty prepend=" and " property="map.add_date_ge"><![CDATA[ #map.add_date_ge:VARCHAR# <= to_char(t.ADD_DATE, 'yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
					 		   <isNotEmpty prepend=" and " property="map.add_date_le"><![CDATA[ #map.add_date_le:VARCHAR# >= to_char(t.ADD_DATE, 'yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
					 		   <isNotEmpty prepend=" and " property="map.own_sys"><![CDATA[ t.own_sys = #map.own_sys:VARCHAR# ]]></isNotEmpty>
					 		   <isNotEmpty prepend=" and " property="map.user_type"><![CDATA[ t.user_type = #map.user_type:VARCHAR# ]]></isNotEmpty>
			                 group by t.entp_id) seu
			         where seu.entp_id = sem.entp_id
			         	<isNotEmpty prepend=" and " property="map.p_index_like"><![CDATA[ sem.p_index like '' ||#map.p_index_like:VARCHAR#|| '%' ]]></isNotEmpty>
			         group by sem.entp_name, sem.p_index) t1
			 order by t1.id desc	
		 <![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>	
	</select>
	
	<!-- 买卖商通统计使用 -->
	<select id="selectStdEntpMainPublishCountForStatistics" resultClass="long" parameterClass="stdEntpMain" >
		select count (*) from (
			select distinct c.entp_name,c.p_index from (
			       select t4.entp_id,2 as own_sys from (
			          select distinct t.xs_entp_id entp_id
			          		from CHEA_FILL.YJHX_ENTP_SELL t 
			         	where 1 = 1
			         	<isNotEmpty prepend=" and " property="map.add_date_ge"><![CDATA[ #map.add_date_ge:VARCHAR# <= to_char(t.XS_DATE, 'yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
					 	<isNotEmpty prepend=" and " property="map.add_date_le"><![CDATA[ #map.add_date_le:VARCHAR# >= to_char(t.XS_DATE, 'yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
			          union 
			          select distinct t1.hs_entp_id entp_id 
			          		from CHEA_FILL.YJHX_ENTP_CALLBACK t1 
			           where 1 = 1
			         	<isNotEmpty prepend=" and " property="map.add_date_ge"><![CDATA[ #map.add_date_ge:VARCHAR# <= to_char(t1.HS_INPUT_DATE, 'yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
					 	<isNotEmpty prepend=" and " property="map.add_date_le"><![CDATA[ #map.add_date_le:VARCHAR# >= to_char(t1.HS_INPUT_DATE, 'yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
			        ) t4
			        union 
			        select distinct t3.sell_entp_id entp_id,1 as own_sys
			        	from CHEA_FILL.JDXX_ENTP_SELL t3 
			          where 1 = 1
			         	<isNotEmpty prepend=" and " property="map.add_date_ge"><![CDATA[ #map.add_date_ge:VARCHAR# <= to_char(t3.SELL_DATE, 'yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
					 	<isNotEmpty prepend=" and " property="map.add_date_le"><![CDATA[ #map.add_date_le:VARCHAR# >= to_char(t3.SELL_DATE, 'yyyy-mm-dd hh24:mi:ss') ]]></isNotEmpty>
			) a,
			 CHEA_FILL.STD_ENTP_USER b  , CHEA_FILL.STD_ENTP_MAIN c 
			 where a.entp_id = b.entp_id 
			 	and a.own_sys = b.own_sys	
			 	and a.entp_id = c.entp_id	
			 	<isNotEmpty prepend=" and " property="map.is_register">b.mmt_user is not null</isNotEmpty>
			 group by c.entp_name,c.p_index	
	    )		
	</select>

	<select id="selectStdEntpMainCount" resultClass="long" parameterClass="stdEntpMain" >
		select count(id) from CHEA_FILL.STD_ENTP_MAIN where 1 = 1
		<include refid="sf-stdEntpMain" />
	</select>

	<select id="selectStdEntpMainPaginatedList" resultMap="stdEntpMainResult" parameterClass="stdEntpMain" >
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from CHEA_FILL.STD_ENTP_MAIN where 1 = 1
		<include refid="sf-stdEntpMain" />
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<!--  MMSTV2 支付功能订阅网点查询    coding by: Du,HongGang@2010.12.08-->
	<select id="selectStdEntpMainListForPay" resultMap="stdEntpMainResultForList" parameterClass="stdEntpMain" >
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select s.*
		  from CHEA_FILL.MMSTV2_ENTP_USER m
		  left join CHEA_FILL.STD_ENTP_MAIN s on s.entp_id = m.entp_id
		 where s.entp_name is not null
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>
	
	
	<!--  买卖商通页面访问统计 begin Author:Zhang,DaPeng@2010.09.25-->
<!--    <select id="selectStdMainID" resultMap="stdEntpMineID" parameterClass="stdEntpMain" >-->
<!--		select main.SHOP_ID-->
<!--		  from CHEA_FILL.STD_ENTP_MAIN main-->
<!--		  where 1 = 1-->
<!--		  <isNotEmpty prepend=" and " property="map.key_seq_ss">-->
<!--			  main.ENTP_ID =-->
<!--			       (select u.ENTP_ID-->
<!--			          from STD_ENTP_USER u-->
<!--			         where u.KEY_SEQ = #map.key_seq_ss#)-->
<!--		  </isNotEmpty>-->
<!--	</select>-->
	<!-- test end-->

	<insert id="insertStdEntpMain" parameterClass="stdEntpMain">
		<selectKey resultClass="long" keyProperty="id">select CHEA_FILL.MMT_SEQUENCE.nextval as id from dual </selectKey>
		<![CDATA[insert into CHEA_FILL.STD_ENTP_MAIN (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">ID</isNotNull>
			<isNotNull prepend="," property="entp_id">ENTP_ID</isNotNull>	
			<isNotNull prepend="," property="shop_id">SHOP_ID</isNotNull>	
			<isNotNull prepend="," property="entp_name">ENTP_NAME</isNotNull>	
			<isNotNull prepend="," property="entp_sname">ENTP_SNAME</isNotNull>	
			<isNotNull prepend="," property="entp_ename">ENTP_ENAME</isNotNull>	
			<isNotNull prepend="," property="entp_type">ENTP_TYPE</isNotNull>	
			<isNotNull prepend="," property="p_index">P_INDEX</isNotNull>	
			<isNotNull prepend="," property="c_index">C_INDEX</isNotNull>	
			<isNotNull prepend="," property="par_id">PAR_ID</isNotNull>	
			<isNotNull prepend="," property="root_entp_id">ROOT_ENTP_ID</isNotNull>	
			<isNotNull prepend="," property="main_pd">MAIN_PD</isNotNull>	
			<isNotNull prepend="," property="entp_kind">ENTP_KIND</isNotNull>	
			<isNotNull prepend="," property="entp_size">ENTP_SIZE</isNotNull>	
			<isNotNull prepend="," property="entp_licence">ENTP_LICENCE</isNotNull>	
			<isNotNull prepend="," property="corporation">CORPORATION</isNotNull>	
			<isNotNull prepend="," property="addr">ADDR</isNotNull>	
			<isNotNull prepend="," property="postcode">POSTCODE</isNotNull>	
			<isNotNull prepend="," property="linkman">LINKMAN</isNotNull>	
			<isNotNull prepend="," property="tel">TEL</isNotNull>	
			<isNotNull prepend="," property="fax">FAX</isNotNull>	
			<isNotNull prepend="," property="email">EMAIL</isNotNull>	
			<isNotNull prepend="," property="www">WWW</isNotNull>	
			<isNotNull prepend="," property="is_record">IS_RECORD</isNotNull>	
			<isNotNull prepend="," property="sq_serial">SQ_SERIAL</isNotNull>	
			<isNotNull prepend="," property="single_callback">SINGLE_CALLBACK</isNotNull>	
			<isNotNull prepend="," property="adv_pay_sign">ADV_PAY_SIGN</isNotNull>	
			<isNotNull prepend="," property="own_sys">OWN_SYS</isNotNull>	
			<isNotNull prepend="," property="info_state">INFO_STATE</isNotNull>	
			<isNotNull prepend="," property="logo">LOGO</isNotNull>	
			<isNotNull prepend="," property="entp_licence_img">ENTP_LICENCE_IMG</isNotNull>	
			<isNotNull prepend="," property="entp_tax_licence">ENTP_TAX_LICENCE</isNotNull>	
			<isNotNull prepend="," property="entp_tax_licence_img">ENTP_TAX_LICENCE_IMG</isNotNull>	
			<isNotNull prepend="," property="entp_org_code">ENTP_ORG_CODE</isNotNull>	
			<isNotNull prepend="," property="entp_org_code_img">ENTP_ORG_CODE_IMG</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">#id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_id">#entp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="shop_id">#shop_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_name">#entp_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_sname">#entp_sname:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_ename">#entp_ename:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_type">#entp_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="p_index">#p_index:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="c_index">#c_index:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="par_id">#par_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="root_entp_id">#root_entp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="main_pd">#main_pd:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_kind">#entp_kind:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_size">#entp_size:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_licence">#entp_licence:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="corporation">#corporation:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="addr">#addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="postcode">#postcode:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="linkman">#linkman:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="tel">#tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fax">#fax:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="email">#email:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="www">#www:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="is_record">#is_record:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sq_serial">#sq_serial:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="single_callback">#single_callback:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="adv_pay_sign">#adv_pay_sign:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="own_sys">#own_sys:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="info_state">#info_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="logo">#logo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_licence_img">#entp_licence_img:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_tax_licence">#entp_tax_licence:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_tax_licence_img">#entp_tax_licence_img:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_org_code">#entp_org_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_org_code_img">#entp_org_code_img:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateStdEntpMain" parameterClass="StdEntpMain">
		update CHEA_FILL.STD_ENTP_MAIN
		<dynamic prepend="set">
			<isNotNull prepend="," property="id">ID = #id:DECIMAL#</isNotNull>	
			<isNotNull prepend="," property="entp_id">ENTP_ID = #entp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="shop_id">SHOP_ID = #shop_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_name">ENTP_NAME = #entp_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_sname">ENTP_SNAME = #entp_sname:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_ename">ENTP_ENAME = #entp_ename:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_type">ENTP_TYPE = #entp_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="p_index">P_INDEX = #p_index:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="c_index">C_INDEX = #c_index:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="par_id">PAR_ID = #par_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="root_entp_id">ROOT_ENTP_ID = #root_entp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="main_pd">MAIN_PD = #main_pd:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_kind">ENTP_KIND = #entp_kind:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="entp_size">ENTP_SIZE = #entp_size:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_licence">ENTP_LICENCE = #entp_licence:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="corporation">CORPORATION = #corporation:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="addr">ADDR = #addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="postcode">POSTCODE = #postcode:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="linkman">LINKMAN = #linkman:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="tel">TEL = #tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fax">FAX = #fax:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="email">EMAIL = #email:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="www">WWW = #www:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="is_record">IS_RECORD = #is_record:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sq_serial">SQ_SERIAL = #sq_serial:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="single_callback">SINGLE_CALLBACK = #single_callback:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="adv_pay_sign">ADV_PAY_SIGN = #adv_pay_sign:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="own_sys">OWN_SYS = #own_sys:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="info_state">INFO_STATE = #info_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="logo">LOGO = #logo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_licence_img">ENTP_LICENCE_IMG = #entp_licence_img:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_tax_licence">ENTP_TAX_LICENCE = #entp_tax_licence:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_tax_licence_img">ENTP_TAX_LICENCE_IMG = #entp_tax_licence_img:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_org_code">ENTP_ORG_CODE = #entp_org_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="entp_org_code_img">ENTP_ORG_CODE_IMG = #entp_org_code_img:VARCHAR#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="id">ID = #id:DECIMAL# and entp_id = #entp_id:DECIMAL# and own_sys = #own_sys:DECIMAL#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteStdEntpMain" parameterClass="StdEntpMain">
		update CHEA_FILL.STD_ENTP_MAIN set INFO_STATE = 1 where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>
	
	<!-- 买卖商通公测版测试使用，慎用 -->
	<delete id="deleteStdEntpMainForMmst" parameterClass="StdEntpMain">
		delete from CHEA_FILL.STD_ENTP_MAIN t1 where t1.entp_id = #entp_id:DECIMAL# and t1.own_sys = #own_sys:DECIMAL#
	</delete>
	
</sqlMap>