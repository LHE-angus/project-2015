<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KONKA_XX_SELL_BILL_DETAILS_DST">

	<typeAlias alias="konkaXxSellBillDetailsDst" type="com.ebiz.mmt.domain.KonkaXxSellBillDetailsDst" />

	

	<resultMap id="konkaXxSellBillDetailsDstResultForList" class="konkaXxSellBillDetailsDst">
		<result column="PD_DIST_ID" property="pd_dist_id" jdbcType="DECIMAL" />
		<result column="SELL_BILL_DETAILS_ID" property="sell_bill_details_id" jdbcType="DECIMAL" />
		<result column="SELL_BILL_ID" property="sell_bill_id" jdbcType="DECIMAL" />
		<result column="PD_CLS_NAME" property="pd_cls_name" jdbcType="VARCHAR" />
		<result column="MD_NAME" property="md_name" jdbcType="VARCHAR" />
		<result column="FACTORY_ID" property="factory_id" jdbcType="VARCHAR" />
		<result column="STORE_ID" property="store_id" jdbcType="VARCHAR" />
		<result column="STORE_NAME" property="store_name" jdbcType="VARCHAR" />
		<result column="COUNTS" property="counts" jdbcType="DECIMAL" />
		<result column="DST_REMARKS" property="dst_remarks" jdbcType="VARCHAR" />
		<result column="DST_DATE" property="dst_date" jdbcType="DATETIME" />
		<result column="DST_USER_ID" property="dst_user_id" jdbcType="DECIMAL" />
		<result column="DST_USER_NAME" property="dst_user_name" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="konkaXxSellBillDetailsDstResult" class="konkaXxSellBillDetailsDst" extends="konkaXxSellBillDetailsDstResultForList">
	</resultMap>

	<sql id="sf-konkaXxSellBillDetailsDst">
		<isNotEmpty prepend=" and " property="pd_dist_id">PD_DIST_ID = #pd_dist_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sell_bill_details_id">SELL_BILL_DETAILS_ID = #sell_bill_details_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sell_bill_id">SELL_BILL_ID = #sell_bill_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="pd_cls_name">PD_CLS_NAME = #pd_cls_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="md_name">MD_NAME = #md_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="factory_id">FACTORY_ID = #factory_id:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="store_id">STORE_ID = #store_id:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="store_name">STORE_NAME = #store_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="counts">COUNTS = #counts:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dst_remarks">DST_REMARKS = #dst_remarks:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dst_date">DST_DATE = #dst_date:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dst_user_id">DST_USER_ID = #dst_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dst_user_name">DST_USER_NAME = #dst_user_name:VARCHAR#</isNotEmpty>
	</sql>

	<select id="selectKonkaXxSellBillDetailsDst" resultMap="konkaXxSellBillDetailsDstResult" parameterClass="konkaXxSellBillDetailsDst" >
		select * from KONKA_XX_SELL_BILL_DETAILS_DST where 1 = 1
		<include refid="sf-konkaXxSellBillDetailsDst" />
	</select>

	<select id="selectKonkaXxSellBillDetailsDstList" resultMap="konkaXxSellBillDetailsDstResultForList" parameterClass="konkaXxSellBillDetailsDst" >
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from KONKA_XX_SELL_BILL_DETAILS_DST where 1 = 1
		<include refid="sf-konkaXxSellBillDetailsDst" />
		<!-- order by ID asc -->
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectKonkaXxSellBillDetailsDstCount" resultClass="long" parameterClass="konkaXxSellBillDetailsDst" >
		select count(*) from KONKA_XX_SELL_BILL_DETAILS_DST where 1 = 1
		<include refid="sf-konkaXxSellBillDetailsDst" />
	</select>

	<select id="selectKonkaXxSellBillDetailsDstPaginatedList" resultMap="konkaXxSellBillDetailsDstResult" parameterClass="konkaXxSellBillDetailsDst" >
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from KONKA_XX_SELL_BILL_DETAILS_DST where 1 = 1
		<include refid="sf-konkaXxSellBillDetailsDst" />
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<!-- 打印出库单， Ren zhong， 2012-04-09，Begin -->
	<resultMap id="konkaXxSellBillDetailsDstForPrintOutOrdersResult"  class="konkaXxSellBillDetailsDst" extends="konkaXxSellBillDetailsDstResult">
		<result column="SPEC" property="map.spec" jdbcType="VARCHAR" />
		<result column="PRICE" property="map.price" jdbcType="DECIMAL" />
	</resultMap>
	
	<select id="selectKonkaXxSellBillDetailsDstForPrintOutOrders" resultMap="konkaXxSellBillDetailsDstForPrintOutOrdersResult" parameterClass="konkaXxSellBillDetailsDst" >
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select t.*, pd.spec, d.price
		  from (select * from KONKA_XX_SELL_BILL_DETAILS_DST) t 
		  left join KONKA_XX_STD_PD pd on t.md_name = pd.md_name
		  left join KONKA_XX_SELL_BILL_DETAILS d on d.sell_bill_details_id = t.sell_bill_details_id
		 where 1 = 1
		 <isNotEmpty prepend=" and " property="sell_bill_id">t.SELL_BILL_ID = #sell_bill_id:DECIMAL#</isNotEmpty>
		order by  FACTORY_ID, STORE_ID
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>
	<!-- 打印出库单， Ren zhong， 2012-04-09，End -->

	<insert id="insertKonkaXxSellBillDetailsDst" parameterClass="konkaXxSellBillDetailsDst">
		<selectKey resultClass="long" keyProperty="pd_dist_id">select KONKA_XX_BASE_SEQ.nextval as PD_DIST_ID from dual </selectKey>
		<![CDATA[insert into KONKA_XX_SELL_BILL_DETAILS_DST (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="pd_dist_id">PD_DIST_ID</isNotNull>	
			<isNotNull prepend="," property="sell_bill_details_id">SELL_BILL_DETAILS_ID</isNotNull>	
			<isNotNull prepend="," property="sell_bill_id">SELL_BILL_ID</isNotNull>	
			<isNotNull prepend="," property="pd_cls_name">PD_CLS_NAME</isNotNull>	
			<isNotNull prepend="," property="md_name">MD_NAME</isNotNull>	
			<isNotNull prepend="," property="factory_id">FACTORY_ID</isNotNull>	
			<isNotNull prepend="," property="store_id">STORE_ID</isNotNull>	
			<isNotNull prepend="," property="store_name">STORE_NAME</isNotNull>	
			<isNotNull prepend="," property="counts">COUNTS</isNotNull>	
			<isNotNull prepend="," property="dst_remarks">DST_REMARKS</isNotNull>	
			<isNotNull prepend="," property="dst_date">DST_DATE</isNotNull>	
			<isNotNull prepend="," property="dst_user_id">DST_USER_ID</isNotNull>	
			<isNotNull prepend="," property="dst_user_name">DST_USER_NAME</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="pd_dist_id">#pd_dist_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sell_bill_details_id">#sell_bill_details_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sell_bill_id">#sell_bill_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="pd_cls_name">#pd_cls_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="md_name">#md_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="factory_id">#factory_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="store_id">#store_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="store_name">#store_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="counts">#counts:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="dst_remarks">#dst_remarks:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="dst_date">#dst_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="dst_user_id">#dst_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="dst_user_name">#dst_user_name:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateKonkaXxSellBillDetailsDst" parameterClass="KonkaXxSellBillDetailsDst">
		update KONKA_XX_SELL_BILL_DETAILS_DST
		<dynamic prepend="set">
			<isNotNull prepend="," property="pd_dist_id">PD_DIST_ID = #pd_dist_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sell_bill_details_id">SELL_BILL_DETAILS_ID = #sell_bill_details_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sell_bill_id">SELL_BILL_ID = #sell_bill_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="pd_cls_name">PD_CLS_NAME = #pd_cls_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="md_name">MD_NAME = #md_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="factory_id">FACTORY_ID = #factory_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="store_id">STORE_ID = #store_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="store_name">STORE_NAME = #store_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="counts">COUNTS = #counts:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="dst_remarks">DST_REMARKS = #dst_remarks:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="dst_date">DST_DATE = #dst_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="dst_user_id">DST_USER_ID = #dst_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="dst_user_name">DST_USER_NAME = #dst_user_name:VARCHAR#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteKonkaXxSellBillDetailsDst" parameterClass="KonkaXxSellBillDetailsDst">
		delete from KONKA_XX_SELL_BILL_DETAILS_DST where
		<isNotEmpty prepend=" " property="pd_dist_id">PD_DIST_ID = #pd_dist_id#</isNotEmpty>
		<isEmpty prepend=" " property="pd_dist_id">
			<isNotEmpty prepend=" " property="map.pks">
				PD_DIST_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
		<isNotEmpty prepend=" " property="sell_bill_details_id">SELL_BILL_DETAILS_ID = #sell_bill_details_id#</isNotEmpty>
		<isNotEmpty prepend=" " property="sell_bill_id">SELL_BILL_ID = #sell_bill_id#</isNotEmpty>
	</delete>

</sqlMap>