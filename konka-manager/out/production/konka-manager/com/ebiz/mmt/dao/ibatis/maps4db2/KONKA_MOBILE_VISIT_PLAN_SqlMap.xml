<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KONKA_MOBILE_VISIT_PLAN">

	<typeAlias alias="konkaMobileVisitPlan" type="com.ebiz.mmt.domain.KonkaMobileVisitPlan" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertKonkaMobileVisitPlan" />
		<flushOnExecute statement="updateKonkaMobileVisitPlan" />
		<flushOnExecute statement="deleteKonkaMobileVisitPlan" />
	</cacheModel>

	<resultMap id="konkaMobileVisitPlanResultForList" class="konkaMobileVisitPlan">
		<result column="PLAN_ID" property="plan_id" jdbcType="DECIMAL" />
		<result column="PLAN_TYPE" property="plan_type" jdbcType="DECIMAL" />
		<result column="PLAN_BEGIN_DATE" property="plan_begin_date" jdbcType="TIMESTAMP" />
		<result column="PLAN_END_DATE" property="plan_end_date" jdbcType="TIMESTAMP" />
		<result column="REPORT_NAE" property="report_nae" jdbcType="VARCHAR" />
		<result column="DATA_SOURCE" property="data_source" jdbcType="DECIMAL" />
		<result column="ADD_DATE" property="add_date" jdbcType="TIMESTAMP" />
		<result column="YWY_JOB_ID" property="ywy_job_id" jdbcType="VARCHAR" />
		<result column="DEPT_ID" property="dept_id" jdbcType="DECIMAL" />
		<result column="SUBCOMP_ID" property="subcomp_id" jdbcType="DECIMAL" />
		<result column="IS_DEL" property="is_del" jdbcType="DECIMAL" />
		<result column="ADD_USER_ID" property="add_user_id" jdbcType="DECIMAL" />
		<result column="PLAN_OF_ACCESS" property="plan_of_access" jdbcType="DECIMAL" />
		<result column="PLAN_OF_ACCESS_CUST" property="plan_of_access_cust" jdbcType="DECIMAL" />
		<result column="PLAN_OF_DEV_CUST" property="plan_of_dev_cust" jdbcType="DECIMAL" />
		<result column="PLAN_TASK_MONEY" property="plan_task_money" jdbcType="DECIMAL" />
		<result column="PLAN_TASK_COUNT" property="plan_task_count" jdbcType="DECIMAL" />
		<result column="PLAN_OF_ACCESS_SHOP" property="plan_of_access_shop" jdbcType="DECIMAL" />
		<result column="PLAN_DESC" property="plan_desc" jdbcType="VARCHAR" />
		<result column="REMARK" property="remark" jdbcType="VARCHAR" />
		<result column="UPDATE_USER_ID" property="update_user_id" jdbcType="DECIMAL" />
		<result column="UPDATE_DATE" property="update_date" jdbcType="TIMESTAMP" />
	</resultMap>

	<resultMap id="konkaMobileVisitPlanResult" class="konkaMobileVisitPlan" extends="konkaMobileVisitPlanResultForList">
	</resultMap>
	
	<resultMap id="konkaMobileVisitPlanLBResult" class="konkaMobileVisitPlan" extends="konkaMobileVisitPlanResultForList">
		<result column="customer_ids" property="map.customer_ids" jdbcType="VARCHAR" />
		<result column="shop_ids" property="map.shop_ids" jdbcType="VARCHAR" />
		<result column="customer_names" property="map.customer_names" jdbcType="VARCHAR" />
		<result column="shop_names" property="map.shop_names" jdbcType="VARCHAR" />
		<result column="dept_name" property="map.dept_name" jdbcType="VARCHAR" />
		<result column="subcomp_name" property="map.subcomp_name" jdbcType="VARCHAR" />
		<result column="up_name" property="map.up_name" jdbcType="VARCHAR" />
		<result column="up_time" property="map.up_time" jdbcType="TIMESTAMP" />
	</resultMap>

	<sql id="sf-konkaMobileVisitPlan">
		<isNotEmpty prepend=" and " property="plan_id">PLAN_ID = #plan_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_type">PLAN_TYPE = #plan_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_begin_date">PLAN_BEGIN_DATE = #plan_begin_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_end_date">PLAN_END_DATE = #plan_end_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="report_nae">REPORT_NAE = #report_nae:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="data_source">DATA_SOURCE = #data_source:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="ywy_job_id">YWY_JOB_ID = #ywy_job_id:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dept_id">DEPT_ID = #dept_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="subcomp_id">SUBCOMP_ID = #subcomp_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">ADD_USER_ID = #add_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_of_access">PLAN_OF_ACCESS = #plan_of_access:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_of_access_cust">PLAN_OF_ACCESS_CUST = #plan_of_access_cust:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_of_dev_cust">PLAN_OF_DEV_CUST = #plan_of_dev_cust:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_task_money">PLAN_TASK_MONEY = #plan_task_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_task_count">PLAN_TASK_COUNT = #plan_task_count:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_of_access_shop">PLAN_OF_ACCESS_SHOP = #plan_of_access_shop:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_desc">PLAN_DESC = #plan_desc:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="remark">REMARK = #remark:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="update_user_id">UPDATE_USER_ID = #update_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="update_date">UPDATE_DATE = #update_date:TIMESTAMP#</isNotEmpty>
	</sql>
	<sql id="sf-konkaMobileVisitPlanLB">
		<isNotEmpty prepend=" and " property="plan_id">a.PLAN_ID = #plan_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_type">a.PLAN_TYPE = #plan_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_begin_date">a.PLAN_BEGIN_DATE = #plan_begin_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_end_date">a.PLAN_END_DATE = #plan_end_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="report_nae">a.REPORT_NAE = #report_nae:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="data_source">a.DATA_SOURCE = #data_source:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">a.ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="ywy_job_id">a.YWY_JOB_ID = #ywy_job_id:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dept_id">a.DEPT_ID = #dept_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="subcomp_id">a.SUBCOMP_ID = #subcomp_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">a.IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">a.ADD_USER_ID = #add_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_of_access">a.PLAN_OF_ACCESS = #plan_of_access:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_of_access_cust">a.PLAN_OF_ACCESS_CUST = #plan_of_access_cust:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_of_dev_cust">a.PLAN_OF_DEV_CUST = #plan_of_dev_cust:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_task_money">a.PLAN_TASK_MONEY = #plan_task_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_task_count">a.PLAN_TASK_COUNT = #plan_task_count:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_of_access_shop">a.PLAN_OF_ACCESS_SHOP = #plan_of_access_shop:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="plan_desc">a.PLAN_DESC = #plan_desc:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="remark">a.REMARK = #remark:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="update_user_id">a.UPDATE_USER_ID = #update_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="update_date">a.UPDATE_DATE = #update_date:TIMESTAMP#</isNotEmpty>
		
		<isNotEmpty prepend=" and " property="map.report_nae_like">a.REPORT_NAE like '%' || #map.report_nae_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.subcomp_name_like">a.SUBCOMP_ID in (select dept_id from KONKA_DEPT where  dept_name like '%' || #map.subcomp_name_like:VARCHAR# || '%')</isNotEmpty>
		
		
		
		<!--<isNotEmpty prepend=" and " property="map.r3_code">y.R3_CODE = #map.r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.shop_id">y.SHOP_ID = #map.shop_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.time_start"><![CDATA[ a.PLAN_BEGIN_DATE >= to_date(#map.time_start#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
	    <isNotEmpty prepend=" and " property="map.time_end"><![CDATA[ a.PLAN_END_DATE <= to_date(#map.time_end#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
	--></sql>

	<select id="selectKonkaMobileVisitPlan" resultMap="konkaMobileVisitPlanResult" parameterClass="konkaMobileVisitPlan" cacheModel="oneDayCache">
		select * from KONKA_MOBILE_VISIT_PLAN where 1 = 1
		<include refid="sf-konkaMobileVisitPlan" />
	</select>

	<select id="selectKonkaMobileVisitPlanList" resultMap="konkaMobileVisitPlanResultForList" parameterClass="konkaMobileVisitPlan" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from KONKA_MOBILE_VISIT_PLAN where 1 = 1
		<include refid="sf-konkaMobileVisitPlan" />
		<!-- order by ID asc -->
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectKonkaMobileVisitPlanCount" resultClass="long" parameterClass="konkaMobileVisitPlan" cacheModel="oneDayCache">
		select count(*) from KONKA_MOBILE_VISIT_PLAN where 1 = 1
		<include refid="sf-konkaMobileVisitPlan" />
	</select>
	<!-- 查找当指定年月是否做过计划 -->
	<select id="selectCurrentMonthVisitCount" resultClass="long" parameterClass="konkaMobileVisitPlan" cacheModel="oneDayCache">
            select count(*) from KONKA_MOBILE_VISIT_PLAN where 1=1
            <isNotEmpty prepend=" and " property="map.add_user_id">
                      ADD_USER_ID = #map.add_user_id:DECIMAL#
            </isNotEmpty>
            <isNotEmpty prepend=" and " property="map.beginStr">
                      <![CDATA[ PLAN_BEGIN_DATE >= to_date(#map.beginStr#,'yyyy-MM-dd hh24:mi:ss') ]]>
            </isNotEmpty>
		    <isNotEmpty prepend=" and " property="map.endStr">
		         <![CDATA[ PLAN_END_DATE <= to_date(#map.endStr#,'yyyy-MM-dd hh24:mi:ss') ]]>
		    </isNotEmpty>
	</select>
	<select id="selectKonkaMobileVisitPlanLBCount" resultClass="long" parameterClass="konkaMobileVisitPlan" cacheModel="oneDayCache">
		select count(*) from konka_mobile_visit_plan a
		  left join KONKA_DEPT d on a.DEPT_ID=d.DEPT_ID
		  left join KONKA_DEPT e on a.SUBCOMP_ID=e.DEPT_ID
		  where 1=1
		 <isNotEmpty prepend=" and " property="map.cust_shop">
		  a.plan_id in(
		       select distinct plan_id from konka_mobile_visit_plan_detail y where 1=1 and (
		       	<isNotEmpty prepend="  " property="map.r3_code">y.R3_CODE = #map.r3_code:VARCHAR#
		       	
		       	<isNotEmpty prepend=" or " property="map.shop_id">y.SHOP_ID = #map.shop_id:DECIMAL#</isNotEmpty>
		       	</isNotEmpty>
		       	<isEmpty prepend="  " property="map.r3_code">
		        <isNotEmpty prepend="  " property="map.shop_id">y.SHOP_ID = #map.shop_id:DECIMAL#</isNotEmpty>
		        </isEmpty>
		        
		        
		  ))
		  </isNotEmpty>
		  <isNotEmpty prepend=" and " property="map.shop_cust">
		  a.plan_id in(
		       select distinct plan_id from konka_mobile_visit_plan_detail y where 1=1 
		       	<isNotEmpty prepend=" and " property="map.r3_code">y.R3_CODE = #map.r3_code:VARCHAR#</isNotEmpty>
		        <isNotEmpty prepend=" and " property="map.shop_id">y.SHOP_ID = #map.shop_id:DECIMAL#</isNotEmpty>
		   )
		  </isNotEmpty>
		  <isNotEmpty prepend=" and " property="map.time_start"><![CDATA[ a.PLAN_BEGIN_DATE >= to_date(#map.time_start#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
	      <isNotEmpty prepend=" and " property="map.time_end"><![CDATA[ a.PLAN_END_DATE <= to_date(#map.time_end#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
		
		<include refid="sf-konkaMobileVisitPlanLB" />
		 <isNotEmpty prepend=" and " property="map.dept_id_start">
			(a.dept_id in (
						select dept_id from konka_dept start with dept_id in (
						SELECT DISTINCT (dept_id)
		  							FROM KONKA_ROLE_DATA_LEVEL
		 							WHERE role_id IN (SELECT role_id
		                     			FROM KONKA_PE_ROLE_USER
		                    			WHERE user_id = #map.session_user_id:DECIMAL#)
						) or dept_id = #map.dept_id_start# 
						connect by prior dept_id = par_id 
					)
			)
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">
			a.add_user_id = #map.filter_by_ywy_id_eq#
		</isNotEmpty> 
	</select>
	<select id="selectKonkaMobileVisitPlanPaginatedList" resultMap="konkaMobileVisitPlanResult" parameterClass="konkaMobileVisitPlan" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from KONKA_MOBILE_VISIT_PLAN where 1 = 1
		<include refid="sf-konkaMobileVisitPlan" />
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<select id="selectKonkaMobileVisitPlanLBPaginatedList" resultMap="konkaMobileVisitPlanLBResult" parameterClass="konkaMobileVisitPlan" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		SELECT a.*,
		z.customer_ids,
	       z.customer_names,
	       z.shop_ids,
	       z.shop_names,
	       (select listagg(f2.shop_name, ',') within group (order by f2.plan_id)
			  from konka_mobile_visit_plan_detail f2
			  where f2.plan_id=a.plan_id
			  group by
			  plan_id ) shop_names,
			  d.dept_name dept_name,e.dept_name subcomp_name,
			  (select operlog.OPER_UNAME from KONKA_SX_OPER_LOG operlog where rownum=1 and operlog.LINK_TAB='KONKA_MOBILE_VISIT_PLAN' AND a.PLAN_ID=operlog.LINK_ID order by operlog.OPER_TIME)up_name,
              (select operlog.OPER_TIME from KONKA_SX_OPER_LOG operlog where rownum=1 and operlog.LINK_TAB='KONKA_MOBILE_VISIT_PLAN' AND  a.PLAN_ID=operlog.LINK_ID order by operlog.OPER_TIME)up_time
		  FROM konka_mobile_visit_plan a
		  left join (
				select plan_id,listagg(R3_code,',') as customer_ids,
				        listagg(customer_name, ',') as customer_names,
				        listagg(decode(customer_type,10,shop_id||'191919',shop_id),',') as shop_ids,
				  listagg(shop_name,',') as shop_names
				from konka_mobile_visit_plan_detail
				group by plan_id
				
				) z
				on a.plan_id=z.plan_id
		  left join KONKA_DEPT d on a.DEPT_ID=d.DEPT_ID
		  left join KONKA_DEPT e on a.SUBCOMP_ID=e.DEPT_ID
		  where 1=1
		  <isNotEmpty prepend=" and " property="map.cust_shop">
		  a.plan_id in(
		       select distinct plan_id from konka_mobile_visit_plan_detail y where 1=1 and (
		      <isNotEmpty prepend="  " property="map.r3_code">y.R3_CODE = #map.r3_code:VARCHAR#
		       	
		       	<isNotEmpty prepend=" or " property="map.shop_id">y.SHOP_ID = #map.shop_id:DECIMAL#</isNotEmpty>
		       	</isNotEmpty>
		       	<isEmpty prepend="  " property="map.r3_code">
		        <isNotEmpty prepend="  " property="map.shop_id">y.SHOP_ID = #map.shop_id:DECIMAL#</isNotEmpty>
		        </isEmpty>))
		  </isNotEmpty>
		  <isNotEmpty prepend=" and " property="map.shop_cust">
		  a.plan_id in(
		       select distinct plan_id from konka_mobile_visit_plan_detail y where 1=1 
		       	<isNotEmpty prepend=" and " property="map.r3_code">y.R3_CODE = #map.r3_code:VARCHAR#</isNotEmpty>
		        <isNotEmpty prepend=" and " property="map.shop_id">y.SHOP_ID = #map.shop_id:DECIMAL#</isNotEmpty>
		   )
		  </isNotEmpty>
		  <isNotEmpty prepend=" and " property="map.time_start"><![CDATA[ a.PLAN_BEGIN_DATE >= to_date(#map.time_start#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
	      <isNotEmpty prepend=" and " property="map.time_end"><![CDATA[ a.PLAN_END_DATE <= to_date(#map.time_end#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
		
		<include refid="sf-konkaMobileVisitPlanLB" />
		
			 <isNotEmpty prepend=" and " property="map.dept_id_start">
			(a.dept_id in (
						select dept_id from konka_dept start with dept_id in (
						SELECT DISTINCT (dept_id)
		  							FROM KONKA_ROLE_DATA_LEVEL
		 							WHERE role_id IN (SELECT role_id
		                     			FROM KONKA_PE_ROLE_USER
		                    			WHERE user_id = #map.session_user_id:DECIMAL#)
						) or dept_id = #map.dept_id_start# 
						connect by prior dept_id = par_id 
					)
			)
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">
			a.add_user_id = #map.filter_by_ywy_id_eq#
		</isNotEmpty> 
		
		
		
		order by a.PLAN_BEGIN_DATE desc
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<insert id="insertKonkaMobileVisitPlan" parameterClass="konkaMobileVisitPlan">
		<selectKey resultClass="long" keyProperty="plan_id">select BASE_MESSAGE_SEQ.nextval as plan_id from dual </selectKey>
		<![CDATA[insert into KONKA_MOBILE_VISIT_PLAN (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="plan_id">PLAN_ID</isNotNull>	
			<isNotNull prepend="," property="plan_type">PLAN_TYPE</isNotNull>	
			<isNotNull prepend="," property="plan_begin_date">PLAN_BEGIN_DATE</isNotNull>	
			<isNotNull prepend="," property="plan_end_date">PLAN_END_DATE</isNotNull>	
			<isNotNull prepend="," property="report_nae">REPORT_NAE</isNotNull>	
			<isNotNull prepend="," property="data_source">DATA_SOURCE</isNotNull>	
			<isNotNull prepend="," property="add_date">ADD_DATE</isNotNull>	
			<isNotNull prepend="," property="ywy_job_id">YWY_JOB_ID</isNotNull>	
			<isNotNull prepend="," property="dept_id">DEPT_ID</isNotNull>	
			<isNotNull prepend="," property="subcomp_id">SUBCOMP_ID</isNotNull>	
			<isNotNull prepend="," property="is_del">IS_DEL</isNotNull>	
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID</isNotNull>	
			<isNotNull prepend="," property="plan_of_access">PLAN_OF_ACCESS</isNotNull>	
			<isNotNull prepend="," property="plan_of_access_cust">PLAN_OF_ACCESS_CUST</isNotNull>	
			<isNotNull prepend="," property="plan_of_dev_cust">PLAN_OF_DEV_CUST</isNotNull>	
			<isNotNull prepend="," property="plan_task_money">PLAN_TASK_MONEY</isNotNull>	
			<isNotNull prepend="," property="plan_task_count">PLAN_TASK_COUNT</isNotNull>
			<isNotNull prepend="," property="plan_of_access_shop">PLAN_OF_ACCESS_SHOP</isNotNull>	
			<isNotNull prepend="," property="plan_desc">PLAN_DESC</isNotNull>		
			<isNotNull prepend="," property="remark">REMARK</isNotNull>	
			<isNotNull prepend="," property="update_user_id">UPDATE_USER_ID</isNotNull>	
			<isNotNull prepend="," property="update_date">UPDATE_DATE</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="plan_id">#plan_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_type">#plan_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_begin_date">#plan_begin_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="plan_end_date">#plan_end_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="report_nae">#report_nae:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="data_source">#data_source:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_date">#add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="ywy_job_id">#ywy_job_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="dept_id">#dept_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="subcomp_id">#subcomp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_del">#is_del:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_user_id">#add_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_of_access">#plan_of_access:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_of_access_cust">#plan_of_access_cust:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_of_dev_cust">#plan_of_dev_cust:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_task_money">#plan_task_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_task_count">#plan_task_count:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_of_access_shop">#plan_of_access_shop:DECIMAL#</isNotNull>		
			<isNotNull prepend="," property="plan_desc">#plan_desc:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="remark">#remark:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="update_user_id">#update_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="update_date">#update_date:TIMESTAMP#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateKonkaMobileVisitPlan" parameterClass="KonkaMobileVisitPlan">
		update KONKA_MOBILE_VISIT_PLAN
		<dynamic prepend="set">
			<isNotNull prepend="," property="plan_id">PLAN_ID = #plan_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_type">PLAN_TYPE = #plan_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_begin_date">PLAN_BEGIN_DATE = #plan_begin_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="plan_end_date">PLAN_END_DATE = #plan_end_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="report_nae">REPORT_NAE = #report_nae:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="data_source">DATA_SOURCE = #data_source:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="ywy_job_id">YWY_JOB_ID = #ywy_job_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="dept_id">DEPT_ID = #dept_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="subcomp_id">SUBCOMP_ID = #subcomp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="is_del">IS_DEL = #is_del:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID = #add_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_of_access">PLAN_OF_ACCESS = #plan_of_access:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_of_access_cust">PLAN_OF_ACCESS_CUST = #plan_of_access_cust:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_of_dev_cust">PLAN_OF_DEV_CUST = #plan_of_dev_cust:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_task_money">PLAN_TASK_MONEY = #plan_task_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_task_count">PLAN_TASK_COUNT = #plan_task_count:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_of_access_shop">PLAN_OF_ACCESS_SHOP = #plan_of_access_shop:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="plan_desc">PLAN_DESC = #plan_desc:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="remark">REMARK = #remark:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="update_user_id">UPDATE_USER_ID = #update_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="update_date">UPDATE_DATE = #update_date:TIMESTAMP#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="plan_id">PLAN_ID = #plan_id#</isNotEmpty>
		<isEmpty prepend=" " property="plan_id">
			<isNotEmpty prepend=" " property="map.pks">
				PLAN_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteKonkaMobileVisitPlan" parameterClass="KonkaMobileVisitPlan">
		delete from KONKA_MOBILE_VISIT_PLAN where
		<isNotEmpty prepend=" " property="plan_id">PLAN_ID = #plan_id#</isNotEmpty>
		<isEmpty prepend=" " property="plan_id">
			<isNotEmpty prepend=" " property="map.pks">
				PLAN_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

</sqlMap>