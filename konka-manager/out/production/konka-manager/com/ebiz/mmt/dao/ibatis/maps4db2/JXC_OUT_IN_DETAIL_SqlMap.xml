<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="JXC_OUT_IN_DETAIL">

	<typeAlias alias="jxcOutInDetail" type="com.ebiz.mmt.domain.JxcOutInDetail" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertJxcOutInDetail" />
		<flushOnExecute statement="updateJxcOutInDetail" />
		<flushOnExecute statement="deleteJxcOutInDetail" />
	</cacheModel>

	<resultMap id="jxcOutInDetailResultForList" class="jxcOutInDetail">
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="OUT_R3_CODE" property="out_r3_code" jdbcType="VARCHAR" />
		<result column="OUT_STORE_ID" property="out_store_id" jdbcType="DECIMAL" />
		<result column="IN_R3_CODE" property="in_r3_code" jdbcType="VARCHAR" />
		<result column="IN_STORE_ID" property="in_store_id" jdbcType="DECIMAL" />
		<result column="OUT_GOODS_ID" property="out_goods_id" jdbcType="DECIMAL" />
		<result column="IN_GOODS_ID" property="in_goods_id" jdbcType="DECIMAL" />
		<result column="IN_NUM" property="in_num" jdbcType="DECIMAL" />
		<result column="OUT_DATE" property="out_date" jdbcType="TIMESTAMP" />
		<result column="STATE" property="state" jdbcType="DECIMAL" />
		<result column="GOODS_NAME" property="goods_name" jdbcType="VARCHAR" />
		<result column="SUBCOMP_ID" property="subcomp_id" jdbcType="DECIMAL" />
		<result column="CONFIRM_DATE" property="confirm_date" jdbcType="TIMESTAMP" />
		<result column="TRANS_TYPE" property="trans_type" jdbcType="DECIMAL" />
		<result column="TRANS_INDEX" property="trans_index" jdbcType="VARCHAR" />
		<result column="ADD_DATE" property="add_date" jdbcType="TIMESTAMP" />
		<result column="IS_DEL" property="is_del" jdbcType="DECIMAL" />
		<result column="ADD_USER_ID" property="add_user_id" jdbcType="DECIMAL" />
		<result column="OUT_MONEY" property="out_money" jdbcType="DECIMAL" />
		<result column="OUT_PRICE" property="out_price" jdbcType="DECIMAL" />
		<result column="IN_MONEY" property="in_money" jdbcType="DECIMAL" />
		<result column="IN_PRICE" property="in_price" jdbcType="DECIMAL" />
		<result column="MEMO" property="memo" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="jxcOutInDetailResult" class="jxcOutInDetail" extends="jxcOutInDetailResultForList">
	</resultMap>
	
	<resultMap id="jxcOutInDetailResultList" class="jxcOutInDetail" extends="jxcOutInDetailResultForList">
		<result column="OUT_STORE_NAME" property="map.out_store_name" jdbcType="VARCHAR"/>
		<result column="IN_STORE_NAME" property="map.in_store_name" jdbcType="VARCHAR"/>
		<result column="OUT_CUSTOMER_NAME" property="map.out_customer_name" jdbcType="VARCHAR"/>
		<result column="IN_CUSTOMER_NAME" property="map.in_customer_name" jdbcType="VARCHAR"/>
	</resultMap>

	<sql id="sf-jxcOutInDetail">
		<isNotEmpty prepend=" and " property="id">a.ID = #id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="out_r3_code">a.OUT_R3_CODE = #out_r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="out_store_id">a.OUT_STORE_ID = #out_store_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="in_r3_code">a.IN_R3_CODE = #in_r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="in_store_id">a.IN_STORE_ID = #in_store_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="out_goods_id">a.OUT_GOODS_ID = #out_goods_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="in_goods_id">a.IN_GOODS_ID = #in_goods_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="in_num">a.IN_NUM = #in_num:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="out_date">a.OUT_DATE = #out_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="state">a.STATE = #state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="goods_name">a.GOODS_NAME = #goods_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="subcomp_id">a.SUBCOMP_ID = #subcomp_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="confirm_date">a.CONFIRM_DATE = #confirm_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="trans_type">a.TRANS_TYPE = #trans_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="trans_index">a.TRANS_INDEX = #trans_index:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">a.ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">a.IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">a.ADD_USER_ID = #add_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="out_money">a.OUT_MONEY = #out_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="out_price">a.OUT_PRICE = #out_price:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="in_money">a.IN_MONEY = #in_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="in_price">a.IN_PRICE = #in_price:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="memo">a.MEMO = #memo:VARCHAR#</isNotEmpty>
		
		<isNotEmpty prepend=" and " property="map.out_date_s">
			<![CDATA[a.OUT_DATE >= to_date(#map.out_date_s#,'yyyy-MM-dd hh24:mi:ss')]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.out_date_e">
			<![CDATA[a.OUT_DATE <= to_date(#map.out_date_e#,'yyyy-MM-dd hh24:mi:ss')]]>
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.goods_name_like">a.goods_name like '%' || #map.goods_name_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.trans_index_like">a.trans_index like '%' || #map.trans_index_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.out_r3_code_like">a.out_r3_code like '%' || #map.out_r3_code_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.in_r3_code_like">a.in_r3_code like '%' || #map.in_r3_code_like:VARCHAR# || '%'</isNotEmpty>
	</sql>

	<select id="selectJxcOutInDetail" resultMap="jxcOutInDetailResultList" parameterClass="jxcOutInDetail" cacheModel="oneDayCache">
		select a.*,b.store_name as out_store_name,
		c.store_name as in_store_name,
		d.CUSTOMER_NAME as out_customer_name,
		e.CUSTOMER_NAME as in_customer_name
		 from JXC_OUT_IN_DETAIL a 
		LEFT JOIN J_BASE_STORE b
          ON b.STORE_ID = a.OUT_STORE_ID
        LEFT JOIN J_BASE_STORE c
          ON c.STORE_ID = a.IN_STORE_ID
        LEFT JOIN KONKA_R3_SHOP d
          ON d.R3_CODE = a.OUT_R3_CODE
        LEFT JOIN KONKA_R3_SHOP e
          ON e.R3_CODE = a.IN_R3_CODE
		where 1 = 1
		<include refid="sf-jxcOutInDetail" />
	</select>

	<select id="selectJxcOutInDetailList" resultMap="jxcOutInDetailResultList" parameterClass="jxcOutInDetail" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select a.*,b.store_name as out_store_name,
		c.store_name as in_store_name,
		d.CUSTOMER_NAME as out_customer_name,
		e.CUSTOMER_NAME as in_customer_name
		 from JXC_OUT_IN_DETAIL a
		LEFT JOIN J_BASE_STORE b
          ON b.STORE_ID = a.OUT_STORE_ID
        LEFT JOIN J_BASE_STORE c
          ON c.STORE_ID = a.IN_STORE_ID
        LEFT JOIN KONKA_R3_SHOP d
          ON d.R3_CODE = a.OUT_R3_CODE
        LEFT JOIN KONKA_R3_SHOP e
          ON e.R3_CODE = a.IN_R3_CODE
		 where 1 = 1
		<include refid="sf-jxcOutInDetail" />
		<!-- order by ID asc -->
		order by a.add_date desc
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectJxcOutInDetailCount" resultClass="long" parameterClass="jxcOutInDetail" cacheModel="oneDayCache">
		select count(*) from JXC_OUT_IN_DETAIL a where 1 = 1
		<include refid="sf-jxcOutInDetail" />
	</select>

	<select id="selectJxcOutInDetailPaginatedList" resultMap="jxcOutInDetailResultList" parameterClass="jxcOutInDetail" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select a.*,b.store_name as out_store_name,
		c.store_name as in_store_name,
		d.CUSTOMER_NAME as out_customer_name,
		e.CUSTOMER_NAME as in_customer_name
		 from JXC_OUT_IN_DETAIL a
		LEFT JOIN J_BASE_STORE b
          ON b.STORE_ID = a.OUT_STORE_ID
        LEFT JOIN J_BASE_STORE c
          ON c.STORE_ID = a.IN_STORE_ID
        LEFT JOIN KONKA_R3_SHOP d
          ON d.R3_CODE = a.OUT_R3_CODE
        LEFT JOIN KONKA_R3_SHOP e
          ON e.R3_CODE = a.IN_R3_CODE
		 where 1 = 1
		<include refid="sf-jxcOutInDetail" />
		<!-- order by ID asc -->
		order by a.add_date desc
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<insert id="insertJxcOutInDetail" parameterClass="jxcOutInDetail">
		<selectKey resultClass="long" keyProperty="id">select SEQ_JXC_OUT_IN_DETAIL.nextval as id from dual </selectKey>
		<![CDATA[insert into JXC_OUT_IN_DETAIL (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">ID</isNotNull>	
			<isNotNull prepend="," property="out_r3_code">OUT_R3_CODE</isNotNull>	
			<isNotNull prepend="," property="out_store_id">OUT_STORE_ID</isNotNull>	
			<isNotNull prepend="," property="in_r3_code">IN_R3_CODE</isNotNull>	
			<isNotNull prepend="," property="in_store_id">IN_STORE_ID</isNotNull>	
			<isNotNull prepend="," property="out_goods_id">OUT_GOODS_ID</isNotNull>	
			<isNotNull prepend="," property="in_goods_id">IN_GOODS_ID</isNotNull>	
			<isNotNull prepend="," property="in_num">IN_NUM</isNotNull>	
			<isNotNull prepend="," property="out_date">OUT_DATE</isNotNull>	
			<isNotNull prepend="," property="state">STATE</isNotNull>	
			<isNotNull prepend="," property="goods_name">GOODS_NAME</isNotNull>	
			<isNotNull prepend="," property="subcomp_id">SUBCOMP_ID</isNotNull>	
			<isNotNull prepend="," property="confirm_date">CONFIRM_DATE</isNotNull>	
			<isNotNull prepend="," property="trans_type">TRANS_TYPE</isNotNull>	
			<isNotNull prepend="," property="trans_index">TRANS_INDEX</isNotNull>	
			<isNotNull prepend="," property="add_date">ADD_DATE</isNotNull>	
			<isNotNull prepend="," property="is_del">IS_DEL</isNotNull>	
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID</isNotNull>	
			<isNotNull prepend="," property="out_money">OUT_MONEY</isNotNull>	
			<isNotNull prepend="," property="out_price">OUT_PRICE</isNotNull>	
			<isNotNull prepend="," property="in_money">IN_MONEY</isNotNull>	
			<isNotNull prepend="," property="in_price">IN_PRICE</isNotNull>	
			<isNotNull prepend="," property="memo">MEMO</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">#id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_r3_code">#out_r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="out_store_id">#out_store_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="in_r3_code">#in_r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="in_store_id">#in_store_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_goods_id">#out_goods_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="in_goods_id">#in_goods_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="in_num">#in_num:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_date">#out_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="state">#state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="goods_name">#goods_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="subcomp_id">#subcomp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="confirm_date">#confirm_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="trans_type">#trans_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="trans_index">#trans_index:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_date">#add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="is_del">#is_del:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_user_id">#add_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_money">#out_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_price">#out_price:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="in_money">#in_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="in_price">#in_price:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="memo">#memo:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateJxcOutInDetail" parameterClass="JxcOutInDetail">
		update JXC_OUT_IN_DETAIL
		<dynamic prepend="set">
			<isNotNull prepend="," property="id">ID = #id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_r3_code">OUT_R3_CODE = #out_r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="out_store_id">OUT_STORE_ID = #out_store_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="in_r3_code">IN_R3_CODE = #in_r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="in_store_id">IN_STORE_ID = #in_store_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_goods_id">OUT_GOODS_ID = #out_goods_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="in_goods_id">IN_GOODS_ID = #in_goods_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="in_num">IN_NUM = #in_num:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_date">OUT_DATE = #out_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="state">STATE = #state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="goods_name">GOODS_NAME = #goods_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="subcomp_id">SUBCOMP_ID = #subcomp_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="confirm_date">CONFIRM_DATE = #confirm_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="trans_type">TRANS_TYPE = #trans_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="trans_index">TRANS_INDEX = #trans_index:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="is_del">IS_DEL = #is_del:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID = #add_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_money">OUT_MONEY = #out_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="out_price">OUT_PRICE = #out_price:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="in_money">IN_MONEY = #in_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="in_price">IN_PRICE = #in_price:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="memo">MEMO = #memo:VARCHAR#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteJxcOutInDetail" parameterClass="JxcOutInDetail">
		delete from JXC_OUT_IN_DETAIL where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

</sqlMap>