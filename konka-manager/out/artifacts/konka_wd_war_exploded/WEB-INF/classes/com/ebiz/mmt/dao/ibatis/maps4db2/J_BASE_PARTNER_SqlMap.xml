<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="J_BASE_PARTNER">

	<typeAlias alias="jBasePartner" type="com.ebiz.mmt.domain.JBasePartner" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertJBasePartner" />
		<flushOnExecute statement="updateJBasePartner" />
		<flushOnExecute statement="deleteJBasePartner" />
	</cacheModel>


	<resultMap id="jBasePartnerResultOnlyName" class="jBasePartner">
		<result column="PARTNER_NAME" property="partner_name" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="jBasePartnerResultForList" class="jBasePartner">
		<result column="PARTNER_ID" property="partner_id" jdbcType="DECIMAL" />
		<result column="PARTNER_TYPE" property="partner_type" jdbcType="DECIMAL" />
		<result column="PARTNER_OBJ" property="partner_obj" jdbcType="DECIMAL" />
		<result column="PARTNER_NAME" property="partner_name" jdbcType="VARCHAR" />
		<result column="PARTNER_SN" property="partner_sn" jdbcType="VARCHAR" />
		<result column="PARTNER_ADDR" property="partner_addr" jdbcType="VARCHAR" />
		<result column="PARTNER_FAX" property="partner_fax" jdbcType="VARCHAR" />
		<result column="LINK_NAME" property="link_name" jdbcType="VARCHAR" />
		<result column="LINK_MOBILE" property="link_mobile" jdbcType="VARCHAR" />
		<result column="LINK_TEL" property="link_tel" jdbcType="VARCHAR" />
		<result column="LINK_EMAIL" property="link_email" jdbcType="VARCHAR" />
		<result column="LINK_QQ_MSN" property="link_qq_msn" jdbcType="VARCHAR" />
		<result column="LINK_ID_TYPE" property="link_id_type" jdbcType="DECIMAL" />
		<result column="LINK_ID" property="link_id" jdbcType="VARCHAR" />
		<result column="LINK_ADDR" property="link_addr" jdbcType="VARCHAR" />
		<result column="MEMO" property="memo" jdbcType="VARCHAR" />
		<result column="IS_DEL" property="is_del" jdbcType="DECIMAL" />
		<result column="ADD_DATE" property="add_date" jdbcType="DATETIME" />
		<result column="C_ID" property="c_id" jdbcType="DECIMAL" />
		<result column="PARTNER_C_ID" property="partner_c_id" jdbcType="DECIMAL" />
		<result column="CONSIGNEE_NAME" property="consignee_name" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_TEL" property="consignee_tel" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_P_INDEX" property="consignee_p_index" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_STREET" property="consignee_street" jdbcType="VARCHAR" />
		<result column="PAR_C_ID" property="par_c_id" jdbcType="DECIMAL" />
		<result column="LINK_SEX" property="link_sex" jdbcType="VARCHAR" />
		<result column="LINK_JOB" property="link_job" jdbcType="VARCHAR" />
		<result column="PARTNER_COMPANY_PHONE" property="partner_company_phone" jdbcType="VARCHAR" />
		<result column="AREA_CODE" property="area_code" jdbcType="VARCHAR" />
		<result column="DEPT_ID" property="dept_id" jdbcType="DECIMAL" />
		<result column="JB_JOB_ID" property="jb_job_id" jdbcType="DECIMAL" />
		<result column="YWY_JOB_ID" property="ywy_job_id" jdbcType="VARCHAR" />
		<result column="P_LEVEL" property="p_level" jdbcType="DECIMAL" />
		<result column="STOP_DATE" property="stop_date" jdbcType="TIMESTAMP" />
		<result column="CREATE_USER_ID" property="create_user_id" jdbcType="DECIMAL" />
		<result column="MODIFY_USER_ID" property="modify_user_id" jdbcType="DECIMAL" />
		<result column="MODIFY_DATE" property="modify_date" jdbcType="TIMESTAMP" />
	</resultMap>

	<resultMap id="jBasePartnerResult" class="jBasePartner" extends="jBasePartnerResultForList">
		<result property="map.par_name" column="par_name" />
		<result property="map.par_id" column="par_id" />
		<result property="map.status" column="status" />
	</resultMap>

	<resultMap id="jBasePartnerResultNew" class="jBasePartner" extends="jBasePartnerResultForList">
		<result column="DEPT_NAME" property="map.dept_name" jdbcType="VARCHAR" />
		<result column="JB_NAME" property="map.jb_name" jdbcType="VARCHAR" />
		<result column="YWY_NAME" property="map.ywy_name" jdbcType="VARCHAR" />
		<result column="USER_NAME" property="map.user_name" jdbcType="VARCHAR" />
		<result column="pass_word" property="map.pass_word" jdbcType="VARCHAR" />
		<result column="PAR_PARTNER_NAME" property="map.par_partner_name" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="jBasePartnerForLevelResult" class="jBasePartner" extends="jBasePartnerResultForList">
		<result column="j_level" property="map.j_level" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="jBasePartnerForBillResult" class="jBasePartner">
		<result column="PARTNER_NAME" property="map.partner_name" jdbcType="VARCHAR" />
		<result column="PARTNER_ID" property="map.partner_id" jdbcType="DECIMAL" />
		<result column="PARTNER_TYPE" property="map.partner_type" jdbcType="DECIMAL" />
	</resultMap>

	<sql id="sf-jBasePartner">
		<isNotEmpty prepend=" and " property="partner_id">PARTNER_ID = #partner_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_type">PARTNER_TYPE = #partner_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_obj">PARTNER_OBJ = #partner_obj:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_name">PARTNER_NAME = #partner_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_sn">PARTNER_SN = #partner_sn:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_addr">PARTNER_ADDR = #partner_addr:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_fax">PARTNER_FAX = #partner_fax:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_name">LINK_NAME = #link_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_mobile">LINK_MOBILE = #link_mobile:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_tel">LINK_TEL = #link_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_email">LINK_EMAIL = #link_email:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_qq_msn">LINK_QQ_MSN = #link_qq_msn:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_id_type">LINK_ID_TYPE = #link_id_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_id">LINK_ID = #link_id:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="link_addr">LINK_ADDR = #link_addr:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="memo">MEMO = #memo:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">ADD_DATE = #add_date:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="c_id">(C_ID = #c_id:DECIMAL# or PARTNER_C_ID = #c_id:DECIMAL#)</isNotEmpty>
		<isNotEmpty prepend=" and " property="consignee_name">CONSIGNEE_NAME = #consignee_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="consignee_tel">CONSIGNEE_TEL = #consignee_tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="consignee_p_index">CONSIGNEE_P_INDEX = #consignee_p_index:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="consignee_street">CONSIGNEE_STREET = #consignee_street:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="par_c_id">PAR_C_ID = #par_c_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_c_id">PARTNER_C_ID = #partner_c_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dept_id">DEPT_ID = #dept_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="p_level">P_LEVEL = #p_level:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="stop_date">STOP_DATE = #stop_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="create_user_id">CREATE_USER_ID = #create_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="modify_user_id">MODIFY_USER_ID = #modify_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="modify_date">MODIFY_DATE = #MODIFY_DATE:TIMESTAMP#</isNotEmpty>

		<isNotEmpty prepend=" and " property="map.partner_name_like">PARTNER_NAME like '%' || #map.partner_name_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.partner_type_value">PARTNER_TYPE like '%' || #map.partner_type_value:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.link_name_like">LINK_NAME like '%' || #map.link_name_like:VARCHAR# || '%'</isNotEmpty>
	</sql>

	<sql id="sf-fgskh-jBasePartner">
		<isNotEmpty prepend=" and " property="map.dept_id_start">
			(b.cur_dept_id is not null and b.cur_dept_id in (
			select dept_id from konka_dept start with dept_id in (
			SELECT DISTINCT (dept_id)
			FROM KONKA_ROLE_DATA_LEVEL
			WHERE role_id IN (SELECT role_id
			FROM KONKA_PE_ROLE_USER
			WHERE user_id = #map.session_user_id#)
			) or dept_id = #map.dept_id_start#
			connect by prior dept_id = par_id
			)
			)
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">
			b.user_id = #map.filter_by_ywy_id_eq#
		</isNotEmpty>

		<isNotEmpty prepend=" and " property="map.customer_name_like">b.customer_name like '%' || #map.customer_name_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.r3_code_like">upper(b.r3_code) like '%' || upper(#map.r3_code_like:VARCHAR#) || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_id">b.dept_id = #map.dept_id:DECIMAL# </isNotEmpty>
	</sql>

	<!-- <select id="selectJBasePartner" resultMap="jBasePartnerResult" parameterClass="jBasePartner" cacheModel="oneDayCache"> select * from J_BASE_PARTNER where 1 = 1 <include 
		refid="sf-jBasePartner" /> </select> -->


	<select id="selectEntityListOnlyName" resultMap="jBasePartnerResultOnlyName" parameterClass="jBasePartner" cacheModel="oneDayCache">
		select distinct(partner_name) from J_BASE_PARTNER where 1 = 1
		<include refid="sf-jBasePartner" />
	</select>

	<select id="selectJBasePartnerList" resultMap="jBasePartnerResultForList" parameterClass="jBasePartner" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from J_BASE_PARTNER where 1 = 1
		<include refid="sf-jBasePartner" />
		<isNotEmpty prepend=" and " property="map.current_id">partner_id not in (#map.current_id#)</isNotEmpty>
		order by partner_id desc
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectJBasePartnerCount" resultClass="long" parameterClass="jBasePartner" cacheModel="oneDayCache">
		select count(*) from J_BASE_PARTNER where 1 = 1
		<include refid="sf-jBasePartner" />
	</select>

	<select id="selectJBasePartnerPaginatedList" resultMap="jBasePartnerResultForList" parameterClass="jBasePartner" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from J_BASE_PARTNER where 1 = 1
		<include refid="sf-jBasePartner" />
		ORDER BY add_date desc
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<!-- 客户端网点统计查询 Lianghouen 2015-05-20 -->
	<select id="selectJBasePartnerForLevelCount" resultClass="long" parameterClass="jBasePartner" cacheModel="oneDayCache">
		SELECT count(1) FROM (
		SELECT j.*,(CASE WHEN (j.C_ID=j.PAR_C_ID) then (select customer_name from konka_r3_shop where id=j.par_c_id)
		else (select partner_name from
		j_base_partner where partner_id=j.par_c_id) end) par_name FROM j_base_partner j where 1=1
		<isNotEmpty prepend=" and " property="map.is_konka">
			j.c_id = #map.is_konka#
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.partner_name_like">
			j.partner_name like '%'||#map.partner_name_like#||'%'
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.partner_sn_like">
			j.partner_sn like '%'||#map.partner_sn_like#||'%'
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="p_level">
			j.p_level = #p_level#
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.link_name_like">
			j.link_name like '%'||#map.link_name_like#||'%'
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.link_mobile_like">
			j.link_mobile like '%'||#map.link_mobile_like#||'%'
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">
			j.is_del = #is_del#
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_type">j.PARTNER_TYPE = #partner_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_obj">j.PARTNER_OBJ = #partner_obj:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" " property="map.is_not_konka">
			START WITH par_c_id=#map.is_not_konka# CONNECT BY prior par_c_id=PARTNER_ID
		</isNotEmpty>
		) where 1=1
		<isNotEmpty prepend=" and " property="map.par_name_like">
			par_name like '%'||#map.par_name_like#||'%'
		</isNotEmpty>
	</select>

	<!-- Liang,HouEn 2015-05-20 客户端查询网点列表 -->
	<select id="selectJBasePartnerForCustomerList" resultMap="jBasePartnerResult" parameterClass="jBasePartner" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		SELECT * FROM (
		SELECT j.*,(CASE WHEN (j.C_ID=j.PAR_C_ID) then (select customer_name from konka_r3_shop where id=j.par_c_id)
		else (select partner_name from j_base_partner where partner_id=j.par_c_id) end) par_name,
		(CASE WHEN (j.C_ID=j.PAR_C_ID) then (select r3_code from konka_r3_shop where id=j.par_c_id)
		else (select partner_sn from j_base_partner where partner_id=j.par_c_id) end) par_id,
		a_info.STATUS FROM j_base_partner j
		left join (select STATUS, link_id from KONKA_AUDIT_LIST_INFO where LINK_TYPE='agent' AND BACK_ID='1') a_info on a_info.link_id=j.partner_id
		where 1=1
		<isNotEmpty prepend=" and " property="map.is_konka">
			j.c_id = #map.is_konka#
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.partner_name_like">
			j.partner_name like '%'||#map.partner_name_like#||'%'
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.partner_sn_like">
			j.partner_sn like '%'||#map.partner_sn_like#||'%'
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="p_level">
			j.p_level = #p_level#
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.link_name_like">
			j.link_name like '%'||#map.link_name_like#||'%'
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.link_mobile_like">
			j.link_mobile like '%'||#map.link_mobile_like#||'%'
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">
			j.is_del = #is_del#
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_type">j.PARTNER_TYPE = #partner_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_obj">j.PARTNER_OBJ = #partner_obj:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" " property="map.is_not_konka">
			START WITH par_c_id=#map.is_not_konka# CONNECT BY prior par_c_id=PARTNER_ID
		</isNotEmpty>
		) where 1=1
		<isNotEmpty prepend=" and " property="map.par_name_like">
			par_name like '%'||#map.par_name_like#||'%'
		</isNotEmpty>
		ORDER BY p_level
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<select id="selectJBasePartnerForSonPaginatedList" resultMap="jBasePartnerForLevelResult" parameterClass="jBasePartner" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from (
		SELECT t.*, level as j_level
		FROM J_BASE_PARTNER t
		START WITH partner_id IN (
		<isNotEmpty prepend=" " property="map.is_konka">
			SELECT distinct (partner_id)
			FROM J_BASE_PARTNER
			WHERE (c_id = #map.is_konka:DECIMAL# OR partner_c_id = #map.is_konka:DECIMAL#)
			and par_c_id = #map.is_konka:DECIMAL#
		</isNotEmpty>
		<isNotEmpty prepend=" " property="map.is_not_konka">
			SELECT distinct (partner_id)
			FROM J_BASE_PARTNER
			WHERE partner_id = #map.is_not_konka:DECIMAL#
		</isNotEmpty>
		)
		CONNECT BY PRIOR partner_id = par_c_id
		) where 1 = 1
		<include refid="sf-jBasePartner" />
		<isNotEmpty prepend=" and " property="map.is_not_self_id"> <![CDATA[ partner_id <> #map.is_not_self_id:DECIMAL# ]]>
		</isNotEmpty>
		ORDER BY j_level
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<!-- Hu,Hao 2014-01-02 -->
	<select id="selectJBasePartnerForLevelPaginatedList" resultMap="jBasePartnerForLevelResult" parameterClass="jBasePartner" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from (
		SELECT t.*, level as j_level
		FROM J_BASE_PARTNER t
		START WITH partner_id IN (
		<isNotEmpty prepend=" " property="map.is_konka">
			SELECT distinct (partner_id)
			FROM J_BASE_PARTNER
			WHERE (c_id = #map.is_konka:DECIMAL# OR partner_c_id = #map.is_konka:DECIMAL#)
			and par_c_id = #map.is_konka:DECIMAL#
		</isNotEmpty>
		<isNotEmpty prepend=" " property="map.is_not_konka">
			SELECT distinct (partner_id)
			FROM J_BASE_PARTNER
			WHERE partner_id = #map.is_not_konka:DECIMAL#
		</isNotEmpty>
		)
		CONNECT BY PRIOR partner_id = par_c_id
		) where 1 = 1
		<include refid="sf-jBasePartner" />
		<isNotEmpty prepend=" and " property="map.is_not_konka">partner_id <![CDATA[ <>]]>
			#map.is_not_konka:DECIMAL#
		</isNotEmpty>
		ORDER BY j_level
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<!-- Hu,Hao 2014-01-04 -->
	<select id="selectJBasePartnerForFgsKhCount" resultClass="long" parameterClass="jBasePartner" cacheModel="oneDayCache">
		select count(1) from (
		SELECT a.PARTNER_NAME
		FROM (SELECT *
		FROM J_BASE_PARTNER
		WHERE 1 = 1
		<include refid="sf-jBasePartner" />
		) a
		LEFT JOIN
		MV_ORG_OF_CUSTOMER b
		ON a.PARTNER_C_ID = b.KONKA_R3_ID
		WHERE b.R3_CODE IS NOT NULL
		<include refid="sf-fgskh-jBasePartner" />
		)
	</select>

	<resultMap id="jBasePartnerForFgsKhResult" class="jBasePartner">
		<result column="PARTNER_NAME" property="map.partner_name" jdbcType="VARCHAR" />
		<result column="PARTNER_ID" property="map.partner_id" jdbcType="DECIMAL" />
		<result column="PARTNER_TYPE" property="map.partner_type" jdbcType="DECIMAL" />
		<result column="PARTNER_SN" property="map.partner_sn" jdbcType="VARCHAR" />
		<result column="LINK_NAME" property="map.link_name" jdbcType="VARCHAR" />
		<result column="LINK_MOBILE" property="map.link_mobile" jdbcType="VARCHAR" />
		<result column="LINK_TEL" property="map.link_tel" jdbcType="VARCHAR" />
		<result column="DEPT_NAME" property="map.dept_name" jdbcType="VARCHAR" />
		<result column="R3_CODE" property="map.r3_code" jdbcType="VARCHAR" />
		<result column="CUSTOMER_NAME" property="map.customer_name" jdbcType="VARCHAR" />
		<result column="ADD_DATE" property="map.add_date" jdbcType="DATETIME" />
		<result column="IS_DEL" property="map.is_del" jdbcType="DECIMAL" />
	</resultMap>

	<!-- Hu,Hao 2014-01-04 -->
	<select id="selectJBasePartnerForFgsKhPaginatedList" resultMap="jBasePartnerForFgsKhResult" parameterClass="jBasePartner" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		SELECT a.PARTNER_ID,
		a.PARTNER_NAME,
		a.PARTNER_SN,
		a.PARTNER_TYPE,
		a.LINK_NAME,
		a.LINK_MOBILE,
		a.LINK_TEL,
		a.add_date,
		a.is_del,
		b.DEPT_NAME,
		b.R3_CODE,
		b.CUSTOMER_NAME
		FROM (SELECT *
		FROM J_BASE_PARTNER
		WHERE 1 = 1
		<include refid="sf-jBasePartner" />
		) a
		LEFT JOIN
		MV_ORG_OF_CUSTOMER b
		ON a.PARTNER_C_ID = b.KONKA_R3_ID
		WHERE b.R3_CODE IS NOT NULL
		<include refid="sf-fgskh-jBasePartner" />
		order by a.add_date desc
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<select id="selectJBasePartnerForBillList" resultMap="jBasePartnerForBillResult" parameterClass="jBasePartner" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		SELECT b.PARTNER_ID, b.PARTNER_NAME,b.PARTNER_TYPE
		FROM J_BILL a LEFT JOIN J_BASE_PARTNER b ON a.PARTNER_ID = b.PARTNER_ID
		WHERE 1 = 1
		<isNotEmpty prepend=" and " property="map.bill_type">a.bill_type = #map.bill_type:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.c_id">a.C_ID = #map.c_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.partner_type_value">b.partner_type like '%' || #map.partner_type_value# || '%'</isNotEmpty>
		GROUP BY b.PARTNER_ID, b.PARTNER_NAME,b.PARTNER_TYPE
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<insert id="insertJBasePartner" parameterClass="jBasePartner">
		<selectKey resultClass="long" keyProperty="partner_id">select SEQ_J_PARTNER_ID.nextval as partner_id from dual </selectKey>
		<![CDATA[insert into J_BASE_PARTNER (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="partner_id">PARTNER_ID</isNotNull>
			<isNotNull prepend="," property="partner_type">PARTNER_TYPE</isNotNull>
			<isNotNull prepend="," property="partner_obj">PARTNER_OBJ</isNotNull>
			<isNotNull prepend="," property="partner_name">PARTNER_NAME</isNotNull>
			<isNotNull prepend="," property="partner_sn">PARTNER_SN</isNotNull>
			<isNotNull prepend="," property="partner_addr">PARTNER_ADDR</isNotNull>
			<isNotNull prepend="," property="partner_fax">PARTNER_FAX</isNotNull>
			<isNotNull prepend="," property="link_name">LINK_NAME</isNotNull>
			<isNotNull prepend="," property="link_mobile">LINK_MOBILE</isNotNull>
			<isNotNull prepend="," property="link_tel">LINK_TEL</isNotNull>
			<isNotNull prepend="," property="link_email">LINK_EMAIL</isNotNull>
			<isNotNull prepend="," property="link_qq_msn">LINK_QQ_MSN</isNotNull>
			<isNotNull prepend="," property="link_id_type">LINK_ID_TYPE</isNotNull>
			<isNotNull prepend="," property="link_id">LINK_ID</isNotNull>
			<isNotNull prepend="," property="link_addr">LINK_ADDR</isNotNull>
			<isNotNull prepend="," property="memo">MEMO</isNotNull>
			<isNotNull prepend="," property="is_del">IS_DEL</isNotNull>
			<isNotNull prepend="," property="add_date">ADD_DATE</isNotNull>
			<isNotNull prepend="," property="c_id">C_ID</isNotNull>
			<isNotNull prepend="," property="partner_c_id">PARTNER_C_ID</isNotNull>
			<isNotNull prepend="," property="consignee_name">CONSIGNEE_NAME</isNotNull>
			<isNotNull prepend="," property="consignee_tel">CONSIGNEE_TEL</isNotNull>
			<isNotNull prepend="," property="consignee_p_index">CONSIGNEE_P_INDEX</isNotNull>
			<isNotNull prepend="," property="consignee_street">CONSIGNEE_STREET</isNotNull>
			<isNotNull prepend="," property="par_c_id">PAR_C_ID</isNotNull>
			<isNotNull prepend="," property="link_sex">LINK_SEX</isNotNull>
			<isNotNull prepend="," property="link_job">LINK_JOB</isNotNull>
			<isNotNull prepend="," property="partner_company_phone">PARTNER_COMPANY_PHONE</isNotNull>
			<isNotNull prepend="," property="area_code">AREA_CODE</isNotNull>
			<isNotNull prepend="," property="dept_id">DEPT_ID</isNotNull>
			<isNotNull prepend="," property="jb_job_id">JB_JOB_ID</isNotNull>
			<isNotNull prepend="," property="ywy_job_id">YWY_JOB_ID</isNotNull>
			<isNotNull prepend="," property="p_level">P_LEVEL</isNotNull>
			<isNotNull prepend="," property="stop_date">STOP_DATE</isNotNull>
			<isNotNull prepend="," property="create_user_id">CREATE_USER_ID</isNotNull>
			<isNotNull prepend="," property="modify_user_id">MODIFY_USER_ID</isNotNull>
			<isNotNull prepend="," property="modify_date">MODIFY_DATE</isNotNull>
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="partner_id">#partner_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="partner_type">#partner_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="partner_obj">#partner_obj:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="partner_name">#partner_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="partner_sn">#partner_sn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="partner_addr">#partner_addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="partner_fax">#partner_fax:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_name">#link_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_mobile">#link_mobile:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_tel">#link_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_email">#link_email:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_qq_msn">#link_qq_msn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_id_type">#link_id_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="link_id">#link_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_addr">#link_addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="memo">#memo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="is_del">#is_del:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_date">#add_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="c_id">#c_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="partner_c_id">#partner_c_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="consignee_name">#consignee_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="consignee_tel">#consignee_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="consignee_p_index">#consignee_p_index:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="consignee_street">#consignee_street:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="par_c_id">#par_c_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="link_sex">#link_sex:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_job">#link_job:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="partner_company_phone">#partner_company_phone:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="area_code">#area_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="dept_id">#dept_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="jb_job_id">#jb_job_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="ywy_job_id">#ywy_job_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="p_level">#p_level:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="stop_date">#stop_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="create_user_id">#create_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="modify_user_id">#modify_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="modify_date">#modify_date:TIMESTAMP#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateJBasePartner" parameterClass="JBasePartner">
		update J_BASE_PARTNER
		<dynamic prepend="set">
			<isNotNull prepend="," property="partner_id">PARTNER_ID = #partner_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="partner_type">PARTNER_TYPE = #partner_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="partner_obj">PARTNER_OBJ = #partner_obj:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="partner_name">PARTNER_NAME = #partner_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="partner_sn">PARTNER_SN = #partner_sn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="partner_addr">PARTNER_ADDR = #partner_addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="partner_fax">PARTNER_FAX = #partner_fax:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_name">LINK_NAME = #link_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_mobile">LINK_MOBILE = #link_mobile:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_tel">LINK_TEL = #link_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_email">LINK_EMAIL = #link_email:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_qq_msn">LINK_QQ_MSN = #link_qq_msn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_id_type">LINK_ID_TYPE = #link_id_type:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="link_id">LINK_ID = #link_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_addr">LINK_ADDR = #link_addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="memo">MEMO = #memo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="is_del">IS_DEL = #is_del:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="add_date">ADD_DATE = #add_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="c_id">C_ID = #c_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="partner_c_id">PARTNER_C_ID = #partner_c_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="map.set_partner_c_id_null">PARTNER_C_ID = ''</isNotNull>
			<isNotNull prepend="," property="consignee_name">CONSIGNEE_NAME = #consignee_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="consignee_tel">CONSIGNEE_TEL = #consignee_tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="consignee_p_index">CONSIGNEE_P_INDEX = #consignee_p_index:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="consignee_street">CONSIGNEE_STREET = #consignee_street:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="par_c_id">PAR_C_ID = #par_c_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="link_sex">LINK_SEX = #link_sex:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="link_job">LINK_JOB = #link_job:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="partner_company_phone">PARTNER_COMPANY_PHONE = #partner_company_phone:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="area_code">AREA_CODE = #area_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="dept_id">DEPT_ID = #dept_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="jb_job_id">JB_JOB_ID = #jb_job_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="ywy_job_id">YWY_JOB_ID = #ywy_job_id:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="p_level">P_LEVEL = #p_level:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="stop_date">STOP_DATE = #stop_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="create_user_id">CREATE_USER_ID = #create_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="modify_user_id">MODIFY_USER_ID = #modify_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="modify_date">MODIFY_DATE = #modify_date:TIMESTAMP#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="partner_id">PARTNER_ID = #partner_id#</isNotEmpty>
		<isEmpty prepend=" " property="partner_id">
			<isNotEmpty prepend=" " property="map.pks">
				PARTNER_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteJBasePartner" parameterClass="JBasePartner">
		update J_BASE_PARTNER set IS_DEL = 1 where
		<isNotEmpty prepend=" " property="partner_id">PARTNER_ID = #partner_id#</isNotEmpty>
		<isEmpty prepend=" " property="partner_id">
			<isNotEmpty prepend=" " property="map.pks">
				PARTNER_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

	<!-- 查询代理商下拉列表 -->
	<select id="selectJBasePartnerMapList" resultClass="java.util.HashMap" parameterClass="jBasePartner" cacheModel="oneDayCache">
		select partner_id,partner_name from J_BASE_PARTNER where 1 = 1
		<isNotEmpty prepend=" and " property="is_del">IS_DEL = #is_del:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="c_id">(C_ID = #c_id:DECIMAL# or PARTNER_C_ID = #c_id:DECIMAL#)</isNotEmpty>
		order by partner_name desc
	</select>

	<!-- 查询代理商网点总数 -->
	<select id="selectJBasePartnerNewListCount" resultClass="long" parameterClass="jBasePartner" cacheModel="oneDayCache">
		select count(1) FROM (SELECT t.* FROM J_BASE_PARTNER t
		WHERE 1=1
		<include refid="sf-jBasePartner" />
		<isNotEmpty prepend=" and " property="map.link_name">link_name like '%' || #map.link_name:VARCHAR# || '%'</isNotEmpty>
		) a
		LEFT JOIN konka_r3_shop b ON a.par_c_id = b.id
		LEFT JOIN KONKA_DEPT c ON a.dept_id = c.dept_id
		LEFT JOIN KONKA_DEPT d ON a.jb_job_id = d.dept_id
		LEFT JOIN KONKA_PE_PROD_USER e ON a.ywy_job_id = e.job_id
		LEFT JOIN J_BASE_PARTNER f on a.par_c_id=f.partner_id
		left join (select C_INDEX,PAR_INDEX from Konka_Category where is_del=0 and c_type=10) kc on b.CUSTOMER_TYPE=kc.C_INDEX
		left join (select * from KONKA_AUDIT_LIST_INFO where LINK_TYPE='agent' AND BACK_ID='1') a_info on a_info.link_id=a.partner_id
		WHERE 1=1
		<isNotEmpty prepend=" and " property="map.is_sure1">a_info.STATUS = 0</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.is_sure2">(a_info.STATUS != 0 or a_info.status is null)</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.ywy_name_like">e.Real_name like '%' || #map.ywy_name_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.r3_code">(b.r3_code = #map.r3_code# or f.partner_sn = #map.r3_code#)</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.kh_name_like">(b.CUSTOMER_NAME like '%' || #map.kh_name_like:VARCHAR# || '%' or f.partner_name like '%' || #map.kh_name_like:VARCHAR# ||
			'%')</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.jb_name_like">d.dept_name like '%' || #map.jb_name_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cus_type1">kc.PAR_INDEX = #map.cus_type1#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cus_type2">kc.C_INDEX = #map.cus_type2#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.fgs_dept_value">c.dept_id = #map.fgs_dept_value#</isNotEmpty>
		<!-- <isNotEmpty prepend=" and " property="map.dept_id_start"> (ee.cur_dept_id is not null and ee.cur_dept_id in ( select dept_id from konka_dept start with dept_id in ( SELECT 
			DISTINCT (dept_id) FROM KONKA_ROLE_DATA_LEVEL WHERE role_id IN (SELECT role_id FROM KONKA_PE_ROLE_USER WHERE user_id = #map.session_user_id#) ) or dept_id = #map.dept_id_start# 
			connect by prior dept_id = par_id ) ) </isNotEmpty> -->

		<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">
			e.id = #map.filter_by_ywy_id_eq#
		</isNotEmpty>
	</select>

	<!-- 代理商网点管理新版列表查询 -->
	<select id="selectJBasePartnerNewList" resultClass="java.util.HashMap" parameterClass="jBasePartner" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		SELECT b.id AS r3_id,a.PARTNER_ID,c.DEPT_NAME,d.dept_name AS jb_name,a.p_level,a.PARTNER_SN,a.PARTNER_NAME,
		decode(b.CUSTOMER_NAME,null,f.partner_name,b.customer_name) as customer_name,
		decode(b.r3_code,null,f.partner_sn,b.r3_code) as r3_code,a.ywy_job_id,e.Real_name,a.link_name,a.AREA_CODE,
		a.PARTNER_ADDR,a.is_del,b.IS_DEL,b.ID,a.par_c_id,a.c_id,kc.C_NAME
		FROM (SELECT t.* FROM J_BASE_PARTNER t
		WHERE 1=1
		<include refid="sf-jBasePartner" />
		<isNotEmpty prepend=" and " property="map.link_name">link_name like '%' || #map.link_name:VARCHAR# || '%'</isNotEmpty>
		) a
		LEFT JOIN (select * from konka_r3_shop where is_del=0) b ON a.par_c_id = b.id
		LEFT JOIN KONKA_DEPT c ON a.dept_id = c.dept_id
		LEFT JOIN KONKA_DEPT d ON a.jb_job_id = d.dept_id
		LEFT JOIN KONKA_PE_PROD_USER e ON a.ywy_job_id = e.job_id
		LEFT JOIN J_BASE_PARTNER f on a.par_c_id=f.partner_id
		left join (select C_INDEX,PAR_INDEX,C_NAME from Konka_Category where is_del=0 and c_type=10) kc on b.CUSTOMER_TYPE=kc.C_INDEX
		<isNotEmpty prepend=" " property="map.dept_id_start">
			left join MV_ORG_OF_CUSTOMER_ALL ee on ee.konka_r3_id= b.id
		</isNotEmpty>
		<isNotEmpty prepend=" " property="map.filter_by_ywy_id_eq">
			left join MV_ORG_OF_CUSTOMER_ALL ee on ee.konka_r3_id= b.id
		</isNotEmpty>
		WHERE 1=1
		<isNotEmpty prepend=" and " property="map.ywy_name_like">e.Real_name like '%' || #map.ywy_name_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.r3_code">(b.r3_code = #map.r3_code# or f.partner_sn = #map.r3_code#)</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.kh_name_like">(b.CUSTOMER_NAME like '%' || #map.kh_name_like:VARCHAR# || '%' or f.partner_name like '%' || #map.kh_name_like:VARCHAR# ||
			'%')</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.jb_name_like">d.dept_name like '%' || #map.jb_name_like:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cus_type1">kc.PAR_INDEX = #map.cus_type1#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.cus_type2">kc.C_INDEX = #map.cus_type2#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.fgs_dept_value">c.dept_id = #map.fgs_dept_value#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_id_start">
			(ee.cur_dept_id is not null and ee.cur_dept_id in (
			select dept_id from konka_dept start with dept_id in (
			SELECT DISTINCT (dept_id)
			FROM KONKA_ROLE_DATA_LEVEL
			WHERE role_id IN (SELECT role_id
			FROM KONKA_PE_ROLE_USER
			WHERE user_id = #map.session_user_id#)
			) or dept_id = #map.dept_id_start#
			connect by prior dept_id = par_id
			)
			)
		</isNotEmpty>

		<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">
			ee.user_id = #map.filter_by_ywy_id_eq#
		</isNotEmpty>
		order by a.partner_name
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<!-- 获取网点详情 -->
	<select id="selectJBasePartner" resultMap="jBasePartnerResultNew" parameterClass="jBasePartner" cacheModel="oneDayCache">
		select a.*,c.dept_name,d.dept_name as jb_name,e.Real_name ywy_name,f.user_name,
		f.pass_word,g.CUSTOMER_NAME as par_partner_name from J_BASE_PARTNER a
		left join KONKA_DEPT c
		on a.dept_id=c.dept_id
		left join KONKA_DEPT d on a.jb_job_id=d.dept_id
		left join KONKA_PE_PROD_USER e on a.ywy_job_id=e.job_id
		left join KONKA_PE_PROD_USER f on (a.partner_c_id=f.cust_id and
		f.user_type=2 and f.is_del=0)
		left join konka_r3_shop g on a.par_c_id=g.id
		where 1 = 1
		<isNotEmpty prepend=" and " property="partner_id">a.PARTNER_ID = #partner_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="partner_c_id">a.PARTNER_C_ID = #partner_c_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dept_id">a.DEPT_ID = #dept_id:DECIMAL#</isNotEmpty>
	</select>

	<!-- 获取网点级别列表 -->
	<select id="selectJBasePartnerLevelList" resultClass="java.util.HashMap" cacheModel="oneDayCache">
		select distinct p_level,p_level||'级' as level_name from j_base_partner where
		p_level is not null
	</select>

	<!-- 存储过程查询网点列表 -->
	<parameterMap class="java.util.HashMap" id="cursorMap">
		<parameter property="I_DEPT_ID" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_AGENT_NAME" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_AGENT_CODE" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_AGENT_LEVE" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_PAR_CODE" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_PAR_NAME" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_YWY" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_LINK_NAME" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_JING_NAME" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_IS_STOP" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_CUST_TYPE1" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_CUST_TYPE2" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="FIRST_ROW" jdbcType="VARCHAR" javaType="java.lang.Integer" mode="IN" />
		<parameter property="COUNT_ROW" jdbcType="VARCHAR" javaType="java.lang.Integer" mode="IN" />
		<parameter property="I_DEPT_START" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="I_YWY_ID" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="SESSION_ID" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="IS_SURE1" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="IS_SURE2" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="SQL_CODE" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	<procedure id="queryAgentList" parameterMap="cursorMap" resultClass="java.util.HashMap">
		{call SELECT_R3_SHOP(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
	</procedure>

	<!-- 根据网点编码获取业务员信息 -->
	<select id="getYWYAndDept" resultClass="java.util.HashMap" parameterClass="java.lang.String" cacheModel="oneDayCache">
		select u.real_name,d.dept_name,u.LINK_PHONE from
		j_base_partner j
		left join konka_pe_prod_user u on j.ywy_job_id=u.job_id
		left join konka_dept d on d.dept_id=j.dept_id where partner_sn=#partner_sn#
	</select>
</sqlMap>