<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KONKA_R3_SHOP_LINK">

	<typeAlias alias="konkaR3ShopLink" type="com.ebiz.mmt.domain.KonkaR3ShopLink" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertKonkaR3ShopLink" />
		<flushOnExecute statement="updateKonkaR3ShopLink" />
		<flushOnExecute statement="deleteKonkaR3ShopLink" />
	</cacheModel>

	<resultMap id="konkaR3ShopLinkResultForList" class="konkaR3ShopLink">
		<result column="LINK_ID" property="link_id" jdbcType="BIGINT" />
		<result column="R3_SHOP_ID" property="r3_shop_id" jdbcType="BIGINT" />
		<result column="POSITION" property="position" jdbcType="VARCHAR" />
		<result column="REAL_NAME" property="real_name" jdbcType="VARCHAR" />
		<result column="TEL" property="tel" jdbcType="VARCHAR" />
		<result column="MOBILE" property="mobile" jdbcType="VARCHAR" />
		<result column="ADDR" property="addr" jdbcType="VARCHAR" />
		<result column="SEX" property="sex" jdbcType="SMALLINT" />
		<result column="BIRTHDAY" property="birthday" jdbcType="TIMESTAMP" />
		<result column="EMAIL" property="email" jdbcType="VARCHAR" />
		<result column="FAVOR" property="favor" jdbcType="VARCHAR" />
		<result column="IS_DEL" property="is_del" jdbcType="SMALLINT" />
		<result column="ADD_DATE" property="add_date" jdbcType="TIMESTAMP" />
		<result column="ADD_USER_ID" property="add_user_id" jdbcType="BIGINT" />
		<result column="ORDER_VALUE" property="order_value" jdbcType="VARCHAR" />
		<result column="JOB" property="job" jdbcType="VARCHAR" />
		<result column="TELEPHONE" property="telephone" jdbcType="VARCHAR" />
		<result column="FAX" property="fax" jdbcType="VARCHAR" />
		<result column="WEIXIN" property="weixin" jdbcType="VARCHAR" />
		<result column="QQ" property="qq" jdbcType="VARCHAR" />
		<result column="IS_DEFAULT" property="is_default" jdbcType="VARCHAR" />
		<result column="IS_VALID" property="is_valid" jdbcType="VARCHAR" />
		<result column="CUSTOMER_PREFERENCES" property="customer_preferences" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="konkaR3ShopLinkResult" class="konkaR3ShopLink" extends="konkaR3ShopLinkResultForList">
	</resultMap>
	
	<resultMap id="konkaR3ShopLinkForCustomerResult" class="konkaR3ShopLink" extends="konkaR3ShopLinkResultForList">
	     <result column="R3_CODE" property="map.r3_code" jdbcType="VARCHAR" />
	     <result column="CUSTOMER_NAME" property="map.customer_name" jdbcType="VARCHAR" />
	     <result column="DEPT_NAME" property="map.dept_name" jdbcType="VARCHAR"/>
	     <result column="DEPT_ID" property="map.dept_id" jdbcType="VARCHAR"/>
	     <result column="USER_NAME" property="map.user_name" jdbcType="VARCHAR"/>
	</resultMap>

	<sql id="sf-konkaR3ShopLink">
		<isNotEmpty prepend=" and " property="link_id">LINK_ID = #link_id:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="r3_shop_id">R3_SHOP_ID = #r3_shop_id:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="position">POSITION = #position:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="real_name">REAL_NAME = #real_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="tel">TEL = #tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="mobile">MOBILE = #mobile:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addr">ADDR = #addr:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sex">SEX = #sex:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="birthday">BIRTHDAY = #birthday:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="email">EMAIL = #email:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="favor">FAVOR = #favor:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">IS_DEL = #is_del:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">ADD_USER_ID = #add_user_id:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="order_value">ORDER_VALUE = #order_value:BIGINT#</isNotEmpty>
				
		<isNotEmpty prepend=" and " property="job">JOB = #job:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="telephone">TELEPHONE = #telephone:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fax">FAX = #fax:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="weixin">WEIXIN = #weixin:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="qq">QQ = #qq:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_default">IS_DEFAULT = #is_default:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_valid">IS_VALID = #is_valid:SMALLINT#</isNotEmpty>
		
		
		<isNotEmpty prepend=" and " property="map.birthday_s"><![CDATA[ BIRTHDAY >= to_date(#map.birthday_s#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.birthday_e"><![CDATA[ BIRTHDAY <= to_date(#map.birthday_e#,'yyyy-MM-dd hh24:mi:ss')]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_name_like">b.CUSTOMER_NAME like '%' || #map.customer_name_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.r3_code_like">b.R3_CODE like '%'|| #map.r3_code_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.real_name_like">REAL_NAME like '%'|| #map.real_name_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.tel_like">TEL like '%'|| #map.tel_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.mobile_like">MOBILE like '%'|| #map.mobile_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.job_like">JOB like '%'|| #map.job_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.fax_like">FAX like '%'|| #map.fax_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.email_like">EMAIL like '%'|| #map.email_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.weixin_like">WEIXIN like '%'|| #map.weixin_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.qq_like">QQ like '%'|| #map.qq_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_id">c.DEPT_ID =#map.dept_id#</isNotEmpty>
	</sql>

    <sql id="sf-konkaR3ShopLink-a">
		<isNotEmpty prepend=" and " property="link_id">a.LINK_ID = #link_id:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="r3_shop_id">a.R3_SHOP_ID = #r3_shop_id:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="position">a.POSITION = #position:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="real_name">a.REAL_NAME = #real_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="tel">a.TEL = #tel:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="mobile">a.MOBILE = #mobile:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="addr">a.ADDR = #addr:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sex">a.SEX = #sex:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="birthday">a.BIRTHDAY = #birthday:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="email">a.EMAIL = #email:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="favor">a.FAVOR = #favor:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_del">a.IS_DEL = #is_del:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">a.ADD_DATE = #add_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">a.ADD_USER_ID = #add_user_id:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="order_value">a.ORDER_VALUE = #order_value:BIGINT#</isNotEmpty>
				
		<isNotEmpty prepend=" and " property="job">a.JOB = #job:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="telephone">a.TELEPHONE = #telephone:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fax">a.FAX = #fax:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="weixin">a.WEIXIN = #weixin:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="qq">a.QQ = #qq:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_default">a.IS_DEFAULT = #is_default:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="is_valid">a.IS_VALID = #is_valid:SMALLINT#</isNotEmpty>
		
		
		<isNotEmpty prepend=" and " property="map.birthday_s"><![CDATA[ BIRTHDAY >= to_date(#map.birthday_s#,'yyyy-MM-dd hh24:mi:ss') ]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.birthday_e"><![CDATA[ BIRTHDAY <= to_date(#map.birthday_e#,'yyyy-MM-dd hh24:mi:ss')]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_name_like">b.CUSTOMER_NAME like '%' || #map.customer_name_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.r3_code_like">b.R3_CODE like '%'|| #map.r3_code_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.real_name_like">a.REAL_NAME like '%'|| #map.real_name_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.tel_like">a.TEL like '%'|| #map.tel_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.mobile_like">a.MOBILE like '%'|| #map.mobile_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.telephone_like">a.TELEPHONE like '%'|| #map.telephone_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.job_like">a.JOB like '%'|| #map.job_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.fax_like">a.FAX like '%'|| #map.fax_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.email_like">a.EMAIL like '%'|| #map.email_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.weixin_like">a.WEIXIN like '%'|| #map.weixin_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.qq_like">a.QQ like '%'|| #map.qq_like# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_id">c.DEPT_ID =#map.dept_id#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_name_like">c.DEPT_NAME like '%' || #map.dept_name_like# || '%'</isNotEmpty>
	</sql>

	<select id="selectKonkaR3ShopLink" resultMap="konkaR3ShopLinkResult" parameterClass="konkaR3ShopLink" cacheModel="oneDayCache">
		select * from KONKA_R3_SHOP_LINK where 1 = 1
		<include refid="sf-konkaR3ShopLink" />
	</select>
    
    <select id="selectKonkaR3ShopLinkForCustomer" resultMap="konkaR3ShopLinkForCustomerResult" parameterClass="konkaR3ShopLink" cacheModel="oneDayCache">
		select a.* , b.R3_CODE , b.CUSTOMER_NAME , c.DEPT_NAME , c.DEPT_ID ,d.USER_NAME from KONKA_R3_SHOP_LINK a 
		left join KONKA_R3_SHOP b on b.ID = a.R3_SHOP_ID
		left join KONKA_DEPT cc on b.branch_area_name_2 = cc.dept_sn
		left join MV_ORG_OF_CUSTOMER_ALL c on c.konka_r3_id= b.id
		left join KONKA_PE_PROD_USER d on d.ID = a.ADD_USER_ID
		where 1 = 1
		<include refid="sf-konkaR3ShopLink-a" />
	</select>
    
	<select id="selectKonkaR3ShopLinkList" resultMap="konkaR3ShopLinkResultForList" parameterClass="konkaR3ShopLink" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from KONKA_R3_SHOP_LINK where 1 = 1
		<include refid="sf-konkaR3ShopLink" />
		<isNotEmpty prepend="and" property="map.r3_code">
			R3_SHOP_ID IN
          (SELECT id
             FROM KONKA_R3_SHOP a
            WHERE a.r3_code = #map.r3_code#)
		</isNotEmpty>
		<isNotEmpty prepend="and" property="map.position_is_not_null">
			POSITION is not null
		</isNotEmpty>
		<isNotEmpty prepend="and" property="map.real_name_is_not_null">
			REAL_NAME is not null
		</isNotEmpty>
		<!-- order by ID asc -->
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectKonkaR3ShopLinkCount" resultClass="long" parameterClass="konkaR3ShopLink" cacheModel="oneDayCache">
		select count(*) from KONKA_R3_SHOP_LINK where 1 = 1
		<include refid="sf-konkaR3ShopLink" />
		<isNotEmpty prepend="and" property="map.r3_code">
			R3_SHOP_ID IN
          (SELECT id
             FROM KONKA_R3_SHOP a
            WHERE a.r3_code = #map.r3_code#)
		</isNotEmpty>
		<isNotEmpty prepend="and" property="map.position_is_not_null">
			POSITION is not null
		</isNotEmpty>
		<isNotEmpty prepend="and" property="map.real_name_is_not_null">
			REAL_NAME is not null
		</isNotEmpty>
		 <isNotEmpty prepend=" and " property="map.dept_id_start">
			(c.cur_dept_id is not null and  c.cur_dept_id in (
						select dept_id from konka_dept start with dept_id in (
						SELECT DISTINCT (dept_id)
		  							FROM KONKA_ROLE_DATA_LEVEL
		 							WHERE role_id IN (SELECT role_id
		                     			FROM KONKA_PE_ROLE_USER
		                    			WHERE user_id = #map.session_user_id#)
						) or dept_id = #map.dept_id_start# 
						connect by prior dept_id = par_id 
					)
			)
		</isNotEmpty>
		
		 <isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">
		 	c.user_id = #map.filter_by_ywy_id_eq#
		 
		 </isNotEmpty>
	</select>
	
	<select id="selectKonkaR3ShopLinkForCustomerCount" resultClass="long" parameterClass="konkaR3ShopLink" cacheModel="oneDayCache">
		select count(*) from KONKA_R3_SHOP_LINK a 
		left join KONKA_R3_SHOP b on b.ID = a.R3_SHOP_ID
		left join konka_dept cc on b.branch_area_name_2 = cc.dept_sn
		left join MV_ORG_OF_CUSTOMER_ALL c on c.konka_r3_id= b.id
		left join KONKA_PE_PROD_USER d on d.ID = a.ADD_USER_ID
		where 1 = 1
		<include refid="sf-konkaR3ShopLink-a" />
		<isNotEmpty prepend=" and " property="map.fgs_dept_value">cc.dept_id = #map.fgs_dept_value#</isNotEmpty>
		 <isNotEmpty prepend=" and " property="map.dept_id_start">
			(c.cur_dept_id is not null and  c.cur_dept_id in (
						select dept_id from konka_dept start with dept_id in (
						SELECT DISTINCT (dept_id)
		  							FROM KONKA_ROLE_DATA_LEVEL
		 							WHERE role_id IN (SELECT role_id
		                     			FROM KONKA_PE_ROLE_USER
		                    			WHERE user_id = #map.session_user_id#)
						) or dept_id = #map.dept_id_start# 
						connect by prior dept_id = par_id 
					)
			)
		</isNotEmpty>
		
		 <isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">
		 	c.user_id = #map.filter_by_ywy_id_eq#
		 
		 </isNotEmpty>
	</select>

	<select id="selectKonkaR3ShopLinkPaginatedList" resultMap="konkaR3ShopLinkResult" parameterClass="konkaR3ShopLink" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from KONKA_R3_SHOP_LINK where 1 = 1
		<include refid="sf-konkaR3ShopLink" />
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	
	<select id="selectKonkaR3ShopLinkPaginatedForCustomerList" resultMap="konkaR3ShopLinkForCustomerResult" parameterClass="konkaR3ShopLink" cacheModel="oneDayCache">
	    <![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select a.* , b.R3_CODE , b.CUSTOMER_NAME , c.DEPT_NAME , c.DEPT_ID ,d.USER_NAME from KONKA_R3_SHOP_LINK a 
		left join KONKA_R3_SHOP b on b.ID = a.R3_SHOP_ID
		left join KONKA_DEPT cc on b.branch_area_name_2 = cc.dept_sn
		left join MV_ORG_OF_CUSTOMER_ALL c on c.konka_r3_id= b.id
		left join KONKA_PE_PROD_USER d on d.id = a.ADD_USER_ID
		where 1 = 1
		<include refid="sf-konkaR3ShopLink-a" />
		<isNotEmpty prepend=" and " property="map.fgs_dept_value">cc.dept_id = #map.fgs_dept_value#</isNotEmpty>
		 <isNotEmpty prepend=" and " property="map.dept_id_start">
			(c.cur_dept_id is not null and  c.cur_dept_id in (
						select dept_id from konka_dept start with dept_id in (
						SELECT DISTINCT (dept_id)
		  							FROM KONKA_ROLE_DATA_LEVEL
		 							WHERE role_id IN (SELECT role_id
		                     			FROM KONKA_PE_ROLE_USER
		                    			WHERE user_id = #map.session_user_id#)
						) or dept_id = #map.dept_id_start# 
						connect by prior dept_id = par_id 
					)
			)
		</isNotEmpty>
		 <isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">
		 	c.user_id = #map.filter_by_ywy_id_eq#
		 
		 </isNotEmpty>		
		 order by a.LINK_ID desc 
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<insert id="insertKonkaR3ShopLink" parameterClass="konkaR3ShopLink">
		<selectKey resultClass="long" keyProperty="link_id">select BASE_SEQUENCE.nextval as link_id from dual </selectKey>
		<![CDATA[insert into KONKA_R3_SHOP_LINK (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="link_id">LINK_ID</isNotNull>	
			<isNotNull prepend="," property="r3_shop_id">R3_SHOP_ID</isNotNull>	
			<isNotNull prepend="," property="position">POSITION</isNotNull>	
			<isNotNull prepend="," property="real_name">REAL_NAME</isNotNull>	
			<isNotNull prepend="," property="tel">TEL</isNotNull>	
			<isNotNull prepend="," property="mobile">MOBILE</isNotNull>	
			<isNotNull prepend="," property="addr">ADDR</isNotNull>	
			<isNotNull prepend="," property="sex">SEX</isNotNull>	
			<isNotNull prepend="," property="birthday">BIRTHDAY</isNotNull>	
			<isNotNull prepend="," property="email">EMAIL</isNotNull>	
			<isNotNull prepend="," property="favor">FAVOR</isNotNull>	
			<isNotNull prepend="," property="is_del">IS_DEL</isNotNull>	
			<isNotNull prepend="," property="add_date">ADD_DATE</isNotNull>	
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID</isNotNull>	
			<isNotNull prepend="," property="order_value">ORDER_VALUE</isNotNull>	
			<isNotNull prepend="," property="job">JOB</isNotNull>	
			<isNotNull prepend="," property="telephone">TELEPHONE</isNotNull>	
			<isNotNull prepend="," property="fax">FAX</isNotNull>	
			<isNotNull prepend="," property="weixin">WEIXIN</isNotNull>	
			<isNotNull prepend="," property="qq">QQ</isNotNull>	
			<isNotNull prepend="," property="is_default">IS_DEFAULT</isNotNull>	
			<isNotNull prepend="," property="is_valid">IS_VALID</isNotNull>	
			<isNotNull prepend="," property="customer_preferences">CUSTOMER_PREFERENCES</isNotNull>
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="link_id">#link_id:BIGINT#</isNotNull>
			<isNotNull prepend="," property="r3_shop_id">#r3_shop_id:BIGINT#</isNotNull>
			<isNotNull prepend="," property="position">#position:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="real_name">#real_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="tel">#tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="mobile">#mobile:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="addr">#addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="sex">#sex:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="birthday">#birthday:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="email">#email:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="favor">#favor:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="is_del">#is_del:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="add_date">#add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="add_user_id">#add_user_id:BIGINT#</isNotNull>
			<isNotNull prepend="," property="order_value">#order_value:BIGINT#</isNotNull>
			<isNotNull prepend="," property="job">#job:VARCHAR#</isNotNull>	
			<isNotNull prepend="," property="telephone">#telephone:VARCHAR#</isNotNull>	
			<isNotNull prepend="," property="fax">#fax:VARCHAR#</isNotNull>	
			<isNotNull prepend="," property="weixin">#weixin:VARCHAR#</isNotNull>	
			<isNotNull prepend="," property="qq">#qq:VARCHAR#</isNotNull>	
			<isNotNull prepend="," property="is_default">#is_default:VARCHAR#</isNotNull>	
			<isNotNull prepend="," property="is_valid">#is_valid:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="customer_preferences">#customer_preferences:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateKonkaR3ShopLink" parameterClass="konkaR3ShopLink">
		update KONKA_R3_SHOP_LINK
		<dynamic prepend="set">
			<isNotNull prepend="," property="link_id">LINK_ID = #link_id:BIGINT#</isNotNull>
			<isNotNull prepend="," property="r3_shop_id">R3_SHOP_ID = #r3_shop_id:BIGINT#</isNotNull>
			<isNotNull prepend="," property="position">POSITION = #position:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="real_name">REAL_NAME = #real_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="tel">TEL = #tel:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="mobile">MOBILE = #mobile:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="addr">ADDR = #addr:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="sex">SEX = #sex:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="birthday">BIRTHDAY = #birthday:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="email">EMAIL = #email:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="favor">FAVOR = #favor:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="qq">QQ = #qq:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="weixin">WEIXIN = #weixin:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="is_del">IS_DEL = #is_del:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="is_valid">IS_VALID = #is_valid:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="is_default">IS_DEFAULT = #is_default:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="add_date">ADD_DATE = #add_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID = #add_user_id:BIGINT#</isNotNull>
			<isNotNull prepend="," property="order_value">ORDER_VALUE = #order_value:BIGINT#</isNotNull>
			<isNotNull prepend="," property="customer_preferences">CUSTOMER_PREFERENCES = #customer_preferences:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="job">JOB = #job:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="telephone">TELEPHONE = #telephone:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fax">FAX = #fax:VARCHAR#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="link_id">LINK_ID = #link_id#</isNotEmpty>
		<isEmpty prepend=" " property="link_id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteKonkaR3ShopLink" parameterClass="konkaR3ShopLink">
		delete from KONKA_R3_SHOP_LINK where
		<isNotEmpty prepend=" " property="link_id">LINK_ID = #link_id#</isNotEmpty>
		<isEmpty prepend=" " property="link_id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>
	
	<update id="deleteKonkaR3ShopLinkForR3" parameterClass="konkaR3ShopLink">
		update KONKA_R3_SHOP_LINK
		<dynamic prepend="set">
			<isNotNull prepend="," property="is_del">IS_DEL = #is_del:SMALLINT#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="r3_shop_id">R3_SHOP_ID = #r3_shop_id#</isNotEmpty>
	</update>

</sqlMap>