<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KONKA_XX_ZMD_CREDIT_APPLY">

	<typeAlias alias="konkaXxZmdCreditApply" type="com.ebiz.mmt.domain.KonkaXxZmdCreditApply" />

	

	<resultMap id="konkaXxZmdCreditApplyResultForList" class="konkaXxZmdCreditApply">
		<result column="ACC_ID" property="acc_id" jdbcType="DECIMAL" />
		<result column="DEPT_ID" property="dept_id" jdbcType="DECIMAL" />
		<result column="ZMD_ID" property="zmd_id" jdbcType="DECIMAL" />
		<result column="APPLY_USERNAME" property="apply_username" jdbcType="VARCHAR" />
		<result column="APPLY_USER_ID" property="apply_user_id" jdbcType="DECIMAL" />
		<result column="CREDIT_LINE" property="credit_line" jdbcType="DECIMAL" />
		<result column="MONEY" property="money" jdbcType="DECIMAL" />
		<result column="APPLY_REASON" property="apply_reason" jdbcType="VARCHAR" />
		<result column="APPLY_DATE" property="apply_date" jdbcType="DATETIME" />
		<result column="AUDIT_STATE" property="audit_state" jdbcType="DECIMAL" />
		<result column="AUDIT_USER_ID" property="audit_user_id" jdbcType="DECIMAL" />
		<result column="AUDIT_MEMO" property="audit_memo" jdbcType="VARCHAR" />
		<result column="AUDIT_DATE" property="audit_date" jdbcType="DATETIME" />
		<result column="CREDIT_ID" property="credit_id" jdbcType="DECIMAL" />
	</resultMap>

	<resultMap id="konkaXxZmdCreditApplyResult" class="konkaXxZmdCreditApply" extends="konkaXxZmdCreditApplyResultForList">
	</resultMap>

	<!-- 2013-03-28 Hu,Hao -->
	<resultMap id="konkaXxZmdCreditApplyForTypeResult" class="konkaXxZmdCreditApply" extends="konkaXxZmdCreditApplyResultForList">
		<result column="credit_type" property="map.credit_type" jdbcType="DECIMAL" />
	</resultMap>

	<sql id="sf-konkaXxZmdCreditApply">
		<isNotEmpty prepend=" and " property="acc_id">ACC_ID = #acc_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dept_id">DEPT_ID = #dept_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="zmd_id">ZMD_ID = #zmd_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="apply_username">APPLY_USERNAME = #apply_username:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="apply_user_id">APPLY_USER_ID = #apply_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="credit_line">CREDIT_LINE = #credit_line:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="money">MONEY = #money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="apply_reason">APPLY_REASON = #apply_reason:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="apply_date">APPLY_DATE = #apply_date:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="audit_state">AUDIT_STATE = #audit_state:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="audit_user_id">AUDIT_USER_ID = #audit_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="audit_memo">AUDIT_MEMO = #audit_memo:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="audit_date">AUDIT_DATE = #audit_date:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="credit_id">CREDIT_ID = #credit_id:DECIMAL#</isNotEmpty>
		
		<isNotEmpty prepend=" and " property="map.zmd_sn_like">zmd_id in (select zmd_id from konka_xx_zmd where zmd_sn like '%' || #map.zmd_sn_like# || '%')</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.noAudit"><![CDATA[AUDIT_STATE < #map.noAudit#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.notAccid"><![CDATA[acc_id <> #map.notAccid#]]></isNotEmpty>
	</sql>

	<select id="selectKonkaXxZmdCreditApply" resultMap="konkaXxZmdCreditApplyResult" parameterClass="konkaXxZmdCreditApply" >
		select * from KONKA_XX_ZMD_CREDIT_APPLY where 1 = 1
		<include refid="sf-konkaXxZmdCreditApply" />
	</select>

	<select id="selectKonkaXxZmdCreditApplyList" resultMap="konkaXxZmdCreditApplyResultForList" parameterClass="konkaXxZmdCreditApply" >
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from KONKA_XX_ZMD_CREDIT_APPLY where 1 = 1
		<include refid="sf-konkaXxZmdCreditApply" />
		order by ACC_ID desc
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectKonkaXxZmdCreditApplyCount" resultClass="long" parameterClass="konkaXxZmdCreditApply" >
		select count(*) from KONKA_XX_ZMD_CREDIT_APPLY where 1 = 1
		<include refid="sf-konkaXxZmdCreditApply" />
	</select>

	<select id="selectKonkaXxZmdCreditApplyPaginatedList" resultMap="konkaXxZmdCreditApplyResult" parameterClass="konkaXxZmdCreditApply" >
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from KONKA_XX_ZMD_CREDIT_APPLY where 1 = 1
		<include refid="sf-konkaXxZmdCreditApply" />
		order by ACC_ID desc
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<!-- 2013-03-28 Hu,Hao -->
	<select id="selectKonkaXxZmdCreditApplyForTypePaginatedList" resultMap="konkaXxZmdCreditApplyForTypeResult" parameterClass="konkaXxZmdCreditApply" >
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select aa.*, bb.credit_type as credit_type
  			from konka_xx_zmd_credit_apply aa
  			left join konka_xx_zmd_credit bb on aa.credit_id = bb.id
  		<isNotEmpty prepend=" and " property="dept_id">aa.DEPT_ID = #dept_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="zmd_id">aa.ZMD_ID = #zmd_id:DECIMAL#</isNotEmpty>
		order by ACC_ID desc
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<insert id="insertKonkaXxZmdCreditApply" parameterClass="konkaXxZmdCreditApply">
		<selectKey resultClass="long" keyProperty="acc_id">select KONKA_XX_BASE_SEQ.nextval as acc_id from dual </selectKey>
		<![CDATA[insert into KONKA_XX_ZMD_CREDIT_APPLY (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="acc_id">ACC_ID</isNotNull>	
			<isNotNull prepend="," property="dept_id">DEPT_ID</isNotNull>	
			<isNotNull prepend="," property="zmd_id">ZMD_ID</isNotNull>	
			<isNotNull prepend="," property="apply_username">APPLY_USERNAME</isNotNull>	
			<isNotNull prepend="," property="apply_user_id">APPLY_USER_ID</isNotNull>	
			<isNotNull prepend="," property="credit_line">CREDIT_LINE</isNotNull>	
			<isNotNull prepend="," property="money">MONEY</isNotNull>	
			<isNotNull prepend="," property="apply_reason">APPLY_REASON</isNotNull>	
			<isNotNull prepend="," property="apply_date">APPLY_DATE</isNotNull>	
			<isNotNull prepend="," property="audit_state">AUDIT_STATE</isNotNull>	
			<isNotNull prepend="," property="audit_user_id">AUDIT_USER_ID</isNotNull>	
			<isNotNull prepend="," property="audit_memo">AUDIT_MEMO</isNotNull>	
			<isNotNull prepend="," property="audit_date">AUDIT_DATE</isNotNull>
			<isNotNull prepend="," property="credit_id">CREDIT_ID</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="acc_id">#acc_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="dept_id">#dept_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="zmd_id">#zmd_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="apply_username">#apply_username:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="apply_user_id">#apply_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="credit_line">#credit_line:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="money">#money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="apply_reason">#apply_reason:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="apply_date">#apply_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="audit_state">#audit_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="audit_user_id">#audit_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="audit_memo">#audit_memo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="audit_date">#audit_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="credit_id">#credit_id:DECIMAL#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateKonkaXxZmdCreditApply" parameterClass="KonkaXxZmdCreditApply">
		update KONKA_XX_ZMD_CREDIT_APPLY
		<dynamic prepend="set">
			<isNotNull prepend="," property="acc_id">ACC_ID = #acc_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="dept_id">DEPT_ID = #dept_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="zmd_id">ZMD_ID = #zmd_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="apply_username">APPLY_USERNAME = #apply_username:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="apply_user_id">APPLY_USER_ID = #apply_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="credit_line">CREDIT_LINE = #credit_line:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="money">MONEY = #money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="apply_reason">APPLY_REASON = #apply_reason:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="apply_date">APPLY_DATE = #apply_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="audit_state">AUDIT_STATE = #audit_state:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="audit_user_id">AUDIT_USER_ID = #audit_user_id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="audit_memo">AUDIT_MEMO = #audit_memo:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="audit_date">AUDIT_DATE = #audit_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="credit_id">CREDIT_ID = #credit_id:DECIMAL#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="acc_id">ACC_ID = #acc_id#</isNotEmpty>
		<isEmpty prepend=" " property="acc_id">
			<isNotEmpty prepend=" " property="map.pks">
				ACC_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
			<isNotEmpty prepend=" " property="map.pkss">
				ACC_ID in
				<iterate close=")" open="(" conjunction="," property="map.pkss">#map.pkss[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteKonkaXxZmdCreditApply" parameterClass="KonkaXxZmdCreditApply">
		delete from KONKA_XX_ZMD_CREDIT_APPLY where
		<isNotEmpty prepend=" " property="acc_id">ACC_ID = #acc_id#</isNotEmpty>
		<isEmpty prepend=" " property="acc_id">
			<isNotEmpty prepend=" " property="map.pks">
				ACC_ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

</sqlMap>