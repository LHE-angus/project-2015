<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="AREA_FIGHT_INFO">

	<typeAlias alias="areaFightInfo" type="com.ebiz.mmt.domain.AreaFightInfo" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertAreaFightInfo" />
		<flushOnExecute statement="updateAreaFightInfo" />
		<flushOnExecute statement="deleteAreaFightInfo" />
	</cacheModel>

	<resultMap id="areaFightInfoResultForList" class="areaFightInfo">
		<result column="ID" property="id" jdbcType="BIGINT" />
		<result column="P_INDEX" property="p_index" jdbcType="BIGINT" />
		<result column="AREA_NAME" property="area_name" jdbcType="VARCHAR" />
		<result column="T_TYPE" property="t_type" jdbcType="SMALLINT" />
		<result column="T_NUM" property="t_num" jdbcType="SMALLINT" />
		<result column="GDP" property="gdp" jdbcType="BIGINT" />
		<result column="HUMAN_NUM" property="human_num" jdbcType="BIGINT" />
		<result column="AREA_SIZE" property="area_size" jdbcType="BIGINT" />
		<result column="MARKET_MONEY" property="market_money" jdbcType="BIGINT" />
		<result column="MARKET_NUM" property="market_num" jdbcType="BIGINT" />
		<result column="JD_IN" property="jd_in" jdbcType="SMALLINT" />
		<result column="KONKA_IN" property="konka_in" jdbcType="SMALLINT" />
		<result column="KONKA_RANK" property="konka_rank" jdbcType="SMALLINT" />
		<result column="MARKET_RATE" property="market_rate" jdbcType="SMALLINT" />
		<result column="FIRST_COMP" property="first_comp" jdbcType="VARCHAR" />
		<result column="SECOND_COMP" property="second_comp" jdbcType="VARCHAR" />
		<result column="THIRD_COMP" property="third_comp" jdbcType="VARCHAR" />
		<result column="NOT_IN_REASON" property="not_in_reason" jdbcType="VARCHAR" />
		<result column="IN_DATE" property="in_date" jdbcType="TIMESTAMP" />
		<result column="T_STATUS" property="t_status" jdbcType="SMALLINT" />
		<result column="MODIFY_USER_ID" property="modify_user_id" jdbcType="BIGINT" />
		<result column="MODIFY_DATE" property="modify_date" jdbcType="TIMESTAMP" />
		<result column="DEPT_ID" property="dept_id" jdbcType="BIGINT" />
	</resultMap>

	<resultMap id="areaFightInfoResult" class="areaFightInfo" extends="areaFightInfoResultForList">
	</resultMap>
	
	<resultMap id="areaFightInfoResult-t" class="areaFightInfo" extends="areaFightInfoResultForList">
	    <result column="MODIFY_DATE_T" property="map.modify_date_t" jdbcType="VARCHAR" />
	    <result column="USER_NAME" property="map.user_name" jdbcType="VARCHAR" />
	</resultMap>

	<sql id="sf-areaFightInfo">
		<isNotEmpty prepend=" and " property="id">a.ID = #id:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="p_index">a.P_INDEX = #p_index:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="area_name">a.AREA_NAME = #area_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="t_type">a.T_TYPE = #t_type:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="t_num">a.T_NUM = #t_num:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="gdp">a.GDP = #gdp:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="human_num">a.HUMAN_NUM = #human_num:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="area_size">a.AREA_SIZE = #area_size:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="market_money">a.MARKET_MONEY = #market_money:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="market_num">a.MARKET_NUM = #market_num:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="jd_in">a.JD_IN = #jd_in:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="konka_in">a.KONKA_IN = #konka_in:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="konka_rank">a.KONKA_RANK = #konka_rank:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="market_rate">a.MARKET_RATE = #market_rate:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="first_comp">a.FIRST_COMP = #first_comp:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="second_comp">a.SECOND_COMP = #second_comp:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="third_comp">a.THIRD_COMP = #third_comp:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="not_in_reason">a.NOT_IN_REASON = #not_in_reason:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="in_date">a.IN_DATE = #in_date:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="t_status">a.T_STATUS = #t_status:SMALLINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="modify_user_id">a.MODIFY_USER_ID = #modify_user_id:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="dept_id">a.DEPT_ID = #dept_id:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.town">
		    P.P_INDEX in (select P_INDEX from KONKA_BASE_PROVINCE_LIST_FOUR start with P_INDEX = #map.town:BIGINT# connect by prior P_INDEX = PAR_INDEX )
		</isNotEmpty>
		<isEmpty prepend=" " property="map.town">
		    <isNotEmpty prepend=" and " property="map.country">
			    P.P_INDEX in (select P_INDEX from KONKA_BASE_PROVINCE_LIST_FOUR start with P_INDEX = #map.country:BIGINT# connect by prior P_INDEX = PAR_INDEX )
			</isNotEmpty>
			<isEmpty prepend="  " property="map.country">
			    <isNotEmpty prepend=" and " property="map.city">
				    P.P_INDEX in (select P_INDEX from KONKA_BASE_PROVINCE_LIST_FOUR start with P_INDEX = #map.city:BIGINT# connect by prior P_INDEX = PAR_INDEX )
				</isNotEmpty>
				<isEmpty prepend="  " property="map.city">
				    <isNotEmpty prepend=" and " property="map.province">
					    P.P_INDEX in (select P_INDEX from KONKA_BASE_PROVINCE_LIST_FOUR start with P_INDEX = #map.province:BIGINT# connect by prior P_INDEX = PAR_INDEX )
					</isNotEmpty>
				</isEmpty>
			</isEmpty>
		</isEmpty>
		<isNotEmpty prepend=" and " property="map.p_index">p.P_INDEX = #map.p_index:BIGINT#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.modify_name">u.user_name = #map.modify_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.modify_date">to_char(a.MODIFY_DATE,'yyyy-MM-dd') = #map.modify_date:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.market_money_begin"><![CDATA[a.MARKET_MONEY >= #map.market_money_begin:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.market_money_end"><![CDATA[a.MARKET_MONEY <= #map.market_money_end:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.market_num_begin"><![CDATA[a.MARKET_NUM >= #map.market_num_begin:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.market_num_end"><![CDATA[a.MARKET_NUM <= #map.market_num_end:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.market_prop_begin"><![CDATA[a.MARKET_RATE >= #map.market_prop_begin:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.market_prop_end"><![CDATA[a.MARKET_RATE <= #map.market_prop_end:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.t_num_begin"><![CDATA[a.T_NUM >= #map.t_num_begin:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.t_num_end"><![CDATA[a.T_NUM <= #map.t_num_end:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.kh_num_begin"><![CDATA[a.KH_NUM >= #map.kh_num_begin:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.kh_num_end"><![CDATA[a.KH_NUM <= #map.kh_num_end:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.agent_num_begin"><![CDATA[a.AGENT_NUM >= #map.agent_num_begin:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.agent_num_end"><![CDATA[a.AGENT_NUM <= #map.agent_num_end:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.gdp_begin"><![CDATA[a.GDP >= #map.gdp_begin:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.gdp_end"><![CDATA[a.GDP <= #map.gdp_end:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.human_num_begin"><![CDATA[a.HUMAN_NUM >= #map.human_num_begin:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.human_num_begin"><![CDATA[a.HUMAN_NUM <= #map.human_num_end:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.area_size_begin"><![CDATA[a.AREA_SIZE >= #map.area_size_begin:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.area_size_end"><![CDATA[a.AREA_SIZE <= #map.area_size_end:BIGINT#]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_id"> a.DEPT_ID = #map.dept_id:BIGINT#</isNotEmpty>
	</sql>

	<select id="selectAreaFightInfo" resultMap="areaFightInfoResult-t" parameterClass="areaFightInfo" cacheModel="oneDayCache">
		select a.*,to_char(a.modify_date,'yyyy-MM-dd') modify_date_t,u.user_name from AREA_FIGHT_INFO a 
		left join konka_pe_prod_user u on a.modify_user_id=u.id
		where 1 = 1
		<include refid="sf-areaFightInfo" />
	</select>

	<select id="selectAreaFightInfoList" resultMap="areaFightInfoResultForList" parameterClass="areaFightInfo" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from AREA_FIGHT_INFO a 
		left join konka_pe_prod_user u on a.modify_user_id=u.id
		where 1 = 1
		<include refid="sf-areaFightInfo" />
		<!-- order by ID asc -->
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>

	<select id="selectAreaFightInfoCount" resultClass="long" parameterClass="areaFightInfo" cacheModel="oneDayCache">
		select count(*) from AREA_FIGHT_INFO a where 1 = 1
		<include refid="sf-areaFightInfo" />
	</select>

	<select id="selectAreaFightInfoPaginatedList" resultMap="areaFightInfoResult" parameterClass="areaFightInfo" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from AREA_FIGHT_INFO a where 1 = 1
		<include refid="sf-areaFightInfo" />
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<insert id="insertAreaFightInfo" parameterClass="areaFightInfo">
		<selectKey resultClass="long" keyProperty="id">select SEQ_AREA_FIGHT.nextval as id from dual </selectKey>
		<![CDATA[insert into AREA_FIGHT_INFO (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">ID</isNotNull>	
			<isNotNull prepend="," property="p_index">P_INDEX</isNotNull>	
			<isNotNull prepend="," property="area_name">AREA_NAME</isNotNull>	
			<isNotNull prepend="," property="t_type">T_TYPE</isNotNull>	
			<isNotNull prepend="," property="t_num">T_NUM</isNotNull>	
			<isNotNull prepend="," property="gdp">GDP</isNotNull>	
			<isNotNull prepend="," property="human_num">HUMAN_NUM</isNotNull>	
			<isNotNull prepend="," property="area_size">AREA_SIZE</isNotNull>	
			<isNotNull prepend="," property="market_money">MARKET_MONEY</isNotNull>	
			<isNotNull prepend="," property="market_num">MARKET_NUM</isNotNull>	
			<isNotNull prepend="," property="jd_in">JD_IN</isNotNull>	
			<isNotNull prepend="," property="konka_in">KONKA_IN</isNotNull>	
			<isNotNull prepend="," property="konka_rank">KONKA_RANK</isNotNull>	
			<isNotNull prepend="," property="market_rate">MARKET_RATE</isNotNull>	
			<isNotNull prepend="," property="first_comp">FIRST_COMP</isNotNull>	
			<isNotNull prepend="," property="second_comp">SECOND_COMP</isNotNull>	
			<isNotNull prepend="," property="third_comp">THIRD_COMP</isNotNull>	
			<isNotNull prepend="," property="not_in_reason">NOT_IN_REASON</isNotNull>	
			<isNotNull prepend="," property="in_date">IN_DATE</isNotNull>	
			<isNotNull prepend="," property="t_status">T_STATUS</isNotNull>	
			<isNotNull prepend="," property="modify_user_id">MODIFY_USER_ID</isNotNull>	
			<isNotNull prepend="," property="modify_date">MODIFY_DATE</isNotNull>	
			<isNotNull prepend="," property="dept_id">DEPT_ID</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">#id:BIGINT#</isNotNull>
			<isNotNull prepend="," property="p_index">#p_index:BIGINT#</isNotNull>
			<isNotNull prepend="," property="area_name">#area_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="t_type">#t_type:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="t_num">#t_num:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="gdp">#gdp:BIGINT#</isNotNull>
			<isNotNull prepend="," property="human_num">#human_num:BIGINT#</isNotNull>
			<isNotNull prepend="," property="area_size">#area_size:BIGINT#</isNotNull>
			<isNotNull prepend="," property="market_money">#market_money:BIGINT#</isNotNull>
			<isNotNull prepend="," property="market_num">#market_num:BIGINT#</isNotNull>
			<isNotNull prepend="," property="jd_in">#jd_in:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="konka_in">#konka_in:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="konka_rank">#konka_rank:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="market_rate">#market_rate:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="first_comp">#first_comp:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="second_comp">#second_comp:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="third_comp">#third_comp:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="not_in_reason">#not_in_reason:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="in_date">#in_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="t_status">#t_status:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="modify_user_id">#modify_user_id:BIGINT#</isNotNull>
			<isNotNull prepend="," property="modify_date">#modify_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="dept_id">#dept_id:BIGINT#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateAreaFightInfo" parameterClass="AreaFightInfo">
		update AREA_FIGHT_INFO
		<dynamic prepend="set">
			<isNotNull prepend="," property="id">ID = #id:BIGINT#</isNotNull>
			<isNotNull prepend="," property="p_index">P_INDEX = #p_index:BIGINT#</isNotNull>
			<isNotNull prepend="," property="area_name">AREA_NAME = #area_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="t_type">T_TYPE = #t_type:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="t_num">T_NUM = #t_num:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="gdp">GDP = #gdp:BIGINT#</isNotNull>
			<isNotNull prepend="," property="human_num">HUMAN_NUM = #human_num:BIGINT#</isNotNull>
			<isNotNull prepend="," property="area_size">AREA_SIZE = #area_size:BIGINT#</isNotNull>
			<isNotNull prepend="," property="market_money">MARKET_MONEY = #market_money:BIGINT#</isNotNull>
			<isNotNull prepend="," property="market_num">MARKET_NUM = #market_num:BIGINT#</isNotNull>
			<isNotNull prepend="," property="jd_in">JD_IN = #jd_in:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="konka_in">KONKA_IN = #konka_in:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="konka_rank">KONKA_RANK = #konka_rank:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="market_rate">MARKET_RATE = #market_rate:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="first_comp">FIRST_COMP = #first_comp:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="second_comp">SECOND_COMP = #second_comp:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="third_comp">THIRD_COMP = #third_comp:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="not_in_reason">NOT_IN_REASON = #not_in_reason:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="in_date">IN_DATE = #in_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="t_status">T_STATUS = #t_status:SMALLINT#</isNotNull>
			<isNotNull prepend="," property="modify_user_id">MODIFY_USER_ID = #modify_user_id:BIGINT#</isNotNull>
			<isNotNull prepend="," property="modify_date">MODIFY_DATE = #modify_date:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="dept_id">DEPT_ID = #dept_id:BIGINT#</isNotNull>
		</dynamic>
		where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isNotEmpty prepend=" " property="p_index">P_INDEX = #p_index:BIGINT#</isNotEmpty>
		<!-- <isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty> -->
	</update>

	<delete id="deleteAreaFightInfo" parameterClass="AreaFightInfo">
		delete from AREA_FIGHT_INFO where
		<isNotEmpty prepend=" " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>
	
	<!-- 区域作战分析表总数 -->
	<select id="selectTotalCount" resultClass="long" parameterClass="areaFightInfo" cacheModel="oneDayCache">
		 select count(1) from KONKA_BASE_PROVINCE_LIST_FOUR p 
		 left join AREA_FIGHT_INFO a on p.P_INDEX=a.P_INDEX
	     left join konka_pe_prod_user u on a.modify_user_id=u.id
		 where 1 = 1 and p.DEL_MARK=0 and p.P_LEVEL=4 
		<include refid="sf-areaFightInfo" />
	</select>
	
	<!-- 存储过程查询区域作战列表 -->
	<parameterMap class="java.util.HashMap" id="cursorMap">
		<parameter property="I_AREA_NAME" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_PROVINCE" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_CITY" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_COUNTRY" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_TOWN" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_P_INDEX" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_T_TYPE" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_T_STATUS" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_MODIFY_NAME" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_MODIFY_DATE" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_JD_IN" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_KONKA_IN" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_KONKA_RANK" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_FIRST_COMP" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_SECOND_COMP" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_THIRD_COMP" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_M_MONEY_B" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_M_MONEY_E" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_M_NUM_B" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_M_NUM_E" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_M_RATE_B" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_M_RATE_E" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_T_NUM_B" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_T_NUM_E" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_GDP_B" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_GDP_E" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_HUMAN_B" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_HUMAN_E" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_AREA_B" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_AREA_E" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="I_DEPT_ID" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="FIRST_ROW" jdbcType="VARCHAR" javaType="java.lang.Integer" mode="IN"/>
		<parameter property="COUNT_ROW" jdbcType="VARCHAR" javaType="java.lang.Integer" mode="IN"/>
		<parameter property="I_EXPORT" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="SQL_CODE" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
		<parameter property="KH_TOTAL" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
		<parameter property="AGENT_TOTAL" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
		<parameter property="C_MONEY" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
		<parameter property="C_NUM" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
		<parameter property="S_MONEY" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
		<parameter property="S_NUM" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
	</parameterMap>
	<procedure id="selectAreaFightListForMap" parameterMap="cursorMap" resultClass="java.util.HashMap">
		{call SELECT_AREA_INFO(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
	</procedure>
	
	<!-- 指定乡镇下的客户、门店、网点总数 -->
	<select id="selectDetailCount" resultClass="long" parameterClass="areaFightInfo" cacheModel="oneDayCache">
		select sum(c) from (
			select count(1) c from konka_r3_shop 
              where is_del=0 and is_konka=1 and BRANCH_AREA_NAME_2 not in ('KFDFD001','KF001','KFSF001') 
              <isNotEmpty prepend=" and " property="map.p_index">ENTP_P_INDEX = #map.p_index:BIGINT#</isNotEmpty>
		  union
		   	select count(1) c from j_base_partner where is_del=0 
		   	  <isNotEmpty prepend=" and " property="map.p_index">Area_code = #map.p_index:BIGINT#</isNotEmpty>
		  union
			select count(1) c from konka_r3_store where is_del=0 
			  <isNotEmpty prepend=" and " property="map.p_index">P_INDEX = #map.p_index:BIGINT#</isNotEmpty>
		)
	</select>
	
	<!-- 存储过程查询指定乡镇下的客户、门店、网点详情列表 -->
	<parameterMap class="java.util.HashMap" id="cursorMap">
		<parameter property="I_P_INDEX" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="FIRST_ROW" jdbcType="VARCHAR" javaType="java.lang.Integer" mode="IN"/>
		<parameter property="COUNT_ROW" jdbcType="VARCHAR" javaType="java.lang.Integer" mode="IN"/>
	</parameterMap>
	<procedure id="selectAreaFightDetailList" parameterMap="cursorMap" resultClass="java.util.HashMap">
		{call SELECT_AREA_DETAIL(?,?,?)}
	</procedure>

	<!-- 自动计算区域结算销售数据 -->
	<procedure id="autoCountAreaInfo" resultClass="long" cacheModel="oneDayCache">
		${call AUTO_COUNT_AREA_INFO()}
	</procedure>
</sqlMap>