

SELECT b.*,
       c.CUSTOMER_NAME,
       c.R3_CODE,
       d.DEPT_NAME
  FROM (SELECT t.CUSTOMERID, t.deptid, count (1)
          FROM CRM_CUSTOMER_GROUP_DETAILS t
        GROUP BY t.CUSTOMERID, t.deptid
        HAVING count (1) >= 2) b
       LEFT JOIN KONKA_R3_SHOP c ON b.CUSTOMERID = c.ID
       LEFT JOIN KONKA_DEPT d ON b.DEPTID = d.DEPT_ID ;
       
       
SELECT x.*,
       y.BRANCH_AREA_NAME,
       y.CUSTOMER_CODE,
       y.CUSTOMER_NAME
  FROM (SELECT t.CUSTOMERID, count (1)
          FROM CRM_CUSTOMER_GROUP_DETAILS t
        GROUP BY t.CUSTOMERID
        HAVING count (1) >= 2) x
       LEFT JOIN KONKA_R3_SHOP y ON x.CUSTOMERID = y.ID


--客户维护多个客户群组
SELECT t.CUSTOMERID,count(1)
          FROM CRM_CUSTOMER_GROUP_DETAILS t
        GROUP BY t.CUSTOMERID
        HAVING count (1) >= 2;