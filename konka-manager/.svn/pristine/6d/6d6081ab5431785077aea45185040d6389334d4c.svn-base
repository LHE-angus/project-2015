<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KONKA_R3_SELL_IMP_INVALID_DATA">

	<typeAlias alias="konkaR3SellImpInvalidData" type="com.ebiz.mmt.domain.KonkaR3SellImpInvalidData" />

	

	<resultMap id="konkaR3SellImpInvalidDataResultForList" class="konkaR3SellImpInvalidData">
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="R3_SELL_DATE" property="r3_sell_date" jdbcType="DATETIME" />
		<result column="R3_CODE" property="r3_code" jdbcType="VARCHAR" />
		<result column="F" property="f" jdbcType="VARCHAR" />
		<result column="TYPE_DESC" property="type_desc" jdbcType="VARCHAR" />
		<result column="R3_NAME" property="r3_name" jdbcType="VARCHAR" />
		<result column="SEND_R3_NAME" property="send_r3_name" jdbcType="VARCHAR" />
		<result column="SEND_R3_CODE" property="send_r3_code" jdbcType="VARCHAR" />
		<result column="CREAT_DATE" property="creat_date" jdbcType="DATETIME" />
		<result column="ORDER_SN" property="order_sn" jdbcType="VARCHAR" />
		<result column="ORDER_TYPE" property="order_type" jdbcType="VARCHAR" />
		<result column="PROJECT" property="project" jdbcType="VARCHAR" />
		<result column="PD_NAME" property="pd_name" jdbcType="VARCHAR" />
		<result column="COUNT" property="count" jdbcType="DECIMAL" />
		<result column="PRICE" property="price" jdbcType="DECIMAL" />
		<result column="SUM_MONEY" property="sum_money" jdbcType="DECIMAL" />
		<result column="K007_MONEY" property="k007_money" jdbcType="DECIMAL" />
		<result column="RB00_MONEY" property="rb00_money" jdbcType="DECIMAL" />
		<result column="ZJZ_MONEY" property="zjz_money" jdbcType="DECIMAL" />
		<result column="JH_DATE" property="jh_date" jdbcType="DATETIME" />
		<result column="KF_JH_BILL" property="kf_jh_bill" jdbcType="VARCHAR" />
		<result column="WL_JH_BILL" property="wl_jh_bill" jdbcType="VARCHAR" />
		<result column="FH_STORE" property="fh_store" jdbcType="VARCHAR" />
		<result column="PURCHASE_ORDER_SN" property="purchase_order_sn" jdbcType="VARCHAR" />
		<result column="CUSTOM_WL_SN" property="custom_wl_sn" jdbcType="VARCHAR" />
		<result column="BSC" property="bsc" jdbcType="VARCHAR" />
		<result column="SELL_ORG" property="sell_org" jdbcType="VARCHAR" />
		<result column="ADD_DATE" property="add_date" jdbcType="DATETIME" />
		<result column="ADD_USER_ID" property="add_user_id" jdbcType="DECIMAL" />
	</resultMap>

	<resultMap id="konkaR3SellImpInvalidDataResult" class="konkaR3SellImpInvalidData" extends="konkaR3SellImpInvalidDataResultForList">
	</resultMap>

	<sql id="sf-konkaR3SellImpInvalidData">
		<isNotEmpty prepend=" and " property="id">a.ID = #id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="r3_sell_date">a.R3_SELL_DATE = #r3_sell_date:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="r3_code">a.R3_CODE = #r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="f">a.F = #f:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="type_desc">a.TYPE_DESC = #type_desc:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="r3_name">a.R3_NAME = #r3_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="send_r3_name">a.SEND_R3_NAME = #send_r3_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="send_r3_code">a.SEND_R3_CODE = #send_r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="creat_date">a.CREAT_DATE = #creat_date:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="order_sn">a.ORDER_SN = #order_sn:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="order_type">a.ORDER_TYPE = #order_type:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="project">a.PROJECT = #project:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="pd_name">a.PD_NAME = #pd_name:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="count">a.COUNT = #count:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="price">a.PRICE = #price:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sum_money">a.SUM_MONEY = #sum_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="k007_money">a.K007_MONEY = #k007_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="rb00_money">a.RB00_MONEY = #rb00_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="zjz_money">a.ZJZ_MONEY = #zjz_money:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="jh_date">a.JH_DATE = #jh_date:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="kf_jh_bill">a.KF_JH_BILL = #kf_jh_bill:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="wl_jh_bill">a.WL_JH_BILL = #wl_jh_bill:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="fh_store">a.FH_STORE = #fh_store:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="purchase_order_sn">a.PURCHASE_ORDER_SN = #purchase_order_sn:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="custom_wl_sn">a.CUSTOM_WL_SN = #custom_wl_sn:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="bsc">a.BSC = #bsc:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="sell_org">a.SELL_ORG = #sell_org:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_date">a.ADD_DATE = #add_date:DATETIME#</isNotEmpty>
		<isNotEmpty prepend=" and " property="add_user_id">a.ADD_USER_ID = #add_user_id:DECIMAL#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.start_date"><![CDATA[to_date(#map.start_date#, 'YYYY-MM-DD') <= a.R3_SELL_DATE]]></isNotEmpty>
		<isNotEmpty prepend=" and " property="map.end_date"><![CDATA[a.R3_SELL_DATE <= to_date(#map.end_date#  || ' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')]]></isNotEmpty>
	</sql>

	<select id="selectKonkaR3SellImpInvalidData" resultMap="konkaR3SellImpInvalidDataResult" parameterClass="konkaR3SellImpInvalidData" >
		select * from KONKA_R3_SELL_IMP_INVALID_DATA a where 1 = 1
		<include refid="sf-konkaR3SellImpInvalidData" />
	</select>

	<select id="selectKonkaR3SellImpInvalidDataList" resultMap="konkaR3SellImpInvalidDataResultForList" parameterClass="konkaR3SellImpInvalidData" >
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( ]]>
		</isNotEmpty>
		select * from KONKA_R3_SELL_IMP_INVALID_DATA a where 1 = 1
		<include refid="sf-konkaR3SellImpInvalidData" />
		<!-- order by ID asc -->
		<isNotEmpty property="row.count">
			<![CDATA[ ) where rownum <= #row.count# ]]>
		</isNotEmpty>
	</select>
	
	<select id="selectKonkaR3SellImpInvalidDataCount" resultClass="long" parameterClass="konkaR3SellImpInvalidData" >
		select count(*) from KONKA_R3_SELL_IMP_INVALID_DATA a where 1 = 1
		<include refid="sf-konkaR3SellImpInvalidData" />
	</select>

	<select id="selectKonkaR3SellImpInvalidDataPaginatedList" resultMap="konkaR3SellImpInvalidDataResult" parameterClass="konkaR3SellImpInvalidData" >
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from KONKA_R3_SELL_IMP_INVALID_DATA a where 1 = 1
		<include refid="sf-konkaR3SellImpInvalidData" />
		<!-- order by ID asc -->
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<select id="selectOrderSnGroupList" resultClass="java.util.HashMap"  parameterClass="konkaR3SellImpInvalidData">
		select a.order_sn from KONKA_R3_SELL_IMP_INVALID_DATA a where 1 = 1  
		<include refid="sf-konkaR3SellImpInvalidData" />
		group by a.order_sn
	</select>

	<insert id="insertKonkaR3SellImpInvalidData" parameterClass="konkaR3SellImpInvalidData">
		<selectKey resultClass="long" keyProperty="id">select SEQ_KONKA_JXC.nextval as id from dual</selectKey>
		<![CDATA[insert into KONKA_R3_SELL_IMP_INVALID_DATA (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">ID</isNotNull>	
			<isNotNull prepend="," property="r3_sell_date">R3_SELL_DATE</isNotNull>	
			<isNotNull prepend="," property="r3_code">R3_CODE</isNotNull>	
			<isNotNull prepend="," property="f">F</isNotNull>	
			<isNotNull prepend="," property="type_desc">TYPE_DESC</isNotNull>	
			<isNotNull prepend="," property="r3_name">R3_NAME</isNotNull>	
			<isNotNull prepend="," property="send_r3_name">SEND_R3_NAME</isNotNull>	
			<isNotNull prepend="," property="send_r3_code">SEND_R3_CODE</isNotNull>	
			<isNotNull prepend="," property="creat_date">CREAT_DATE</isNotNull>	
			<isNotNull prepend="," property="order_sn">ORDER_SN</isNotNull>	
			<isNotNull prepend="," property="order_type">ORDER_TYPE</isNotNull>	
			<isNotNull prepend="," property="project">PROJECT</isNotNull>	
			<isNotNull prepend="," property="pd_name">PD_NAME</isNotNull>	
			<isNotNull prepend="," property="count">COUNT</isNotNull>	
			<isNotNull prepend="," property="price">PRICE</isNotNull>	
			<isNotNull prepend="," property="sum_money">SUM_MONEY</isNotNull>	
			<isNotNull prepend="," property="k007_money">K007_MONEY</isNotNull>	
			<isNotNull prepend="," property="rb00_money">RB00_MONEY</isNotNull>	
			<isNotNull prepend="," property="zjz_money">ZJZ_MONEY</isNotNull>	
			<isNotNull prepend="," property="jh_date">JH_DATE</isNotNull>	
			<isNotNull prepend="," property="kf_jh_bill">KF_JH_BILL</isNotNull>	
			<isNotNull prepend="," property="wl_jh_bill">WL_JH_BILL</isNotNull>	
			<isNotNull prepend="," property="fh_store">FH_STORE</isNotNull>	
			<isNotNull prepend="," property="purchase_order_sn">PURCHASE_ORDER_SN</isNotNull>	
			<isNotNull prepend="," property="custom_wl_sn">CUSTOM_WL_SN</isNotNull>	
			<isNotNull prepend="," property="bsc">BSC</isNotNull>	
			<isNotNull prepend="," property="sell_org">SELL_ORG</isNotNull>	
			<isNotNull prepend="," property="add_date">ADD_DATE</isNotNull>	
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="id">#id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="r3_sell_date">#r3_sell_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="r3_code">#r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="f">#f:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="type_desc">#type_desc:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="r3_name">#r3_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="send_r3_name">#send_r3_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="send_r3_code">#send_r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="creat_date">#creat_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="order_sn">#order_sn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="order_type">#order_type:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="project">#project:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="pd_name">#pd_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="count">#count:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="price">#price:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sum_money">#sum_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="k007_money">#k007_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="rb00_money">#rb00_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="zjz_money">#zjz_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="jh_date">#jh_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="kf_jh_bill">#kf_jh_bill:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="wl_jh_bill">#wl_jh_bill:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fh_store">#fh_store:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="purchase_order_sn">#purchase_order_sn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="custom_wl_sn">#custom_wl_sn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="bsc">#bsc:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="sell_org">#sell_org:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_date">#add_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="add_user_id">#add_user_id:DECIMAL#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateKonkaR3SellImpInvalidData" parameterClass="konkaR3SellImpInvalidData">
		update KONKA_R3_SELL_IMP_INVALID_DATA
		<dynamic prepend="set">
			<isNotNull prepend="," property="id">ID = #id:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="r3_sell_date">R3_SELL_DATE = #r3_sell_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="r3_code">R3_CODE = #r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="f">F = #f:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="type_desc">TYPE_DESC = #type_desc:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="r3_name">R3_NAME = #r3_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="send_r3_name">SEND_R3_NAME = #send_r3_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="send_r3_code">SEND_R3_CODE = #send_r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="creat_date">CREAT_DATE = #creat_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="order_sn">ORDER_SN = #order_sn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="order_type">ORDER_TYPE = #order_type:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="project">PROJECT = #project:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="pd_name">PD_NAME = #pd_name:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="count">COUNT = #count:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="price">PRICE = #price:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="sum_money">SUM_MONEY = #sum_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="k007_money">K007_MONEY = #k007_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="rb00_money">RB00_MONEY = #rb00_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="zjz_money">ZJZ_MONEY = #zjz_money:DECIMAL#</isNotNull>
			<isNotNull prepend="," property="jh_date">JH_DATE = #jh_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="kf_jh_bill">KF_JH_BILL = #kf_jh_bill:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="wl_jh_bill">WL_JH_BILL = #wl_jh_bill:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="fh_store">FH_STORE = #fh_store:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="purchase_order_sn">PURCHASE_ORDER_SN = #purchase_order_sn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="custom_wl_sn">CUSTOM_WL_SN = #custom_wl_sn:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="bsc">BSC = #bsc:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="sell_org">SELL_ORG = #sell_org:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="add_date">ADD_DATE = #add_date:DATETIME#</isNotNull>
			<isNotNull prepend="," property="add_user_id">ADD_USER_ID = #add_user_id:DECIMAL#</isNotNull>
		</dynamic>
		where 1 = 1
		<isNotEmpty prepend=" and " property="id">ID = #id#</isNotEmpty>
		<isEmpty prepend=" and " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</update>

	<delete id="deleteKonkaR3SellImpInvalidData" parameterClass="konkaR3SellImpInvalidData">
		delete from KONKA_R3_SELL_IMP_INVALID_DATA where 1 = 1
		<isNotEmpty prepend=" and " property="id">ID = #id#</isNotEmpty>
		<isNotEmpty prepend=" and " property="r3_sell_date">R3_SELL_DATE = #r3_sell_date:DATETIME#</isNotEmpty>
		<isEmpty prepend=" and " property="id">
			<isNotEmpty prepend=" " property="map.pks">
				ID in
				<iterate close=")" open="(" conjunction="," property="map.pks">#map.pks[]#</iterate>
			</isNotEmpty>
		</isEmpty>
	</delete>

</sqlMap>