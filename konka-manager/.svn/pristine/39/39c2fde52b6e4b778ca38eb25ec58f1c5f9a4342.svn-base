<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KONKA_R3_ORDER">

	<typeAlias alias="konkaR3Order" type="com.ebiz.mmt.domain.KonkaR3Order" />

	<cacheModel id="oneDayCache" type="OSCACHE">
		<flushInterval hours="24" />
		<flushOnExecute statement="insertKonkaR3Order" />
		<flushOnExecute statement="updateKonkaR3Order" />
		<flushOnExecute statement="deleteKonkaR3Order" />
	</cacheModel>

	<resultMap id="konkaR3OrderResultForList" class="konkaR3Order">
		<result column="R3_CODE" property="r3_code" jdbcType="VARCHAR" />
		<result column="YEAR" property="year" jdbcType="VARCHAR" />
		<result column="MONTH1_NUM" property="month1_num" jdbcType="DOUBLE" />
		<result column="MONTH1_VAL" property="month1_val" jdbcType="DOUBLE" />
		<result column="MONTH2_NUM" property="month2_num" jdbcType="DOUBLE" />
		<result column="MONTH2_VAL" property="month2_val" jdbcType="DOUBLE" />
		<result column="MONTH3_NUM" property="month3_num" jdbcType="DOUBLE" />
		<result column="MONTH3_VAL" property="month3_val" jdbcType="DOUBLE" />
		<result column="MONTH4_NUM" property="month4_num" jdbcType="DOUBLE" />
		<result column="MONTH4_VAL" property="month4_val" jdbcType="DOUBLE" />
		<result column="MONTH5_NUM" property="month5_num" jdbcType="DOUBLE" />
		<result column="MONTH5_VAL" property="month5_val" jdbcType="DOUBLE" />
		<result column="MONTH6_NUM" property="month6_num" jdbcType="DOUBLE" />
		<result column="MONTH6_VAL" property="month6_val" jdbcType="DOUBLE" />
		<result column="MONTH7_NUM" property="month7_num" jdbcType="DOUBLE" />
		<result column="MONTH7_VAL" property="month7_val" jdbcType="DOUBLE" />
		<result column="MONTH8_NUM" property="month8_num" jdbcType="DOUBLE" />
		<result column="MONTH8_VAL" property="month8_val" jdbcType="DOUBLE" />
		<result column="MONTH9_NUM" property="month9_num" jdbcType="DOUBLE" />
		<result column="MONTH9_VAL" property="month9_val" jdbcType="DOUBLE" />
		<result column="MONTH10_NUM" property="month10_num" jdbcType="DOUBLE" />
		<result column="MONTH10_VAL" property="month10_val" jdbcType="DOUBLE" />
		<result column="MONTH11_NUM" property="month11_num" jdbcType="DOUBLE" />
		<result column="MONTH11_VAL" property="month11_val" jdbcType="DOUBLE" />
		<result column="MONTH12_NUM" property="month12_num" jdbcType="DOUBLE" />
		<result column="MONTH12_VAL" property="month12_val" jdbcType="DOUBLE" />
		<result column="CREATEDATE" property="createdate" jdbcType="TIMESTAMP" />
		<result column="COLUMN_1" property="column_1" jdbcType="VARCHAR" />
		<result column="COLUMN_2" property="column_2" jdbcType="VARCHAR" />
		<result column="COLUMN_3" property="column_3" jdbcType="VARCHAR" />
		<result column="COLUMN_4" property="column_4" jdbcType="VARCHAR" />
		<result column="COLUMN_5" property="column_5" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="konkaR3OrderResult" class="konkaR3Order" extends="konkaR3OrderResultForList">
		<result property="map.dept_name" column="DEPT_NAME" jdbcType="VARCHAR"/>
		<result property="map.l4_dept_name" column="L4_DEPT_NAME" jdbcType="VARCHAR"/>
		<result property="map.l5_dept_name" column="L5_DEPT_NAME" jdbcType="VARCHAR"/>
		<result property="map.ywy_user_name" column="YWY_USER_NAME" jdbcType="VARCHAR"/>
		<result property="map.customer_type_name" column="CUSTOMER_TYPE_NAME" jdbcType="VARCHAR"/>
		<result property="map.customer_name" column="CUSTOMER_NAME" jdbcType="VARCHAR"/>
	</resultMap>

	<sql id="sf-konkaR3Order">
		<isNotEmpty prepend=" and " property="r3_code">R3_CODE = #r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="year">YEAR = #year:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month1_num">MONTH1_NUM = #month1_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month1_val">MONTH1_VAL = #month1_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month2_num">MONTH2_NUM = #month2_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month2_val">MONTH2_VAL = #month2_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month3_num">MONTH3_NUM = #month3_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month3_val">MONTH3_VAL = #month3_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month4_num">MONTH4_NUM = #month4_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month4_val">MONTH4_VAL = #month4_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month5_num">MONTH5_NUM = #month5_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month5_val">MONTH5_VAL = #month5_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month6_num">MONTH6_NUM = #month6_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month6_val">MONTH6_VAL = #month6_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month7_num">MONTH7_NUM = #month7_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month7_val">MONTH7_VAL = #month7_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month8_num">MONTH8_NUM = #month8_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month8_val">MONTH8_VAL = #month8_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month9_num">MONTH9_NUM = #month9_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month9_val">MONTH9_VAL = #month9_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month10_num">MONTH10_NUM = #month10_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month10_val">MONTH10_VAL = #month10_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month11_num">MONTH11_NUM = #month11_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month11_val">MONTH11_VAL = #month11_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month12_num">MONTH12_NUM = #month12_num:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="month12_val">MONTH12_VAL = #month12_val:DOUBLE#</isNotEmpty>
		<isNotEmpty prepend=" and " property="createdate">CREATEDATE = #createdate:TIMESTAMP#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_1">COLUMN_1 = #column_1:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_2">COLUMN_2 = #column_2:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_3">COLUMN_3 = #column_3:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_4">COLUMN_4 = #column_4:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="column_5">COLUMN_5 = #column_5:VARCHAR#</isNotEmpty>
	</sql>

	<select id="selectKonkaR3Order" resultMap="konkaR3OrderResult" parameterClass="konkaR3Order" cacheModel="oneDayCache">
		select * from KONKA_R3_ORDER where 1 = 1
		<include refid="sf-konkaR3Order" />
	</select>

	<select id="selectKonkaR3OrderList" resultMap="konkaR3OrderResult" parameterClass="konkaR3Order" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		</isNotEmpty>
		select a.*,c.dept_name,b.L4_DEPT_NAME,b.L5_DEPT_NAME,b.YWY_USER_NAME,b.CUSTOMER_TYPE_NAME,b.CUSTOMER_NAME
                from KONKA_R3_ORDER a
                left join KONKA_SALES_DEPT d on a.COLUMN_1 = d.SALES_ORG_CODE
                left join konka_dept c on c.dept_sn = d.P_SALES_ORG_CODE
		left join MV_ORG_OF_CUSTOMER_ALL b on a.R3_CODE = b.R3_CODE
		<![CDATA[where 1 = 1 and year <> '2011']]>
		<isNotEmpty prepend=" and " property="map.dept_id_start">
				(b.cur_dept_id is not null and b.cur_dept_id in (
							select dept_id from konka_dept start with dept_id in (
							SELECT DISTINCT (dept_id)
			  							FROM KONKA_ROLE_DATA_LEVEL
			 							WHERE role_id IN (SELECT role_id
			                     			FROM KONKA_PE_ROLE_USER
			                    			WHERE user_id = #map.session_user_id#)
							) or dept_id = #map.dept_id_start# 
							connect by prior dept_id = par_id 
						)
				)
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">b.user_id = #map.filter_by_ywy_id_eq#</isNotEmpty>  
		<isNotEmpty prepend=" and " property="r3_code">a.R3_CODE like '%' || #r3_code:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_name">b.CUSTOMER_NAME like '%' || #map.customer_name:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="year">YEAR = #year:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_type1">b.PAR_CUSTOMER_TYPE = #map.customer_type1#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_type2">b.CUSTOMER_TYPE = #map.customer_type2#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_id">c.dept_id = #map.dept_id:VARCHAR#</isNotEmpty>
		<!-- order by ID asc -->
		order by year,b.CUSTOMER_NAME
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>
	
	<!-- 返回Map的查询 -->
	<select id="selectR3OrderList" resultClass="java.util.HashMap" parameterClass="konkaR3Order" cacheModel="oneDayCache">
		<isNotEmpty property="row.count">
			<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		</isNotEmpty>
		select 
		<isNotEmpty property="map.com_type_num">
			a.R3_CODE, YEAR, MONTH1_NUM AS MONTH1, MONTH2_NUM AS MONTH2, MONTH3_NUM AS MONTH3, MONTH4_NUM AS MONTH4, MONTH5_NUM AS MONTH5, MONTH6_NUM AS MONTH6, 
			MONTH7_NUM AS MONTH7, MONTH8_NUM AS MONTH8, MONTH9_NUM AS MONTH9, MONTH10_NUM AS MONTH10, MONTH11_NUM AS MONTH11, MONTH12_NUM AS MONTH12,
		</isNotEmpty>
		<isNotEmpty property="map.com_type_mon">
			a.R3_CODE, YEAR, MONTH1_VAL AS MONTH1, MONTH2_VAL AS MONTH2, MONTH3_VAL AS MONTH3, MONTH4_VAL AS MONTH4, MONTH5_VAL AS MONTH5, MONTH6_VAL AS MONTH6, 
			MONTH7_VAL AS MONTH7, MONTH8_VAL AS MONTH8, MONTH9_VAL AS MONTH9, MONTH10_VAL AS MONTH10, MONTH11_VAL AS MONTH11, MONTH12_VAL AS MONTH12,
		</isNotEmpty>
		
		c.dept_name,b.L4_DEPT_NAME,b.L5_DEPT_NAME,b.YWY_USER_NAME,b.PAR_CUSTOMER_TYPE_NAME,b.CUSTOMER_TYPE_NAME,b.CUSTOMER_NAME
                from KONKA_R3_ORDER a
                left join KONKA_SALES_DEPT d on a.COLUMN_1 = d.SALES_ORG_CODE
                left join konka_dept c on c.dept_sn = d.P_SALES_ORG_CODE
		left join MV_ORG_OF_CUSTOMER_ALL b on a.R3_CODE = b.R3_CODE
		<![CDATA[where 1 = 1 and year <> '2011']]>
		<isNotEmpty prepend=" and " property="map.dept_id_start">
				(b.cur_dept_id is not null and b.cur_dept_id in (
							select dept_id from konka_dept start with dept_id in (
							SELECT DISTINCT (dept_id)
			  							FROM KONKA_ROLE_DATA_LEVEL
			 							WHERE role_id IN (SELECT role_id
			                     			FROM KONKA_PE_ROLE_USER
			                    			WHERE user_id = #map.session_user_id#)
							) or dept_id = #map.dept_id_start# 
							connect by prior dept_id = par_id 
						)
				)
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">b.user_id = #map.filter_by_ywy_id_eq#</isNotEmpty>  
		<isNotEmpty prepend=" and " property="r3_code">a.R3_CODE like '%' || #r3_code:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_name">b.CUSTOMER_NAME like '%' || #map.customer_name:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="year">YEAR = #year:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_type1">b.PAR_CUSTOMER_TYPE = #map.customer_type1#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_type2">b.CUSTOMER_TYPE = #map.customer_type2#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_id">c.dept_id = #map.dept_id:VARCHAR#</isNotEmpty>
		<!-- order by ID asc -->
		order by year,b.CUSTOMER_NAME
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<select id="selectKonkaR3OrderCount" resultClass="long" parameterClass="konkaR3Order" cacheModel="oneDayCache">
		select count(*) from KONKA_R3_ORDER a
                left join KONKA_SALES_DEPT d on a.COLUMN_1 = d.SALES_ORG_CODE
                left join konka_dept c on c.dept_sn = d.P_SALES_ORG_CODE
		left join MV_ORG_OF_CUSTOMER_ALL b on a.R3_CODE = b.R3_CODE
		<![CDATA[where 1 = 1 and year <> '2011']]>
		<isNotEmpty prepend=" and " property="map.dept_id_start">
				(b.cur_dept_id is not null and b.cur_dept_id in (
							select dept_id from konka_dept start with dept_id in (
							SELECT DISTINCT (dept_id)
			  							FROM KONKA_ROLE_DATA_LEVEL
			 							WHERE role_id IN (SELECT role_id
			                     			FROM KONKA_PE_ROLE_USER
			                    			WHERE user_id = #map.session_user_id#)
							) or dept_id = #map.dept_id_start# 
							connect by prior dept_id = par_id 
						)
				)
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">b.user_id = #map.filter_by_ywy_id_eq#</isNotEmpty>  
		<isNotEmpty prepend=" and " property="r3_code">a.R3_CODE like '%' || #r3_code:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_name">b.CUSTOMER_NAME like '%' || #map.customer_name:VARCHAR# || '%'</isNotEmpty>
		<isNotEmpty prepend=" and " property="year">YEAR = #year:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_type1">b.PAR_CUSTOMER_TYPE = #map.customer_type1#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_type2">b.CUSTOMER_TYPE = #map.customer_type2#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_id">c.dept_id = #map.dept_id:VARCHAR#</isNotEmpty>
	</select>

	<select id="selectKonkaR3OrderPaginatedList" resultMap="konkaR3OrderResult" parameterClass="konkaR3Order" cacheModel="oneDayCache">
		<![CDATA[ select * from ( select t_.*, rownum rn_ from ( ]]>
		select * from KONKA_R3_ORDER a
		left join MV_ORG_OF_CUSTOMER b on a.R3_CODE = b.R3_CODE
		<![CDATA[where 1 = 1 and year <> '2011']]>
		<isNotEmpty prepend=" and " property="map.dept_id_start">
				(b.cur_dept_id is not null and b.cur_dept_id in (
							select dept_id from konka_dept start with dept_id in (
							SELECT DISTINCT (dept_id)
			  							FROM KONKA_ROLE_DATA_LEVEL
			 							WHERE role_id IN (SELECT role_id
			                     			FROM KONKA_PE_ROLE_USER
			                    			WHERE user_id = #map.session_user_id#)
							) or dept_id = #map.dept_id_start# 
							connect by prior dept_id = par_id 
						)
				)
		</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.filter_by_ywy_id_eq">b.user_id = #map.filter_by_ywy_id_eq#</isNotEmpty>  
		<isNotEmpty prepend=" and " property="r3_code">a.R3_CODE = #r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="year">YEAR = #year:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_type1">b.PAR_CUSTOMER_TYPE = #map.customer_type1#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.customer_type2">b.CUSTOMER_TYPE = #map.customer_type2#</isNotEmpty>
		<isNotEmpty prepend=" and " property="map.dept_id">b.dept_id = #map.dept_id:VARCHAR#</isNotEmpty>
		<!-- order by ID asc -->
		order by year
		<![CDATA[ ) t_ where rownum <= (#row.first# + #row.count#)) where rn_ >= (#row.first# + 1) ]]>
	</select>

	<insert id="insertKonkaR3Order" parameterClass="konkaR3Order">
		<![CDATA[insert into KONKA_R3_ORDER (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="r3_code">R3_CODE</isNotNull>	
			<isNotNull prepend="," property="year">YEAR</isNotNull>	
			<isNotNull prepend="," property="month1_num">MONTH1_NUM</isNotNull>	
			<isNotNull prepend="," property="month1_val">MONTH1_VAL</isNotNull>	
			<isNotNull prepend="," property="month2_num">MONTH2_NUM</isNotNull>	
			<isNotNull prepend="," property="month2_val">MONTH2_VAL</isNotNull>	
			<isNotNull prepend="," property="month3_num">MONTH3_NUM</isNotNull>	
			<isNotNull prepend="," property="month3_val">MONTH3_VAL</isNotNull>	
			<isNotNull prepend="," property="month4_num">MONTH4_NUM</isNotNull>	
			<isNotNull prepend="," property="month4_val">MONTH4_VAL</isNotNull>	
			<isNotNull prepend="," property="month5_num">MONTH5_NUM</isNotNull>	
			<isNotNull prepend="," property="month5_val">MONTH5_VAL</isNotNull>	
			<isNotNull prepend="," property="month6_num">MONTH6_NUM</isNotNull>	
			<isNotNull prepend="," property="month6_val">MONTH6_VAL</isNotNull>	
			<isNotNull prepend="," property="month7_num">MONTH7_NUM</isNotNull>	
			<isNotNull prepend="," property="month7_val">MONTH7_VAL</isNotNull>	
			<isNotNull prepend="," property="month8_num">MONTH8_NUM</isNotNull>	
			<isNotNull prepend="," property="month8_val">MONTH8_VAL</isNotNull>	
			<isNotNull prepend="," property="month9_num">MONTH9_NUM</isNotNull>	
			<isNotNull prepend="," property="month9_val">MONTH9_VAL</isNotNull>	
			<isNotNull prepend="," property="month10_num">MONTH10_NUM</isNotNull>	
			<isNotNull prepend="," property="month10_val">MONTH10_VAL</isNotNull>	
			<isNotNull prepend="," property="month11_num">MONTH11_NUM</isNotNull>	
			<isNotNull prepend="," property="month11_val">MONTH11_VAL</isNotNull>	
			<isNotNull prepend="," property="month12_num">MONTH12_NUM</isNotNull>	
			<isNotNull prepend="," property="month12_val">MONTH12_VAL</isNotNull>	
			<isNotNull prepend="," property="createdate">CREATEDATE</isNotNull>	
			<isNotNull prepend="," property="column_1">COLUMN_1</isNotNull>	
			<isNotNull prepend="," property="column_2">COLUMN_2</isNotNull>	
			<isNotNull prepend="," property="column_3">COLUMN_3</isNotNull>	
			<isNotNull prepend="," property="column_4">COLUMN_4</isNotNull>	
			<isNotNull prepend="," property="column_5">COLUMN_5</isNotNull>	
		</dynamic>
		<![CDATA[) values (]]>
		<dynamic prepend=" ">
			<isNotNull prepend="," property="r3_code">#r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="year">#year:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="month1_num">#month1_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month1_val">#month1_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month2_num">#month2_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month2_val">#month2_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month3_num">#month3_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month3_val">#month3_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month4_num">#month4_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month4_val">#month4_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month5_num">#month5_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month5_val">#month5_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month6_num">#month6_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month6_val">#month6_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month7_num">#month7_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month7_val">#month7_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month8_num">#month8_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month8_val">#month8_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month9_num">#month9_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month9_val">#month9_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month10_num">#month10_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month10_val">#month10_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month11_num">#month11_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month11_val">#month11_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month12_num">#month12_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month12_val">#month12_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="createdate">#createdate:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="column_1">#column_1:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_2">#column_2:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_3">#column_3:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_4">#column_4:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_5">#column_5:VARCHAR#</isNotNull>
		</dynamic>
		<![CDATA[)]]>
	</insert>

	<update id="updateKonkaR3Order" parameterClass="KonkaR3Order">
		update KONKA_R3_ORDER
		<dynamic prepend="set">
			<isNotNull prepend="," property="r3_code">R3_CODE = #r3_code:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="year">YEAR = #year:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="month1_num">MONTH1_NUM = #month1_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month1_val">MONTH1_VAL = #month1_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month2_num">MONTH2_NUM = #month2_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month2_val">MONTH2_VAL = #month2_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month3_num">MONTH3_NUM = #month3_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month3_val">MONTH3_VAL = #month3_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month4_num">MONTH4_NUM = #month4_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month4_val">MONTH4_VAL = #month4_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month5_num">MONTH5_NUM = #month5_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month5_val">MONTH5_VAL = #month5_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month6_num">MONTH6_NUM = #month6_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month6_val">MONTH6_VAL = #month6_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month7_num">MONTH7_NUM = #month7_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month7_val">MONTH7_VAL = #month7_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month8_num">MONTH8_NUM = #month8_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month8_val">MONTH8_VAL = #month8_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month9_num">MONTH9_NUM = #month9_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month9_val">MONTH9_VAL = #month9_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month10_num">MONTH10_NUM = #month10_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month10_val">MONTH10_VAL = #month10_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month11_num">MONTH11_NUM = #month11_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month11_val">MONTH11_VAL = #month11_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month12_num">MONTH12_NUM = #month12_num:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="month12_val">MONTH12_VAL = #month12_val:DOUBLE#</isNotNull>
			<isNotNull prepend="," property="createdate">CREATEDATE = #createdate:TIMESTAMP#</isNotNull>
			<isNotNull prepend="," property="column_1">COLUMN_1 = #column_1:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_2">COLUMN_2 = #column_2:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_3">COLUMN_3 = #column_3:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_4">COLUMN_4 = #column_4:VARCHAR#</isNotNull>
			<isNotNull prepend="," property="column_5">COLUMN_5 = #column_5:VARCHAR#</isNotNull>
		</dynamic>
		where 1=1
		<isNotEmpty prepend=" and " property="r3_code">R3_CODE = #r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="year">YEAR = #year:VARCHAR#</isNotEmpty>
	</update>

	<delete id="deleteKonkaR3Order" parameterClass="KonkaR3Order">
		delete from KONKA_R3_ORDER where 1=1
		<isNotEmpty prepend=" and " property="r3_code">R3_CODE = #r3_code:VARCHAR#</isNotEmpty>
		<isNotEmpty prepend=" and " property="year">YEAR = #year:VARCHAR#</isNotEmpty>
	</delete>

	<!-- 初始化的R3订单数据 -->
	<procedure id="changeR3DataPro" resultClass="long" cacheModel="oneDayCache">
		${call CHANGE_R3_ORDER()}
	</procedure>
	
</sqlMap>